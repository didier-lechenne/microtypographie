/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => Microtypographie
});
module.exports = __toCommonJS(main_exports);
var import_obsidian3 = require("obsidian");

// src/settings/settings.ts
var DEFAULT_SETTINGS = {
  openDoubleQuote: "\xAB\u202F",
  // Guillemet français ouvrant avec espace fine insécable
  closeDoubleQuote: "\u202F\xBB",
  // Guillemet français fermant avec espace fine insécable
  openSingleQuote: "\u201C",
  // Apostrophe typographique
  closeSingleQuote: "\u201D",
  // Apostrophe typographique
  frenchRulesEnabled: true,
  dashesEnabled: true,
  skipEnDash: false,
  ellipsisEnabled: true,
  guillemetsEnabled: false,
  highlightEnabled: false,
  highlightButton: true,
  tabTitleBarButton: true
  // Activé par défaut
};

// src/settings/settingsTab.ts
var import_obsidian = require("obsidian");
var MicrotypographieSettingTab = class extends import_obsidian.PluginSettingTab {
  // Pour stocker la référence au container du champ de texte
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h3", { text: "Microtypographie" });
    this.createBasicSettings(containerEl);
    this.createHighlightSettings(containerEl);
  }
  /**
   * Crée le bloc d'information
   * @param containerEl Conteneur parent
   */
  createInfoBlock(containerEl) {
    const infoContainer = containerEl.createEl("div", {
      cls: "microtypographie-info-container"
    });
    const infoContent = infoContainer.createEl("div", {
      cls: "microtypographie-info-content"
    });
    infoContent.createEl("p", {
      text: "Ce plugin applique automatiquement une partie des r\xE8gles typographiques fran\xE7aises pendant la saisie."
    });
    const rulesList = infoContent.createEl("ul");
    rulesList.createEl("li", {
      text: "Espaces ins\xE9cables avant les ponctuations doubles (! ? ; \xBB)"
    });
    rulesList.createEl("li", { text: "Espaces fines ins\xE9cables avant (:)" });
    rulesList.createEl("li", {
      text: "Espaces fines ins\xE9cables dans les guillemets fran\xE7ais (\xAB\u202Fphrase\u202F\xBB)"
    });
    rulesList.createEl("li", { text: "Apostrophe typographique (\u2019)" });
    rulesList.createEl("li", {
      text: "Conversion de (--) en tiret cadratin (\u2014)"
    });
    infoContent.createEl("p", {
      text: "Utilisez Alt+F pour appliquer toutes les r\xE8gles sur un texte existant."
    });
    const transformationsList = infoContent.createEl("ul");
    transformationsList.createEl("li", {
      text: 'Conversion de (" ") en guillemets fran\xE7ais (\xAB \xBB)'
    });
    transformationsList.createEl("li", {
      text: "Conversion de ' en apostrophe typographique (\u2019)"
    });
    transformationsList.createEl("li", {
      text: "Espace fine ins\xE9cable avant : (! ? ; \xBB \u203A)"
    });
    transformationsList.createEl("li", {
      text: "Espace ins\xE9cable avant : (:)"
    });
    transformationsList.createEl("li", {
      text: "Espace fine ins\xE9cable apr\xE8s : (\xAB \u2039)"
    });
    transformationsList.createEl("li", {
      text: "Espace ins\xE9cable apr\xE8s les mots d'une lettre (a, y, \xE0 \u2026)"
    });
    transformationsList.createEl("li", {
      text: "Espace ins\xE9cable dans les noms compos\xE9s (Jean\xA0Dupont)"
    });
    transformationsList.createEl("li", {
      text: "Espace ins\xE9cable avant les initiales (M.\xA0Dupont)"
    });
    transformationsList.createEl("li", {
      text: "Espace ins\xE9cable avant (si\xE8cle) (XXe\xA0si\xE8cle)"
    });
    transformationsList.createEl("li", {
      text: "Conversion de (oe/OE) en ligatures (\u0153/\u0152)"
    });
    transformationsList.createEl("li", {
      text: "Conversion de (--) en tiret cadratin (\u2014)"
    });
    transformationsList.createEl("li", {
      text: "Conversion de (...) en points de suspension (\u2026)"
    });
    infoContent.createEl("p", {
      text: "Info pour ins\xE9rer une espace ins\xE9cable avec Obsidian :"
    });
    const shortcutsList = infoContent.createEl("ul");
    shortcutsList.createEl("li", { text: "Windows : Alt+255" });
    shortcutsList.createEl("li", { text: "macOS : Alt+Espace" });
    this.addInfoBlockStyles();
  }
  /**
   * Ajoute les styles CSS pour le bloc d'information
   */
  addInfoBlockStyles() {
    const styleElement = document.createElement("style");
    styleElement.textContent = `
        .microtypographie-info-container {
            background-color: rgba(var(--interactive-accent-rgb), 0.1);
            border-left: 4px solid var(--interactive-accent);
            margin: 1em 0;
            padding: 1em;
            border-radius: 4px;
        }
        
        .microtypographie-info-container h2 {
            margin-top: 0;
            font-size: 1.2em;
            color: var(--interactive-accent);
        }
        
        .microtypographie-info-content p {
            margin: 0.5em 0;
        }
    `;
    document.head.appendChild(styleElement);
  }
  /**
   * Crée les paramètres de base
   * @param containerEl Conteneur parent
   */
  createBasicSettings(containerEl) {
    const desEl = containerEl.createEl("p", {
      text: "Caract\xE8res typographiques personnalisables"
    });
    desEl.style.fontWeight = "bold";
    new import_obsidian.Setting(containerEl).setName("Guillemet double ouvrant").addText(
      (text) => text.setValue(this.plugin.settings.openDoubleQuote).onChange(async (value) => {
        this.plugin.settings.openDoubleQuote = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian.Setting(containerEl).setName("Guillemet double fermant").addText(
      (text) => text.setValue(this.plugin.settings.closeDoubleQuote).onChange(async (value) => {
        this.plugin.settings.closeDoubleQuote = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian.Setting(containerEl).setName("Guillemet simple ouvrant").addText(
      (text) => text.setValue(this.plugin.settings.openSingleQuote).onChange(async (value) => {
        this.plugin.settings.openSingleQuote = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian.Setting(containerEl).setName("Guillemet simple fermant").addText(
      (text) => text.setValue(this.plugin.settings.closeSingleQuote).onChange(async (value) => {
        this.plugin.settings.closeSingleQuote = value;
        await this.plugin.saveSettings();
      })
    );
    const transformTitle = containerEl.createEl("p", {
      text: "Options"
    });
    transformTitle.style.fontWeight = "bold";
    transformTitle.style.marginTop = "1.5em";
    new import_obsidian.Setting(containerEl).setName("Tirets").setDesc(
      "-- devient tiret demi-cadratin (\u2013), \u2013- devient tiret cadratin (\u2014), \u2014- devient trois tirets (---)"
    ).addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.dashesEnabled).onChange(async (value) => {
        this.plugin.settings.dashesEnabled = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian.Setting(containerEl).setName("Ignorer le tiret demi-cadratin").setDesc(
      "Quand activ\xE9, -- est directement converti en tiret cadratin (\u2014) plut\xF4t qu'en demi-cadratin (\u2013)"
    ).addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.skipEnDash).onChange(async (value) => {
        this.plugin.settings.skipEnDash = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian.Setting(containerEl).setName("Points de suspension").setDesc(
      "Trois points (...) seront convertis en points de suspension (\u2026)"
    ).addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.ellipsisEnabled).onChange(async (value) => {
        this.plugin.settings.ellipsisEnabled = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian.Setting(containerEl).setName("Guillemets").setDesc(
      "Les chevrons << et >> seront convertis en guillemets fran\xE7ais \xAB et \xBB"
    ).addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.guillemetsEnabled).onChange(async (value) => {
        this.plugin.settings.guillemetsEnabled = value;
        await this.plugin.saveSettings();
      })
    );
    const frenchRulesContainer = containerEl.createEl("div");
    frenchRulesContainer.style.marginTop = "3em";
    const frenchRulesSetting = new import_obsidian.Setting(frenchRulesContainer).setName("R\xE8gles typographiques fran\xE7aises").setDesc(
      ""
    ).addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.frenchRulesEnabled).onChange(async (value) => {
        this.plugin.settings.frenchRulesEnabled = value;
        frenchRulesDescContainer.style.display = value ? "block" : "none";
        await this.plugin.saveSettings();
      })
    );
    const nameEl = frenchRulesSetting.nameEl;
    if (nameEl) {
      nameEl.style.fontWeight = "bold";
    }
    const frenchRulesDescContainer = frenchRulesContainer.createEl("div", {
      cls: "french-rules-description"
    });
    frenchRulesDescContainer.style.display = this.plugin.settings.frenchRulesEnabled ? "block" : "none";
    frenchRulesDescContainer.style.paddingLeft = "24px";
    frenchRulesDescContainer.style.marginTop = "8px";
    const frenchRulesDesc = frenchRulesDescContainer.createEl("div", {
      cls: "setting-item-description"
    });
    frenchRulesDesc.createEl("p", {
      text: "Ces r\xE8gles incluent :"
    });
    const rulesList = frenchRulesDesc.createEl("ul");
    rulesList.style.marginLeft = "20px";
    rulesList.style.marginBottom = "15px";
    rulesList.createEl("li", {
      text: 'Conversion de (" ") en guillemets fran\xE7ais (\xAB \xBB)'
    });
    rulesList.createEl("li", {
      text: "Espace fine ins\xE9cable avant les ponctuations doubles (! ? ; \xBB)"
    });
    rulesList.createEl("li", {
      text: "Espace ins\xE9cable avant les deux-points (:)"
    });
    rulesList.createEl("li", {
      text: "Espace ins\xE9cable apr\xE8s les mots d'une lettre (a, y, \xE0...)"
    });
    rulesList.createEl("li", {
      text: "Espace ins\xE9cable dans les noms compos\xE9s (Jean Dupont)"
    });
    rulesList.createEl("li", {
      text: "Espace ins\xE9cable avant les initiales (M. Dupont)"
    });
    rulesList.createEl("li", {
      text: 'Espace ins\xE9cable avant "si\xE8cle" (XXe si\xE8cle)'
    });
    rulesList.createEl("li", {
      text: 'Conversion des ligatures "oe/OE" en "\u0153/\u0152"'
    });
    rulesList.createEl("li", {
      text: "Exposants pour les ordinaux (1er, XIIe)"
    });
    rulesList.createEl("li", {
      text: "Conversion de (...) en points de suspension (\u2026)"
    });
    const noteEl = frenchRulesDescContainer.createEl("div", {
      cls: "setting-item-description"
    });
    noteEl.createEl("p", {
      text: "Sources :"
    });
    const infoList = noteEl.createEl("ul");
    const infoItem = infoList.createEl("li");
    infoItem.createEl("a", {
      href: "https://gitlab.com/JulieBlanc/typesetting-tools/-/blob/master/regex-typo.js?ref_type=heads",
      text: "typesetting-tools (Julie Blanc)"
    });
    const infoItem2 = infoList.createEl("li");
    infoItem2.createEl("a", {
      href: "https://typomanie.fr/tag/micro-typographie/",
      text: "Le Petit manuel de composition typographique. (Muriel Paris)"
    });
  }
  /**
   * Crée les paramètres de mise en évidence
   * @param containerEl Conteneur parent
   */
  createHighlightSettings(containerEl) {
    const desEl = containerEl.createEl("p", {
      text: "Affichage des caract\xE8res invisibles"
    });
    desEl.style.fontWeight = "bold";
    desEl.style.marginTop = "3em";
    new import_obsidian.Setting(containerEl).setName("Activer l'affichage des caract\xE8res invisibles").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.highlightEnabled).onChange(async (value) => {
        this.plugin.settings.highlightEnabled = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian.Setting(containerEl).setName("Bouton dans la barre d'\xE9tat").setDesc(
      "Afficher un bouton d'activation/d\xE9sactivation"
    ).addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.highlightButton).onChange(async (value) => {
        this.plugin.settings.highlightButton = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian.Setting(containerEl).setName("Bouton dans la barre de titre").setDesc(
      "Afficher un bouton d'activation/d\xE9sactivation dans la barre de titre des onglets"
    ).addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.tabTitleBarButton).onChange(async (value) => {
        this.plugin.settings.tabTitleBarButton = value;
        await this.plugin.saveSettings();
      })
    );
  }
};

// src/ui/decorations.ts
var import_view = require("@codemirror/view");
var import_state = require("@codemirror/state");
function createDecorations(settings) {
  const nonBreakingSpaceDecoration = import_view.Decoration.mark({
    class: "nonBreakingSpace"
  });
  const thinSpaceDecoration = import_view.Decoration.mark({
    class: "thinSpace"
  });
  const emDashDecoration = import_view.Decoration.mark({
    class: "em-dash"
  });
  const regularSpaceDecoration = import_view.Decoration.mark({
    class: "regularSpace"
  });
  return import_view.ViewPlugin.fromClass(class {
    constructor(view) {
      this.decorations = this.buildDecorations(view);
    }
    update(update) {
      if (update.docChanged || update.viewportChanged) {
        this.decorations = this.buildDecorations(update.view);
      }
    }
    buildDecorations(view) {
      const builder = new import_state.RangeSetBuilder();
      if (settings.highlightEnabled) {
        for (let { from, to } of view.visibleRanges) {
          let text = view.state.doc.sliceString(from, to);
          let documentText = view.state.doc.toString();
          let startPos = from;
          let inFrontmatter = false;
          let inCodeBlock = false;
          let lineStart = true;
          for (let i = 0; i < text.length; i++) {
            const char = text[i];
            const pos = startPos + i;
            const currentPos = view.state.doc.lineAt(pos);
            const lineNumber = currentPos.number - 1;
            if (lineStart && text.substr(i, 3) === "---") {
              inFrontmatter = !inFrontmatter;
              i += 2;
              lineStart = false;
              continue;
            }
            if (lineStart && text.substr(i, 3) === "```") {
              inCodeBlock = !inCodeBlock;
              i += 2;
              lineStart = false;
              continue;
            }
            if (char === "\n") {
              lineStart = true;
            } else if (lineStart && char !== " " && char !== "	") {
              lineStart = false;
            }
            const isInSpecialBlock2 = inFrontmatter || inCodeBlock;
            if (!isInSpecialBlock2) {
              if (char === "\xA0") {
                builder.add(pos, pos + 1, nonBreakingSpaceDecoration);
              }
              if (char === "\u202F") {
                builder.add(pos, pos + 1, thinSpaceDecoration);
              }
              if (char === "\u2014") {
                builder.add(pos, pos + 1, emDashDecoration);
              }
              if (char === " ") {
                builder.add(pos, pos + 1, regularSpaceDecoration);
              }
            }
          }
        }
      }
      return builder.finish();
    }
  }, {
    decorations: (v) => v.decorations
  });
}

// src/ui/statusBar.ts
var import_obsidian2 = require("obsidian");
function createStatusBarButton(plugin, isEnabled, toggleCallback) {
  const statusBarItemEl = plugin.addStatusBarItem();
  statusBarItemEl.id = "highlight-status-bar-button";
  statusBarItemEl.addClass("mod-clickable");
  (0, import_obsidian2.setIcon)(statusBarItemEl, "pilcrow");
  statusBarItemEl.setAttribute("aria-label", "Afficher/Masquer les caract\xE8res invisibles");
  statusBarItemEl.setAttribute("data-tooltip-position", "top");
  updateStatusBarButton(statusBarItemEl, isEnabled);
  statusBarItemEl.onClickEvent(() => {
    toggleCallback();
  });
  return statusBarItemEl;
}
function createTabTitleBarButton(plugin, isEnabled, toggleCallback) {
  const buttonEl = document.createElement("button");
  buttonEl.id = "highlight-tab-title-button";
  buttonEl.className = "clickable-icon view-action";
  buttonEl.setAttribute("aria-label", "Afficher/Masquer les caract\xE8res invisibles");
  (0, import_obsidian2.setIcon)(buttonEl, "pilcrow");
  updateTabTitleBarButton(buttonEl, isEnabled);
  buttonEl.addEventListener("click", (event) => {
    event.preventDefault();
    toggleCallback();
  });
  const titleBarEl = document.querySelector(".view-header-title-container");
  if (titleBarEl) {
    const actionsEl = titleBarEl.nextElementSibling;
    if (actionsEl && actionsEl.classList.contains("view-actions")) {
      actionsEl.prepend(buttonEl);
    }
  }
  return buttonEl;
}
function updateStatusBarButton(buttonEl, isEnabled) {
  if (!buttonEl)
    return;
  if (isEnabled) {
    buttonEl.addClass("highlight-enabled");
  } else {
    buttonEl.removeClass("highlight-enabled");
  }
}
function updateTabTitleBarButton(buttonEl, isEnabled) {
  if (!buttonEl)
    return;
  if (isEnabled) {
    buttonEl.addClass("is-active");
  } else {
    buttonEl.removeClass("is-active");
  }
}
function removeTabTitleBarButton(buttonEl) {
  if (buttonEl) {
    buttonEl.remove();
  }
}

// src/core/blockAnalyzer.ts
function analyzeDocumentStructure(documentText, startLine, endLine) {
  const lines = documentText.split("\n");
  const lineTypes = new Array(endLine - startLine + 1).fill("normal");
  let inFrontmatter = false;
  let inCodeBlock = false;
  for (let i = 0; i < lines.length; i++) {
    const line = lines[i];
    if (line.trim() === "---") {
      inFrontmatter = !inFrontmatter;
    } else if (line.trim().startsWith("```")) {
      inCodeBlock = !inCodeBlock;
    }
    if (i >= startLine && i <= endLine) {
      const relativeIndex = i - startLine;
      if (line.trim() === "---" || line.trim().startsWith("```")) {
        lineTypes[relativeIndex] = "delimiter";
      } else if (inFrontmatter) {
        lineTypes[relativeIndex] = "frontmatter";
      } else if (inCodeBlock) {
        lineTypes[relativeIndex] = "code";
      }
    }
    if (i > endLine)
      break;
  }
  return { lineTypes };
}
function isLineInSpecialBlock(documentText, lineNumber) {
  const lines = documentText.split("\n");
  let inFrontmatter = false;
  let inCodeBlock = false;
  for (let i = 0; i <= lineNumber; i++) {
    const line = lines[i];
    if (line.trim() === "---") {
      inFrontmatter = !inFrontmatter;
    } else if (line.trim().startsWith("```")) {
      inCodeBlock = !inCodeBlock;
    }
    if (i === lineNumber) {
      return inFrontmatter || inCodeBlock;
    }
  }
  return false;
}

// src/utils/helpers.ts
function isInSpecialBlock(editor) {
  const cursor = editor.getCursor();
  const text = editor.getValue();
  return isLineInSpecialBlock(text, cursor.line);
}
function isInPreservedMarkdown(editor) {
  const cursor = editor.getCursor();
  const line = editor.getLine(cursor.line);
  const codeInlinePattern = /`[^`]*`/g;
  const codeInlineMatches = [...line.matchAll(codeInlinePattern)];
  for (const match of codeInlineMatches) {
    const start = match.index || 0;
    const end = start + match[0].length;
    if (cursor.ch >= start && cursor.ch <= end) {
      return true;
    }
  }
  const obsidianLinkPattern = /\[\[[^\]]*\]\]/g;
  const obsidianLinkMatches = [...line.matchAll(obsidianLinkPattern)];
  for (const match of obsidianLinkMatches) {
    const start = match.index || 0;
    const end = start + match[0].length;
    if (cursor.ch >= start && cursor.ch <= end) {
      return true;
    }
  }
  const mathInlinePattern = /\$[^$]*\$/g;
  const mathInlineMatches = [...line.matchAll(mathInlinePattern)];
  for (const match of mathInlineMatches) {
    const start = match.index || 0;
    const end = start + match[0].length;
    if (cursor.ch >= start && cursor.ch <= end) {
      return true;
    }
  }
  if (line.includes("$$")) {
    const matches = [...line.matchAll(/\$\$/g)];
    for (const match of matches) {
      const start = match.index || 0;
      const end = start + 2;
      if (cursor.ch >= start && cursor.ch <= end) {
        return true;
      }
    }
  }
  const calloutPattern = /^>\s+\[!.*\]/;
  if (calloutPattern.test(line) && cursor.ch <= line.length) {
    return true;
  }
  const urlPattern = /(https?:\/\/|www\.)[^\s]+/g;
  const urlMatches = [...line.matchAll(urlPattern)];
  for (const match of urlMatches) {
    const start = match.index || 0;
    const end = start + match[0].length;
    if (cursor.ch >= start && cursor.ch <= end) {
      return true;
    }
  }
  const imagePattern = /!\[.*?\]\(.*?\)/g;
  const imageMatches = [...line.matchAll(imagePattern)];
  for (const match of imageMatches) {
    const start = match.index || 0;
    const end = start + match[0].length;
    if (cursor.ch >= start && cursor.ch <= end) {
      return true;
    }
  }
  const linkPattern = /\[.*?\]\(.*?\)/g;
  const linkMatches = [...line.matchAll(linkPattern)];
  for (const match of linkMatches) {
    const start = match.index || 0;
    const end = start + match[0].length;
    if (cursor.ch >= start && cursor.ch <= end) {
      return true;
    }
  }
  const htmlTagPattern = /<[^>]*>/g;
  const htmlMatches = [...line.matchAll(htmlTagPattern)];
  for (const match of htmlMatches) {
    const start = match.index || 0;
    const end = start + match[0].length;
    if (cursor.ch >= start && cursor.ch <= end) {
      return true;
    }
  }
  const taskPattern = /^\s*- \[[ x]\]/;
  if (taskPattern.test(line) && cursor.ch <= line.indexOf("]") + 1) {
    return true;
  }
  return false;
}
async function injectCSSFromFile(plugin, fileName) {
  try {
    const pluginDir = plugin.manifest.dir;
    const filePath = `${pluginDir}/${fileName}`;
    const cssContent = await plugin.app.vault.adapter.read(filePath);
    const styleEl = document.createElement("style");
    styleEl.textContent = cssContent;
    document.head.appendChild(styleEl);
  } catch (error) {
    console.error("\xC9chec de chargement du fichier CSS:", error);
  }
}

// src/modules/liveTypography.ts
var LiveTypographyModule = class {
  constructor(settings) {
    this.openQuote = true;
    this.settings = settings;
  }
  /**
   * Initialise le module avec les paramètres actuels
   * @param settings Paramètres mis à jour
   */
  updateSettings(settings) {
    this.settings = settings;
  }
  resetQuoteState() {
    this.openQuote = true;
  }
  /**
   * Gère les événements clavier pour appliquer les règles typographiques en temps réel
   * @param event Événement clavier
   * @param editor Éditeur Obsidian
   * @returns true si l'événement a été géré, false sinon
   */
  handleKeyEvent(event, editor) {
    if (isInSpecialBlock(editor) || isInPreservedMarkdown(editor)) {
      return false;
    }
    const cursor = editor.getCursor();
    let handled = false;
    if (event.key === "'") {
      event.preventDefault();
      const selection = editor.getSelection();
      if (selection.length > 0) {
        editor.replaceSelection(this.settings.openSingleQuote);
      } else {
        editor.replaceRange(this.settings.openSingleQuote, cursor);
        editor.setCursor({ line: cursor.line, ch: cursor.ch + this.settings.openSingleQuote.length });
      }
      handled = true;
    } else if (["!", "?", ";"].includes(event.key) && this.settings.frenchRulesEnabled) {
      event.preventDefault();
      const charBefore = editor.getRange(
        { line: cursor.line, ch: cursor.ch - 1 },
        cursor
      );
      if (charBefore === " ") {
        editor.replaceRange(
          "\u202F" + event.key,
          { line: cursor.line, ch: cursor.ch - 1 },
          cursor
        );
      } else {
        editor.replaceRange(event.key, cursor);
      }
      editor.setCursor({ line: cursor.line, ch: cursor.ch + 1 });
      handled = true;
    } else if (event.key === ":" && this.settings.frenchRulesEnabled) {
      event.preventDefault();
      const charBefore = editor.getRange(
        { line: cursor.line, ch: cursor.ch - 1 },
        cursor
      );
      if (charBefore === " ") {
        editor.replaceRange(
          "\xA0" + event.key,
          { line: cursor.line, ch: cursor.ch - 1 },
          cursor
        );
      } else {
        editor.replaceRange(event.key, cursor);
      }
      editor.setCursor({ line: cursor.line, ch: cursor.ch + 1 });
      handled = true;
    } else if (event.key === '"') {
      event.preventDefault();
      if (this.openQuote) {
        editor.replaceRange(this.settings.openDoubleQuote, cursor);
        editor.setCursor({
          line: cursor.line,
          ch: cursor.ch + this.settings.openDoubleQuote.length
        });
      } else {
        editor.replaceRange(this.settings.closeDoubleQuote, cursor);
        editor.setCursor({
          line: cursor.line,
          ch: cursor.ch + this.settings.closeDoubleQuote.length
        });
      }
      this.openQuote = !this.openQuote;
      handled = true;
    } else if (event.key === "." && this.settings.ellipsisEnabled) {
      const textBefore = editor.getRange(
        { line: cursor.line, ch: cursor.ch - 2 },
        cursor
      );
      if (textBefore === "..") {
        event.preventDefault();
        editor.replaceRange(
          "\u2026",
          { line: cursor.line, ch: cursor.ch - 2 },
          cursor
        );
        editor.setCursor({ line: cursor.line, ch: cursor.ch - 1 });
        handled = true;
      }
    } else if (event.key === "-" && this.settings.dashesEnabled) {
      const textBefore = editor.getRange(
        { line: cursor.line, ch: cursor.ch - 1 },
        cursor
      );
      if (this.settings.skipEnDash) {
        if (textBefore === "-") {
          event.preventDefault();
          editor.replaceRange(
            "\u2014",
            { line: cursor.line, ch: cursor.ch - 1 },
            cursor
          );
          editor.setCursor({ line: cursor.line, ch: cursor.ch });
          handled = true;
        }
      } else {
        if (textBefore === "-") {
          event.preventDefault();
          editor.replaceRange(
            "\u2013",
            { line: cursor.line, ch: cursor.ch - 1 },
            cursor
          );
          editor.setCursor({ line: cursor.line, ch: cursor.ch });
          handled = true;
        } else if (textBefore === "\u2013") {
          event.preventDefault();
          editor.replaceRange(
            "\u2014",
            { line: cursor.line, ch: cursor.ch - 1 },
            cursor
          );
          editor.setCursor({ line: cursor.line, ch: cursor.ch });
          handled = true;
        } else if (textBefore === "\u2014") {
          event.preventDefault();
          editor.replaceRange(
            "---",
            { line: cursor.line, ch: cursor.ch - 1 },
            cursor
          );
          editor.setCursor({ line: cursor.line, ch: cursor.ch + 2 });
          handled = true;
        }
      }
    } else if (event.key === ">" && this.settings.guillemetsEnabled) {
      const textBefore = editor.getRange(
        { line: cursor.line, ch: cursor.ch - 1 },
        cursor
      );
      if (textBefore === ">") {
        event.preventDefault();
        editor.replaceRange(
          "\u202F\xBB",
          { line: cursor.line, ch: cursor.ch - 1 },
          cursor
        );
        editor.setCursor({ line: cursor.line, ch: cursor.ch });
        handled = true;
      }
    } else if (event.key === "<" && this.settings.guillemetsEnabled) {
      const textBefore = editor.getRange(
        { line: cursor.line, ch: cursor.ch - 1 },
        cursor
      );
      if (textBefore === "<") {
        event.preventDefault();
        editor.replaceRange(
          "\xAB\u202F",
          { line: cursor.line, ch: cursor.ch - 1 },
          cursor
        );
        editor.setCursor({ line: cursor.line, ch: cursor.ch });
        handled = true;
      }
    }
    return handled;
  }
};

// src/core/typographyRules.ts
var FRENCH_RULES = [
  // Règles orthographiques
  { reg: /(X|I|V)ème/g, repl: "$1e" },
  { reg: /(X|I|V)eme/g, repl: "$1e" },
  { reg: /(X|I|V)éme/g, repl: "$1e" },
  { reg: /oe/g, repl: "\u0153" },
  { reg: /OE/g, repl: "\u0152" },
  { reg: /Oe/g, repl: "\u0152" },
  { reg: /ae/g, repl: "\xE6" },
  { reg: /AE/g, repl: "\xC6" },
  { reg: /Ae/g, repl: "\xC6" },
  // real apostrophe
  { reg: /\'/g, repl: "'" },
  // real suspension points
  { reg: /\.{3,}/g, repl: "\u2026" },
  // delete all spaces after «‹"[(
  { reg: /([«‹"\[(])\s+/g, repl: "$1" },
  // delete all spaces before punctuation !?;:»›")].,
  { reg: /\s+([!?;:»›")\]\.\,])/g, repl: "$1" },
  // add narrow no break space before !?;»›
  { reg: /([!?;»›])/g, repl: "\u202F$1" },
  // add no break space before : (correctly handling existing spaces, but avoiding URLs)
  { reg: /\s+(:)(?!\/\/)/g, repl: "\xA0$1" },
  { reg: /([^\s:\/])(:)(?!\/\/)/g, repl: "$1\xA0$2" },
  // add narrow no break space after «‹
  { reg: /([«‹])/g, repl: "$1\u202F" },
  // no break space after one letter words
  { reg: /\s+([a-zà])\s+/gi, repl: " $1\xA0" },
  // no break space into names
  {
    reg: /([A-ZÀ-ÖØŒ])([A-Za-zÀ-ÖØ-öø-ÿœŒ]+)\s+([A-ZÀ-ÖØŒ])([A-Za-zÀ-ÖØ-öø-ÿœŒ]+)/g,
    repl: "$1$2\xA0$3$4"
  },
  // no break space after abbreviation with period
  {
    reg: /([A-ZÀ-ÖØŒ]\.)\s+([A-ZÀ-ÖØŒ][A-Za-zÀ-ÖØ-öø-ÿœŒ]+)/g,
    repl: "$1\xA0$2"
  },
  // no break space before 'siècles'
  { reg: /(X|I|V)(er|e)\s+siècle/g, repl: "$1$2\xA0si\xE8cle" },
  // add sub
  { reg: /(\s|^)(\d+|[IVX]+)(er|e|ème|eme)(\s|$)/gi, repl: "$1$2<sup>$3</sup>$4" },
  // Transformer les guillemets simples à l'intérieur de guillemets doubles en guillemets anglais
  { reg: /(«\u202F[^»]*)'([^']*)'([^»]*\u202F»)/g, repl: "$1\u201C$2\u201D$3" },
  // ajouter espace après guillemet fermant suivi d'un mot
  { reg: /(»)([A-Za-zÀ-ÖØ-öø-ÿœŒ0-9])/g, repl: "$1 $2" },
  // Transformer les guillemets simples à l'intérieur de guillemets doubles en guillemets anglais
  { reg: /(«\u202F[^»]*)«\u202F([^»]*)\u202F»([^»]*\u202F»)/g, repl: "$1\u201C$2\u201D$3" }
];
var BASE_RULES = [];
function compileRules(settings) {
  let frenchRules = [];
  frenchRules.push(
    // Remplacer tous les guillemets par un placeholder UNIQUEMENT
    {
      reg: /"/g,
      repl: "QUOTE_PLACEHOLDER"
    }
    // PLUS de règles de suppression d'espaces qui cassent la détection !
  );
  frenchRules.push({ reg: /\'/g, repl: settings.openSingleQuote });
  if (settings.ellipsisEnabled) {
    frenchRules.push({ reg: /\.{3,}/g, repl: "\u2026" });
  }
  if (settings.guillemetsEnabled) {
    frenchRules.push({ reg: /<</g, repl: "\xAB\u202F" }, { reg: />>/g, repl: "\u202F\xBB" });
  }
  if (settings.frenchRulesEnabled) {
    frenchRules = [...frenchRules, ...FRENCH_RULES];
    frenchRules.push({
      reg: /(«\u202F[^»]*)«\u202F([^»]*)\u202F»([^»]*\u202F»)/g,
      repl: '$1"$2"$3'
    });
  } else {
    frenchRules = [...frenchRules, ...BASE_RULES];
  }
  const dashRules = [];
  if (settings.dashesEnabled) {
    if (settings.skipEnDash) {
      dashRules.push({ reg: /--/g, repl: "\u2014" });
    } else {
      dashRules.push(
        { reg: /--/g, repl: "\u2013" },
        // -- devient –
        { reg: /–-/g, repl: "\u2014" },
        // –- devient —
        { reg: /—-/g, repl: "---" }
        // —- devient ---
      );
    }
  }
  return { frenchRules, dashRules };
}
function processQuotes(text, openQuote, closeQuote) {
  let result = text;
  const totalQuotes = (result.match(/QUOTE_PLACEHOLDER/g) || []).length;
  if (totalQuotes === 4) {
    const segments = result.split("QUOTE_PLACEHOLDER");
    if (segments.length === 5) {
      const segment1 = segments[1];
      const segment2 = segments[2];
      const segment3 = segments[3];
      const segment3StartsWithLowercase = /^\s*[a-zà-ÿ]/.test(segment3);
      const segment2IsShort = segment2.length < 50;
      const segment3NotEmpty = segment3.trim().length > 0;
      if (segment3StartsWithLowercase && segment3NotEmpty || segment2IsShort && segment3NotEmpty && segment3StartsWithLowercase) {
        let tempResult = result;
        tempResult = tempResult.replace(/QUOTE_PLACEHOLDER/, openQuote);
        tempResult = tempResult.replace(/QUOTE_PLACEHOLDER/, "\u201C");
        tempResult = tempResult.replace(/QUOTE_PLACEHOLDER/, "\u201D");
        tempResult = tempResult.replace(/QUOTE_PLACEHOLDER/, closeQuote);
        return tempResult;
      } else {
      }
    }
  }
  console.log(`\u{1F504} Alternance simple pour ${totalQuotes} guillemets`);
  let quoteIndex = 0;
  result = result.replace(/QUOTE_PLACEHOLDER/g, () => {
    const isOpening = quoteIndex % 2 === 0;
    quoteIndex++;
    return isOpening ? openQuote : closeQuote;
  });
  return result;
}
function applyRules(text, rules, settings) {
  let result = text;
  for (const rule of rules) {
    const before = result;
    result = result.replace(rule.reg, rule.repl);
    if (before !== result) {
    }
  }
  if (settings && result.includes("QUOTE_PLACEHOLDER")) {
    result = processQuotes(result, settings.openDoubleQuote, settings.closeDoubleQuote);
  }
  return result;
}

// src/core/textProcessor.ts
function applyAllRules(text, rules, settings) {
  let result = text;
  const preservedElements = [];
  const patterns = [
    /\[\[.*?\]\]/g,
    // Liens Obsidian [[lien]]
    /\[.*?\]\(.*?\)/g,
    // Liens Markdown [texte](url)
    /!\[.*?\]\(.*?\)/g,
    // Images ![alt](url)
    /`[^`]+`/g,
    // Code inline `code`
    /```[\s\S]*?```/g,
    // Blocs de code
    />\s.*$/gm,
    // Callouts (lignes commençant par "> ")
    /<[^>]*>/g,
    // Balises HTML
    /\$\$[^$]*\$\$/g,
    // Équations mathématiques $$equation$$
    /\$[^$]*\$/g,
    // Équations mathématiques inline $equation$
    /\{[^}]*\}/g,
    // Contenu entre accolades {contenu}
    /https?:\/\/[^\s]+/g,
    // URLs avec http: ou https:
    /[a-z]+:\/\/[^\s]+/g,
    // Autres protocoles (ftp:, file:, etc.)
    /[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+/g
    // Adresses email
  ];
  let tempText = result;
  let elementIndex = 0;
  for (const pattern of patterns) {
    let match;
    let searchText = tempText;
    let replacedText = tempText;
    while ((match = pattern.exec(searchText)) !== null) {
      const placeholder = `__PRESERVED_ELEMENT_${elementIndex}__`;
      preservedElements.push(match[0]);
      replacedText = replacedText.replace(match[0], placeholder);
      elementIndex++;
    }
    tempText = replacedText;
  }
  tempText = applyRules(tempText, rules.frenchRules, settings);
  tempText = applyRules(tempText, rules.dashRules);
  result = tempText;
  for (let i = 0; i < preservedElements.length; i++) {
    const placeholder = `__PRESERVED_ELEMENT_${i}__`;
    result = result.replace(placeholder, preservedElements[i]);
  }
  return result;
}
function processTextWithBlocks(text, blocks, rules, settings) {
  const lines = text.split("\n");
  const processedLines = [];
  let normalTextBuffer = [];
  let lastBlockType = "";
  for (let i = 0; i < lines.length; i++) {
    const currentBlockType = blocks[i];
    const line = lines[i];
    if (currentBlockType === "normal") {
      normalTextBuffer.push(line);
    } else {
      if (normalTextBuffer.length > 0) {
        const processedBuffer = applyAllRules(normalTextBuffer.join("\n"), rules, settings);
        processedLines.push(...processedBuffer.split("\n"));
        normalTextBuffer = [];
      }
      processedLines.push(line);
    }
    lastBlockType = currentBlockType;
  }
  if (normalTextBuffer.length > 0) {
    const processedBuffer = applyAllRules(normalTextBuffer.join("\n"), rules, settings);
    processedLines.push(...processedBuffer.split("\n"));
  }
  return processedLines.join("\n");
}
async function processLargeDocument(text, blocks, rules, settings, callback, batchSize = 500) {
  const lines = text.split("\n");
  const processedLines = [];
  for (let i = 0; i < Math.ceil(lines.length / batchSize); i++) {
    const startIdx = i * batchSize;
    const endIdx = Math.min((i + 1) * batchSize, lines.length);
    const batchLines = lines.slice(startIdx, endIdx);
    const batchBlocks = blocks.slice(startIdx, endIdx);
    const batchText = batchLines.join("\n");
    const processedBatch = processTextWithBlocks(batchText, batchBlocks, rules, settings);
    processedLines.push(...processedBatch.split("\n"));
    if (i < Math.ceil(lines.length / batchSize) - 1) {
      await new Promise((resolve) => setTimeout(resolve, 0));
    }
  }
  callback(processedLines.join("\n"));
}

// src/modules/batchTypography.ts
var BatchTypographyModule = class {
  constructor(settings) {
    this.settings = settings;
  }
  /**
   * Initialise le module avec les paramètres actuels
   * @param settings Paramètres mis à jour
   */
  updateSettings(settings) {
    this.settings = settings;
  }
  /**
   * Applique toutes les règles typographiques sur un texte sélectionné
   * @param editor Éditeur Obsidian
   * @returns true si des modifications ont été appliquées
   */
  applyTypographicRules(editor) {
    const selection = editor.getSelection();
    if (!selection || selection.length === 0) {
      return false;
    }
    const selectionStart = editor.getCursor("from");
    const selectionEnd = editor.getCursor("to");
    const rules = compileRules(this.settings);
    const blocks = analyzeDocumentStructure(
      editor.getValue(),
      selectionStart.line,
      selectionEnd.line
    );
    const processedText = processTextWithBlocks(selection, blocks.lineTypes, rules, this.settings);
    if (processedText === selection) {
      return false;
    }
    editor.replaceSelection(processedText);
    return true;
  }
  /**
   * Traite de grands documents de manière asynchrone
   * @param editor Éditeur Obsidian
   * @param callback Fonction appelée lorsque le traitement est terminé
   */
  async processLargeSelection(editor, callback) {
    const selection = editor.getSelection();
    if (!selection || selection.length === 0) {
      if (callback)
        callback();
      return;
    }
    const selectionStart = editor.getCursor("from");
    const selectionEnd = editor.getCursor("to");
    if (selection.length < 1e4) {
      this.applyTypographicRules(editor);
      if (callback)
        callback();
      return;
    }
    const rules = compileRules(this.settings);
    const blocks = analyzeDocumentStructure(
      editor.getValue(),
      selectionStart.line,
      selectionEnd.line
    );
    await processLargeDocument(
      selection,
      blocks.lineTypes,
      rules,
      this.settings,
      (processedText) => {
        editor.replaceSelection(processedText);
        editor.setSelection(selectionStart, selectionEnd);
        if (callback)
          callback();
      }
    );
  }
};

// main.ts
var Microtypographie = class extends import_obsidian3.Plugin {
  constructor() {
    super(...arguments);
    this.statusBarButton = null;
    this.tabTitleBarButton = null;
  }
  async onload() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
    this.liveModule = new LiveTypographyModule(this.settings);
    this.batchModule = new BatchTypographyModule(this.settings);
    this.addSettingTab(new MicrotypographieSettingTab(this.app, this));
    this.registerDomEvent(document, "keydown", this.handleKeyDown.bind(this));
    await injectCSSFromFile(this, "styles.css");
    this.registerEditorExtension(createDecorations(this.settings));
    if (this.settings.highlightButton) {
      this.statusBarButton = createStatusBarButton(
        this,
        this.settings.highlightEnabled,
        this.toggleHighlight.bind(this)
      );
    }
    if (this.settings.tabTitleBarButton) {
      this.tabTitleBarButton = createTabTitleBarButton(
        this,
        this.settings.highlightEnabled,
        this.toggleHighlight.bind(this)
      );
    }
    this.addCommand({
      id: "apply-french-typography",
      name: "Appliquer les r\xE8gles typographiques fran\xE7aises",
      callback: () => {
        const activeView = this.app.workspace.getActiveViewOfType(import_obsidian3.MarkdownView);
        if (activeView) {
          this.batchModule.applyTypographicRules(activeView.editor);
        }
      },
      hotkeys: [{ modifiers: ["Alt"], key: "f" }]
    });
    this.addCommand({
      id: "toggle-highlight",
      name: "Afficher/Masquer les caract\xE8res invisibles",
      callback: () => {
        this.toggleHighlight();
      }
    });
    this.registerEvent(
      this.app.workspace.on("active-leaf-change", () => {
        if (this.settings.tabTitleBarButton) {
          if (this.tabTitleBarButton) {
            this.tabTitleBarButton.remove();
          }
          this.tabTitleBarButton = createTabTitleBarButton(
            this,
            this.settings.highlightEnabled,
            this.toggleHighlight.bind(this)
          );
        }
      })
    );
  }
  // Gérer les événements clavier (délègue au module d'aperçu direct)
  handleKeyDown(event) {
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian3.MarkdownView);
    if (!activeView || activeView.getMode() !== "source") {
      return;
    }
    const leaf = this.app.workspace.getLeaf();
    if (!leaf)
      return;
    const activeState = leaf.getViewState().state;
    if (!activeState)
      return;
    if (activeView && activeView.getMode() === "source" && activeState["source"] === false) {
      this.liveModule.handleKeyEvent(event, activeView.editor);
    }
  }
  async saveSettings() {
    await this.saveData(this.settings);
    this.liveModule.updateSettings(this.settings);
    this.batchModule.updateSettings(this.settings);
    updateStatusBarButton(this.statusBarButton, this.settings.highlightEnabled);
    updateTabTitleBarButton(this.tabTitleBarButton, this.settings.highlightEnabled);
    this.refreshDecorations();
  }
  // Activer/désactiver la mise en évidence
  toggleHighlight() {
    this.settings.highlightEnabled = !this.settings.highlightEnabled;
    this.saveSettings();
  }
  // Rafraîchir les décorations
  refreshDecorations() {
    this.app.workspace.iterateAllLeaves((leaf) => {
      if (leaf.view instanceof import_obsidian3.MarkdownView && leaf.view.editor) {
        const editorView = leaf.view.editor.cm;
        if (editorView) {
          editorView.dispatch({
            changes: {
              from: 0,
              to: editorView.state.doc.length,
              insert: editorView.state.doc.toString()
            }
          });
        }
      }
    });
  }
  onunload() {
    removeTabTitleBarButton(this.tabTitleBarButton);
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzcmMvc2V0dGluZ3Mvc2V0dGluZ3MudHMiLCAic3JjL3NldHRpbmdzL3NldHRpbmdzVGFiLnRzIiwgInNyYy91aS9kZWNvcmF0aW9ucy50cyIsICJzcmMvdWkvc3RhdHVzQmFyLnRzIiwgInNyYy9jb3JlL2Jsb2NrQW5hbHl6ZXIudHMiLCAic3JjL3V0aWxzL2hlbHBlcnMudHMiLCAic3JjL21vZHVsZXMvbGl2ZVR5cG9ncmFwaHkudHMiLCAic3JjL2NvcmUvdHlwb2dyYXBoeVJ1bGVzLnRzIiwgInNyYy9jb3JlL3RleHRQcm9jZXNzb3IudHMiLCAic3JjL21vZHVsZXMvYmF0Y2hUeXBvZ3JhcGh5LnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBNYXJrZG93blZpZXcsIFBsdWdpbiB9IGZyb20gXCJvYnNpZGlhblwiO1xuLy8gaW1wb3J0IHsgQXBwLCBFZGl0b3IsIE1hcmtkb3duVmlldywgTW9kYWwsIE5vdGljZSwgUGx1Z2luLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgTWljcm90eXBvZ3JhcGhpZVNldHRpbmdzLCBERUZBVUxUX1NFVFRJTkdTIH0gZnJvbSAnLi9zcmMvc2V0dGluZ3Mvc2V0dGluZ3MnO1xuaW1wb3J0IHsgTWljcm90eXBvZ3JhcGhpZVNldHRpbmdUYWIgfSBmcm9tICcuL3NyYy9zZXR0aW5ncy9zZXR0aW5nc1RhYic7XG5pbXBvcnQgeyBjcmVhdGVEZWNvcmF0aW9ucyB9IGZyb20gJy4vc3JjL3VpL2RlY29yYXRpb25zJztcbmltcG9ydCB7IFxuICAgIGNyZWF0ZVN0YXR1c0JhckJ1dHRvbiwgXG4gICAgdXBkYXRlU3RhdHVzQmFyQnV0dG9uLCBcbiAgICBjcmVhdGVUYWJUaXRsZUJhckJ1dHRvbiwgXG4gICAgdXBkYXRlVGFiVGl0bGVCYXJCdXR0b24sIFxuICAgIHJlbW92ZVRhYlRpdGxlQmFyQnV0dG9uIFxufSBmcm9tICcuL3NyYy91aS9zdGF0dXNCYXInO1xuaW1wb3J0IHsgaW5qZWN0Q1NTRnJvbUZpbGUgfSBmcm9tICcuL3NyYy91dGlscy9oZWxwZXJzJztcblxuLy8gSW1wb3J0ZXIgbGVzIG5vdXZlYXV4IG1vZHVsZXNcbmltcG9ydCB7IExpdmVUeXBvZ3JhcGh5TW9kdWxlIH0gZnJvbSAnLi9zcmMvbW9kdWxlcy9saXZlVHlwb2dyYXBoeSc7XG5pbXBvcnQgeyBCYXRjaFR5cG9ncmFwaHlNb2R1bGUgfSBmcm9tICcuL3NyYy9tb2R1bGVzL2JhdGNoVHlwb2dyYXBoeSc7XG5cbmltcG9ydCB7IEVkaXRvclZpZXcgfSBmcm9tIFwiQGNvZGVtaXJyb3Ivdmlld1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNaWNyb3R5cG9ncmFwaGllIGV4dGVuZHMgUGx1Z2luIHtcbiAgICBzZXR0aW5nczogTWljcm90eXBvZ3JhcGhpZVNldHRpbmdzO1xuICAgIHByaXZhdGUgc3RhdHVzQmFyQnV0dG9uOiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsO1xuICAgIHByaXZhdGUgdGFiVGl0bGVCYXJCdXR0b246IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XG4gICAgXG4gICAgLy8gSW5zdGFuY2VzIGRlcyBtb2R1bGVzXG4gICAgcHJpdmF0ZSBsaXZlTW9kdWxlOiBMaXZlVHlwb2dyYXBoeU1vZHVsZTtcbiAgICBwcml2YXRlIGJhdGNoTW9kdWxlOiBCYXRjaFR5cG9ncmFwaHlNb2R1bGU7XG5cbiAgICBhc3luYyBvbmxvYWQoKSB7XG4gICAgICAgIC8vIENoYXJnZXIgbGVzIHBhcmFtXHUwMEU4dHJlc1xuICAgICAgICB0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgYXdhaXQgdGhpcy5sb2FkRGF0YSgpKTtcbiAgICBcbiAgICAgICAgLy8gSW5pdGlhbGlzZXIgbGVzIG1vZHVsZXNcbiAgICAgICAgdGhpcy5saXZlTW9kdWxlID0gbmV3IExpdmVUeXBvZ3JhcGh5TW9kdWxlKHRoaXMuc2V0dGluZ3MpO1xuICAgICAgICB0aGlzLmJhdGNoTW9kdWxlID0gbmV3IEJhdGNoVHlwb2dyYXBoeU1vZHVsZSh0aGlzLnNldHRpbmdzKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEFqb3V0ZXIgbCdvbmdsZXQgZGUgcGFyYW1cdTAwRTh0cmVzXG4gICAgICAgIHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgTWljcm90eXBvZ3JhcGhpZVNldHRpbmdUYWIodGhpcy5hcHAsIHRoaXMpKTtcbiAgICBcbiAgICAgICAgLy8gRW5yZWdpc3RyZXIgbCdcdTAwRTl2XHUwMEU5bmVtZW50IGtleWRvd24gcG91ciBsZSBtb2R1bGUgZCdhcGVyXHUwMEU3dSBkaXJlY3RcbiAgICAgICAgdGhpcy5yZWdpc3RlckRvbUV2ZW50KGRvY3VtZW50LCAna2V5ZG93bicsIHRoaXMuaGFuZGxlS2V5RG93bi5iaW5kKHRoaXMpKTtcbiAgICBcbiAgICAgICAgLy8gSW5qZWN0ZXIgbGUgQ1NTIHBvdXIgbGEgbWlzZSBlbiBcdTAwRTl2aWRlbmNlXG4gICAgICAgIGF3YWl0IGluamVjdENTU0Zyb21GaWxlKHRoaXMsIFwic3R5bGVzLmNzc1wiKTtcblxuICAgICAgICAvLyBFbnJlZ2lzdHJlciBsJ2V4dGVuc2lvbiBkZSBsJ1x1MDBFOWRpdGV1ciBwb3VyIGxlcyBkXHUwMEU5Y29yYXRpb25zXG4gICAgICAgIHRoaXMucmVnaXN0ZXJFZGl0b3JFeHRlbnNpb24oY3JlYXRlRGVjb3JhdGlvbnModGhpcy5zZXR0aW5ncykpO1xuXG4gICAgICAgIC8vIEFqb3V0ZXIgbGUgYm91dG9uIGRhbnMgbGEgYmFycmUgZCdcdTAwRTl0YXQgc2kgbCdvcHRpb24gZXN0IGFjdGl2XHUwMEU5ZVxuICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5oaWdobGlnaHRCdXR0b24pIHtcbiAgICAgICAgICAgIHRoaXMuc3RhdHVzQmFyQnV0dG9uID0gY3JlYXRlU3RhdHVzQmFyQnV0dG9uKFxuICAgICAgICAgICAgICAgIHRoaXMsIFxuICAgICAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MuaGlnaGxpZ2h0RW5hYmxlZCxcbiAgICAgICAgICAgICAgICB0aGlzLnRvZ2dsZUhpZ2hsaWdodC5iaW5kKHRoaXMpXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBcbiAgICAgICAgLy8gQWpvdXRlciBsZSBib3V0b24gZGFucyBsYSBiYXJyZSBkZSB0aXRyZSBkZXMgb25nbGV0cyBzaSBsJ29wdGlvbiBlc3QgYWN0aXZcdTAwRTllXG4gICAgICAgIGlmICh0aGlzLnNldHRpbmdzLnRhYlRpdGxlQmFyQnV0dG9uKSB7XG4gICAgICAgICAgICB0aGlzLnRhYlRpdGxlQmFyQnV0dG9uID0gY3JlYXRlVGFiVGl0bGVCYXJCdXR0b24oXG4gICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICB0aGlzLnNldHRpbmdzLmhpZ2hsaWdodEVuYWJsZWQsXG4gICAgICAgICAgICAgICAgdGhpcy50b2dnbGVIaWdobGlnaHQuYmluZCh0aGlzKVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gQWpvdXRlciBsYSBjb21tYW5kZSBwb3VyIGFwcGxpcXVlciBsZXMgclx1MDBFOGdsZXMgdHlwb2dyYXBoaXF1ZXMgKHZpYSBsZSBtb2R1bGUgZGUgdHJhaXRlbWVudCBwYXIgbG90KVxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6ICdhcHBseS1mcmVuY2gtdHlwb2dyYXBoeScsXG4gICAgICAgICAgICBuYW1lOiAnQXBwbGlxdWVyIGxlcyByXHUwMEU4Z2xlcyB0eXBvZ3JhcGhpcXVlcyBmcmFuXHUwMEU3YWlzZXMnLFxuICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBhY3RpdmVWaWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcbiAgICAgICAgICAgICAgICBpZiAoYWN0aXZlVmlldykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmJhdGNoTW9kdWxlLmFwcGx5VHlwb2dyYXBoaWNSdWxlcyhhY3RpdmVWaWV3LmVkaXRvcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGhvdGtleXM6IFt7IG1vZGlmaWVyczogW1wiQWx0XCJdLCBrZXk6IFwiZlwiIH1dXG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIEFqb3V0ZXIgbGEgY29tbWFuZGUgcG91ciBhY3RpdmVyL2RcdTAwRTlzYWN0aXZlciBsYSBtaXNlIGVuIFx1MDBFOXZpZGVuY2VcbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIGlkOiAndG9nZ2xlLWhpZ2hsaWdodCcsXG4gICAgICAgICAgICBuYW1lOiAnQWZmaWNoZXIvTWFzcXVlciBsZXMgY2FyYWN0XHUwMEU4cmVzIGludmlzaWJsZXMnLFxuICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnRvZ2dsZUhpZ2hsaWdodCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIC8vIEVucmVnaXN0cmVyIHVuIFx1MDBFOXZcdTAwRTluZW1lbnQgcG91ciBtZXR0cmUgXHUwMEUwIGpvdXIgbGUgYm91dG9uIGRlIGxhIGJhcnJlIGRlIHRpdHJlXG4gICAgICAgIC8vIGxvcnNxdWUgbCd1dGlsaXNhdGV1ciBjaGFuZ2UgZCdvbmdsZXQgb3UgZGUgdnVlXG4gICAgICAgIHRoaXMucmVnaXN0ZXJFdmVudChcbiAgICAgICAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS5vbignYWN0aXZlLWxlYWYtY2hhbmdlJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIC8vIFJlY3JcdTAwRTllciBsZSBib3V0b24gZGUgbGEgYmFycmUgZGUgdGl0cmUgc2kgbCdvcHRpb24gZXN0IGFjdGl2XHUwMEU5ZVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnNldHRpbmdzLnRhYlRpdGxlQmFyQnV0dG9uKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFN1cHByaW1lciBsJ2FuY2llbiBib3V0b24gcydpbCBleGlzdGVcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMudGFiVGl0bGVCYXJCdXR0b24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudGFiVGl0bGVCYXJCdXR0b24ucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIENyXHUwMEU5ZXIgdW4gbm91dmVhdSBib3V0b25cbiAgICAgICAgICAgICAgICAgICAgdGhpcy50YWJUaXRsZUJhckJ1dHRvbiA9IGNyZWF0ZVRhYlRpdGxlQmFyQnV0dG9uKFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MuaGlnaGxpZ2h0RW5hYmxlZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudG9nZ2xlSGlnaGxpZ2h0LmJpbmQodGhpcylcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICApO1xuICAgIH1cblxuICAgIC8vIEdcdTAwRTlyZXIgbGVzIFx1MDBFOXZcdTAwRTluZW1lbnRzIGNsYXZpZXIgKGRcdTAwRTlsXHUwMEU4Z3VlIGF1IG1vZHVsZSBkJ2FwZXJcdTAwRTd1IGRpcmVjdClcbiAgICBwcml2YXRlIGhhbmRsZUtleURvd24oZXZlbnQ6IEtleWJvYXJkRXZlbnQpIHtcbiAgICAgICAgY29uc3QgYWN0aXZlVmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XG4gICAgICAgIGlmICghYWN0aXZlVmlldyB8fCBhY3RpdmVWaWV3LmdldE1vZGUoKSAhPT0gJ3NvdXJjZScpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgIFxuICAgICAgICBjb25zdCBsZWFmID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYWYoKTtcbiAgICAgICAgaWYgKCFsZWFmKSByZXR1cm47XG4gICAgXG4gICAgICAgIGNvbnN0IGFjdGl2ZVN0YXRlID0gbGVhZi5nZXRWaWV3U3RhdGUoKS5zdGF0ZTtcbiAgICAgICAgaWYgKCFhY3RpdmVTdGF0ZSkgcmV0dXJuO1xuICAgIFxuICAgICAgICBpZiAoYWN0aXZlVmlldyAmJiBhY3RpdmVWaWV3LmdldE1vZGUoKSA9PT0gJ3NvdXJjZScgJiYgYWN0aXZlU3RhdGVbXCJzb3VyY2VcIl0gPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAvLyBEXHUwMEU5bFx1MDBFOWd1ZXIgbGUgdHJhaXRlbWVudCBhdSBtb2R1bGUgZCdhcGVyXHUwMEU3dSBkaXJlY3RcbiAgICAgICAgICAgIHRoaXMubGl2ZU1vZHVsZS5oYW5kbGVLZXlFdmVudChldmVudCwgYWN0aXZlVmlldy5lZGl0b3IpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgYXN5bmMgc2F2ZVNldHRpbmdzKCkge1xuICAgICAgICBhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpO1xuICAgICAgICBcbiAgICAgICAgLy8gTWV0dHJlIFx1MDBFMCBqb3VyIGxlcyBtb2R1bGVzIGF2ZWMgbGVzIG5vdXZlYXV4IHBhcmFtXHUwMEU4dHJlc1xuICAgICAgICB0aGlzLmxpdmVNb2R1bGUudXBkYXRlU2V0dGluZ3ModGhpcy5zZXR0aW5ncyk7XG4gICAgICAgIHRoaXMuYmF0Y2hNb2R1bGUudXBkYXRlU2V0dGluZ3ModGhpcy5zZXR0aW5ncyk7XG4gICAgICAgIFxuICAgICAgICAvLyBNZXR0cmUgXHUwMEUwIGpvdXIgbCdVSVxuICAgICAgICB1cGRhdGVTdGF0dXNCYXJCdXR0b24odGhpcy5zdGF0dXNCYXJCdXR0b24sIHRoaXMuc2V0dGluZ3MuaGlnaGxpZ2h0RW5hYmxlZCk7XG4gICAgICAgIHVwZGF0ZVRhYlRpdGxlQmFyQnV0dG9uKHRoaXMudGFiVGl0bGVCYXJCdXR0b24sIHRoaXMuc2V0dGluZ3MuaGlnaGxpZ2h0RW5hYmxlZCk7XG4gICAgICAgIHRoaXMucmVmcmVzaERlY29yYXRpb25zKCk7XG4gICAgfVxuXG4gICAgLy8gQWN0aXZlci9kXHUwMEU5c2FjdGl2ZXIgbGEgbWlzZSBlbiBcdTAwRTl2aWRlbmNlXG4gICAgdG9nZ2xlSGlnaGxpZ2h0KCkge1xuICAgICAgICB0aGlzLnNldHRpbmdzLmhpZ2hsaWdodEVuYWJsZWQgPSAhdGhpcy5zZXR0aW5ncy5oaWdobGlnaHRFbmFibGVkO1xuICAgICAgICB0aGlzLnNhdmVTZXR0aW5ncygpO1xuICAgIH1cblxuICAgIC8vIFJhZnJhXHUwMEVFY2hpciBsZXMgZFx1MDBFOWNvcmF0aW9uc1xuICAgIHJlZnJlc2hEZWNvcmF0aW9ucygpIHtcbiAgICAgICAgdGhpcy5hcHAud29ya3NwYWNlLml0ZXJhdGVBbGxMZWF2ZXMoKGxlYWYpID0+IHtcbiAgICAgICAgICAgIGlmIChsZWFmLnZpZXcgaW5zdGFuY2VvZiBNYXJrZG93blZpZXcgJiYgbGVhZi52aWV3LmVkaXRvcikge1xuICAgICAgICAgICAgICAgIGNvbnN0IGVkaXRvclZpZXcgPSAobGVhZi52aWV3LmVkaXRvciBhcyBhbnkpLmNtIGFzIEVkaXRvclZpZXc7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYgKGVkaXRvclZpZXcpIHtcbiAgICAgICAgICAgICAgICAgICAgZWRpdG9yVmlldy5kaXNwYXRjaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ2VzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJvbTogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bzogZWRpdG9yVmlldy5zdGF0ZS5kb2MubGVuZ3RoLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc2VydDogZWRpdG9yVmlldy5zdGF0ZS5kb2MudG9TdHJpbmcoKVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIG9udW5sb2FkKCkge1xuICAgICAgICAvLyBOZXR0b3llciBsZXMgXHUwMEU5bFx1MDBFOW1lbnRzIFVJXG4gICAgICAgIHJlbW92ZVRhYlRpdGxlQmFyQnV0dG9uKHRoaXMudGFiVGl0bGVCYXJCdXR0b24pO1xuICAgIH1cbn1cblxuIiwgIi8vIEZpY2hpZXIgc2V0dGluZ3MudHMgYXZlYyBsZXMgbm91dmVsbGVzIG9wdGlvbnNcclxuXHJcbi8qKlxyXG4gKiBJbnRlcmZhY2UgcG91ciBsZXMgcGFyYW1cdTAwRTh0cmVzIGR1IHBsdWdpblxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBNaWNyb3R5cG9ncmFwaGllU2V0dGluZ3Mge1xyXG4gICAgb3BlbkRvdWJsZVF1b3RlOiBzdHJpbmc7XHJcbiAgICBjbG9zZURvdWJsZVF1b3RlOiBzdHJpbmc7XHJcbiAgICBvcGVuU2luZ2xlUXVvdGU6IHN0cmluZztcclxuICAgIGNsb3NlU2luZ2xlUXVvdGU6IHN0cmluZztcclxuICAgIGZyZW5jaFJ1bGVzRW5hYmxlZDogYm9vbGVhbjtcclxuICAgIGRhc2hlc0VuYWJsZWQ6IGJvb2xlYW47ICAgICAvLyBDb252ZXJ0aXIgLS0gZW4gXHUyMDEzLCBcdTIwMTMtIGVuIFx1MjAxNCwgXHUyMDE0LSBlbiAtLS1cclxuICAgIHNraXBFbkRhc2g6IGJvb2xlYW47ICAgICAgICAvLyBDb252ZXJ0aXIgZGlyZWN0ZW1lbnQgLS0gZW4gXHUyMDE0IChzYXV0ZXIgbGUgdGlyZXQgZGVtaS1jYWRyYXRpbilcclxuICAgIGVsbGlwc2lzRW5hYmxlZDogYm9vbGVhbjsgICAvLyBDb252ZXJ0aXIgLi4uIGVuIFx1MjAyNlxyXG4gICAgZ3VpbGxlbWV0c0VuYWJsZWQ6IGJvb2xlYW47IC8vIENvbnZlcnRpciA8PCBldCA+PiBlbiBcdTAwQUIgZXQgXHUwMEJCXHJcbiAgICBoaWdobGlnaHRFbmFibGVkOiBib29sZWFuO1xyXG4gICAgaGlnaGxpZ2h0QnV0dG9uOiBib29sZWFuO1xyXG4gICAgdGFiVGl0bGVCYXJCdXR0b246IGJvb2xlYW47IC8vIEJvdXRvbiBkYW5zIGxhIGJhcnJlIGRlIHRpdHJlIGRlcyBvbmdsZXRzXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBQYXJhbVx1MDBFOHRyZXMgcGFyIGRcdTAwRTlmYXV0XHJcbiAqL1xyXG5leHBvcnQgY29uc3QgREVGQVVMVF9TRVRUSU5HUzogTWljcm90eXBvZ3JhcGhpZVNldHRpbmdzID0ge1xyXG4gICAgb3BlbkRvdWJsZVF1b3RlOiBcIlx1MDBBQlxcdTIwMkZcIiwgIC8vIEd1aWxsZW1ldCBmcmFuXHUwMEU3YWlzIG91dnJhbnQgYXZlYyBlc3BhY2UgZmluZSBpbnNcdTAwRTljYWJsZVxyXG4gICAgY2xvc2VEb3VibGVRdW90ZTogXCJcXHUyMDJGXHUwMEJCXCIsIC8vIEd1aWxsZW1ldCBmcmFuXHUwMEU3YWlzIGZlcm1hbnQgYXZlYyBlc3BhY2UgZmluZSBpbnNcdTAwRTljYWJsZVxyXG4gICAgb3BlblNpbmdsZVF1b3RlOiBcIlx1MjAxQ1wiLCAgICAgICAgLy8gQXBvc3Ryb3BoZSB0eXBvZ3JhcGhpcXVlXHJcbiAgICBjbG9zZVNpbmdsZVF1b3RlOiBcIlx1MjAxRFwiLCAgICAgICAvLyBBcG9zdHJvcGhlIHR5cG9ncmFwaGlxdWVcclxuICAgIGZyZW5jaFJ1bGVzRW5hYmxlZDogdHJ1ZSxcclxuICAgIGRhc2hlc0VuYWJsZWQ6IHRydWUsXHJcbiAgICBza2lwRW5EYXNoOiBmYWxzZSxcclxuICAgIGVsbGlwc2lzRW5hYmxlZDogdHJ1ZSxcclxuICAgIGd1aWxsZW1ldHNFbmFibGVkOiBmYWxzZSxcclxuICAgIGhpZ2hsaWdodEVuYWJsZWQ6IGZhbHNlLFxyXG4gICAgaGlnaGxpZ2h0QnV0dG9uOiB0cnVlLFxyXG4gICAgdGFiVGl0bGVCYXJCdXR0b246IHRydWUsICAgICAvLyBBY3Rpdlx1MDBFOSBwYXIgZFx1MDBFOWZhdXRcclxufTtcclxuXHJcblxyXG4vKipcclxuICogVlx1MDBFOXJpZmllIHNpIGxlcyBwYXJhbVx1MDBFOHRyZXMgc29udCB2YWxpZGVzIGV0IGNvbXBsZXRzXHJcbiAqIEBwYXJhbSBzZXR0aW5ncyBQYXJhbVx1MDBFOHRyZXMgXHUwMEUwIHZcdTAwRTlyaWZpZXJcclxuICogQHJldHVybnMgUGFyYW1cdTAwRTh0cmVzIHZhbGlkXHUwMEU5cyBldCBjb21wbFx1MDBFOXRcdTAwRTlzIHNpIG5cdTAwRTljZXNzYWlyZVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlU2V0dGluZ3Moc2V0dGluZ3M6IFBhcnRpYWw8TWljcm90eXBvZ3JhcGhpZVNldHRpbmdzPik6IE1pY3JvdHlwb2dyYXBoaWVTZXR0aW5ncyB7XHJcbiAgICBjb25zdCB2YWxpZGF0ZWRTZXR0aW5ncyA9IHsgLi4uREVGQVVMVF9TRVRUSU5HUyB9O1xyXG4gICAgXHJcbiAgICBpZiAoc2V0dGluZ3MpIHtcclxuICAgICAgICBPYmplY3Qua2V5cyhERUZBVUxUX1NFVFRJTkdTKS5mb3JFYWNoKGtleSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChrZXkgaW4gc2V0dGluZ3MpIHtcclxuICAgICAgICAgICAgICAgICh2YWxpZGF0ZWRTZXR0aW5ncyBhcyBhbnkpW2tleV0gPSAoc2V0dGluZ3MgYXMgYW55KVtrZXldO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJldHVybiB2YWxpZGF0ZWRTZXR0aW5ncztcclxufSIsICJpbXBvcnQgeyBBcHAsIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuLy8gaW1wb3J0IHsgTWljcm90eXBvZ3JhcGhpZVNldHRpbmdzIH0gZnJvbSBcIi4vc2V0dGluZ3NcIjtcclxuaW1wb3J0IHR5cGUgTWljcm90eXBvZ3JhcGhpZSBmcm9tIFwiLi4vLi4vbWFpblwiO1xyXG5cclxuLyoqXHJcbiAqIE9uZ2xldCBkZSBjb25maWd1cmF0aW9uIGR1IHBsdWdpbiBkYW5zIGxlcyBwYXJhbVx1MDBFOHRyZXMgZCdPYnNpZGlhblxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIE1pY3JvdHlwb2dyYXBoaWVTZXR0aW5nVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XHJcbiAgcGx1Z2luOiBNaWNyb3R5cG9ncmFwaGllO1xyXG4gIHByaXZhdGUgd29yZHNJbnB1dENvbnRhaW5lcjogSFRNTEVsZW1lbnQ7IC8vIFBvdXIgc3RvY2tlciBsYSByXHUwMEU5Zlx1MDBFOXJlbmNlIGF1IGNvbnRhaW5lciBkdSBjaGFtcCBkZSB0ZXh0ZVxyXG5cclxuICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBNaWNyb3R5cG9ncmFwaGllKSB7XHJcbiAgICBzdXBlcihhcHAsIHBsdWdpbik7XHJcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcclxuICB9XHJcblxyXG4gIGRpc3BsYXkoKTogdm9pZCB7XHJcbiAgICBjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xyXG5cclxuICAgIGNvbnRhaW5lckVsLmVtcHR5KCk7XHJcblxyXG4gICAgY29udGFpbmVyRWwuY3JlYXRlRWwoXCJoM1wiLCB7IHRleHQ6IFwiTWljcm90eXBvZ3JhcGhpZVwiIH0pO1xyXG5cclxuICAgIC8vIEJsb2MgZCdpbmZvcm1hdGlvblxyXG4gICAgLy8gdGhpcy5jcmVhdGVJbmZvQmxvY2soY29udGFpbmVyRWwpO1xyXG5cclxuICAgIC8vIFBhcmFtXHUwMEU4dHJlcyBkZSBiYXNlXHJcbiAgICB0aGlzLmNyZWF0ZUJhc2ljU2V0dGluZ3MoY29udGFpbmVyRWwpO1xyXG5cclxuICAgIC8vIFBhcmFtXHUwMEU4dHJlcyBkZSBtaXNlIGVuIFx1MDBFOXZpZGVuY2VcclxuICAgIHRoaXMuY3JlYXRlSGlnaGxpZ2h0U2V0dGluZ3MoY29udGFpbmVyRWwpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ3JcdTAwRTllIGxlIGJsb2MgZCdpbmZvcm1hdGlvblxyXG4gICAqIEBwYXJhbSBjb250YWluZXJFbCBDb250ZW5ldXIgcGFyZW50XHJcbiAgICovXHJcbiAgcHJpdmF0ZSBjcmVhdGVJbmZvQmxvY2soY29udGFpbmVyRWw6IEhUTUxFbGVtZW50KTogdm9pZCB7XHJcbiAgICBjb25zdCBpbmZvQ29udGFpbmVyID0gY29udGFpbmVyRWwuY3JlYXRlRWwoXCJkaXZcIiwge1xyXG4gICAgICBjbHM6IFwibWljcm90eXBvZ3JhcGhpZS1pbmZvLWNvbnRhaW5lclwiLFxyXG4gICAgfSk7XHJcblxyXG4gICAgY29uc3QgaW5mb0NvbnRlbnQgPSBpbmZvQ29udGFpbmVyLmNyZWF0ZUVsKFwiZGl2XCIsIHtcclxuICAgICAgY2xzOiBcIm1pY3JvdHlwb2dyYXBoaWUtaW5mby1jb250ZW50XCIsXHJcbiAgICB9KTtcclxuXHJcbiAgICBpbmZvQ29udGVudC5jcmVhdGVFbChcInBcIiwge1xyXG4gICAgICB0ZXh0OiBcIkNlIHBsdWdpbiBhcHBsaXF1ZSBhdXRvbWF0aXF1ZW1lbnQgdW5lIHBhcnRpZSBkZXMgclx1MDBFOGdsZXMgdHlwb2dyYXBoaXF1ZXMgZnJhblx1MDBFN2Fpc2VzIHBlbmRhbnQgbGEgc2Fpc2llLlwiLFxyXG4gICAgfSk7XHJcblxyXG4gICAgY29uc3QgcnVsZXNMaXN0ID0gaW5mb0NvbnRlbnQuY3JlYXRlRWwoXCJ1bFwiKTtcclxuICAgIHJ1bGVzTGlzdC5jcmVhdGVFbChcImxpXCIsIHtcclxuICAgICAgdGV4dDogXCJFc3BhY2VzIGluc1x1MDBFOWNhYmxlcyBhdmFudCBsZXMgcG9uY3R1YXRpb25zIGRvdWJsZXMgKCEgPyA7IFx1MDBCQilcIixcclxuICAgIH0pO1xyXG4gICAgcnVsZXNMaXN0LmNyZWF0ZUVsKFwibGlcIiwgeyB0ZXh0OiBcIkVzcGFjZXMgZmluZXMgaW5zXHUwMEU5Y2FibGVzIGF2YW50ICg6KVwiIH0pO1xyXG4gICAgcnVsZXNMaXN0LmNyZWF0ZUVsKFwibGlcIiwge1xyXG4gICAgICB0ZXh0OiBcIkVzcGFjZXMgZmluZXMgaW5zXHUwMEU5Y2FibGVzIGRhbnMgbGVzIGd1aWxsZW1ldHMgZnJhblx1MDBFN2FpcyAoXHUwMEFCXFx1MjAyRnBocmFzZVxcdTIwMkZcdTAwQkIpXCIsXHJcbiAgICB9KTtcclxuICAgIHJ1bGVzTGlzdC5jcmVhdGVFbChcImxpXCIsIHsgdGV4dDogXCJBcG9zdHJvcGhlIHR5cG9ncmFwaGlxdWUgKFx1MjAxOSlcIiB9KTtcclxuICAgIHJ1bGVzTGlzdC5jcmVhdGVFbChcImxpXCIsIHtcclxuICAgICAgdGV4dDogXCJDb252ZXJzaW9uIGRlICgtLSkgZW4gdGlyZXQgY2FkcmF0aW4gKFx1MjAxNClcIixcclxuICAgIH0pO1xyXG5cclxuICAgIGluZm9Db250ZW50LmNyZWF0ZUVsKFwicFwiLCB7XHJcbiAgICAgIHRleHQ6IFwiVXRpbGlzZXogQWx0K0YgcG91ciBhcHBsaXF1ZXIgdG91dGVzIGxlcyByXHUwMEU4Z2xlcyBzdXIgdW4gdGV4dGUgZXhpc3RhbnQuXCIsXHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zdCB0cmFuc2Zvcm1hdGlvbnNMaXN0ID0gaW5mb0NvbnRlbnQuY3JlYXRlRWwoXCJ1bFwiKTtcclxuICAgIHRyYW5zZm9ybWF0aW9uc0xpc3QuY3JlYXRlRWwoXCJsaVwiLCB7XHJcbiAgICAgIHRleHQ6ICdDb252ZXJzaW9uIGRlIChcIiBcIikgZW4gZ3VpbGxlbWV0cyBmcmFuXHUwMEU3YWlzIChcdTAwQUIgXHUwMEJCKScsXHJcbiAgICB9KTtcclxuICAgIHRyYW5zZm9ybWF0aW9uc0xpc3QuY3JlYXRlRWwoXCJsaVwiLCB7XHJcbiAgICAgIHRleHQ6IFwiQ29udmVyc2lvbiBkZSAnIGVuIGFwb3N0cm9waGUgdHlwb2dyYXBoaXF1ZSAoXHUyMDE5KVwiLFxyXG4gICAgfSk7XHJcbiAgICB0cmFuc2Zvcm1hdGlvbnNMaXN0LmNyZWF0ZUVsKFwibGlcIiwge1xyXG4gICAgICB0ZXh0OiBcIkVzcGFjZSBmaW5lIGluc1x1MDBFOWNhYmxlIGF2YW50IDogKCEgPyA7IFx1MDBCQiBcdTIwM0EpXCIsXHJcbiAgICB9KTtcclxuICAgIHRyYW5zZm9ybWF0aW9uc0xpc3QuY3JlYXRlRWwoXCJsaVwiLCB7XHJcbiAgICAgIHRleHQ6IFwiRXNwYWNlIGluc1x1MDBFOWNhYmxlIGF2YW50IDogKDopXCIsXHJcbiAgICB9KTtcclxuICAgIHRyYW5zZm9ybWF0aW9uc0xpc3QuY3JlYXRlRWwoXCJsaVwiLCB7XHJcbiAgICAgIHRleHQ6IFwiRXNwYWNlIGZpbmUgaW5zXHUwMEU5Y2FibGUgYXByXHUwMEU4cyA6IChcdTAwQUIgXHUyMDM5KVwiLFxyXG4gICAgfSk7XHJcbiAgICB0cmFuc2Zvcm1hdGlvbnNMaXN0LmNyZWF0ZUVsKFwibGlcIiwge1xyXG4gICAgICB0ZXh0OiBcIkVzcGFjZSBpbnNcdTAwRTljYWJsZSBhcHJcdTAwRThzIGxlcyBtb3RzIGQndW5lIGxldHRyZSAoYSwgeSwgXHUwMEUwIFx1MjAyNilcIixcclxuICAgIH0pO1xyXG4gICAgdHJhbnNmb3JtYXRpb25zTGlzdC5jcmVhdGVFbChcImxpXCIsIHtcclxuICAgICAgdGV4dDogXCJFc3BhY2UgaW5zXHUwMEU5Y2FibGUgZGFucyBsZXMgbm9tcyBjb21wb3NcdTAwRTlzIChKZWFuXFx1MDBBMER1cG9udClcIixcclxuICAgIH0pO1xyXG4gICAgdHJhbnNmb3JtYXRpb25zTGlzdC5jcmVhdGVFbChcImxpXCIsIHtcclxuICAgICAgdGV4dDogXCJFc3BhY2UgaW5zXHUwMEU5Y2FibGUgYXZhbnQgbGVzIGluaXRpYWxlcyAoTS5cXHUwMEEwRHVwb250KVwiLFxyXG4gICAgfSk7XHJcbiAgICB0cmFuc2Zvcm1hdGlvbnNMaXN0LmNyZWF0ZUVsKFwibGlcIiwge1xyXG4gICAgICB0ZXh0OiBcIkVzcGFjZSBpbnNcdTAwRTljYWJsZSBhdmFudCAoc2lcdTAwRThjbGUpIChYWGVcXHUwMEEwc2lcdTAwRThjbGUpXCIsXHJcbiAgICB9KTtcclxuICAgIHRyYW5zZm9ybWF0aW9uc0xpc3QuY3JlYXRlRWwoXCJsaVwiLCB7XHJcbiAgICAgIHRleHQ6IFwiQ29udmVyc2lvbiBkZSAob2UvT0UpIGVuIGxpZ2F0dXJlcyAoXHUwMTUzL1x1MDE1MilcIixcclxuICAgIH0pO1xyXG4gICAgdHJhbnNmb3JtYXRpb25zTGlzdC5jcmVhdGVFbChcImxpXCIsIHtcclxuICAgICAgdGV4dDogXCJDb252ZXJzaW9uIGRlICgtLSkgZW4gdGlyZXQgY2FkcmF0aW4gKFx1MjAxNClcIixcclxuICAgIH0pO1xyXG4gICAgdHJhbnNmb3JtYXRpb25zTGlzdC5jcmVhdGVFbChcImxpXCIsIHtcclxuICAgICAgdGV4dDogXCJDb252ZXJzaW9uIGRlICguLi4pIGVuIHBvaW50cyBkZSBzdXNwZW5zaW9uIChcdTIwMjYpXCIsXHJcbiAgICB9KTtcclxuXHJcbiAgICBpbmZvQ29udGVudC5jcmVhdGVFbChcInBcIiwge1xyXG4gICAgICB0ZXh0OiBcIkluZm8gcG91ciBpbnNcdTAwRTlyZXIgdW5lIGVzcGFjZSBpbnNcdTAwRTljYWJsZSBhdmVjIE9ic2lkaWFuIDpcIixcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIENyXHUwMEU5ZXIgdW5lIGxpc3RlIHBvdXIgbGVzIHJhY2NvdXJjaXNcclxuICAgIGNvbnN0IHNob3J0Y3V0c0xpc3QgPSBpbmZvQ29udGVudC5jcmVhdGVFbChcInVsXCIpO1xyXG4gICAgc2hvcnRjdXRzTGlzdC5jcmVhdGVFbChcImxpXCIsIHsgdGV4dDogXCJXaW5kb3dzIDogQWx0KzI1NVwiIH0pO1xyXG4gICAgc2hvcnRjdXRzTGlzdC5jcmVhdGVFbChcImxpXCIsIHsgdGV4dDogXCJtYWNPUyA6IEFsdCtFc3BhY2VcIiB9KTtcclxuXHJcbiAgICAvLyBBam91dGVyIGR1IHN0eWxlIENTUyBlbiBsaWduZSBwb3VyIGxlIGJsb2MgZCdpbmZvcm1hdGlvblxyXG4gICAgdGhpcy5hZGRJbmZvQmxvY2tTdHlsZXMoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEFqb3V0ZSBsZXMgc3R5bGVzIENTUyBwb3VyIGxlIGJsb2MgZCdpbmZvcm1hdGlvblxyXG4gICAqL1xyXG4gIHByaXZhdGUgYWRkSW5mb0Jsb2NrU3R5bGVzKCk6IHZvaWQge1xyXG4gICAgY29uc3Qgc3R5bGVFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInN0eWxlXCIpO1xyXG4gICAgc3R5bGVFbGVtZW50LnRleHRDb250ZW50ID0gYFxyXG4gICAgICAgIC5taWNyb3R5cG9ncmFwaGllLWluZm8tY29udGFpbmVyIHtcclxuICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSh2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQtcmdiKSwgMC4xKTtcclxuICAgICAgICAgICAgYm9yZGVyLWxlZnQ6IDRweCBzb2xpZCB2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQpO1xyXG4gICAgICAgICAgICBtYXJnaW46IDFlbSAwO1xyXG4gICAgICAgICAgICBwYWRkaW5nOiAxZW07XHJcbiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDRweDtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLm1pY3JvdHlwb2dyYXBoaWUtaW5mby1jb250YWluZXIgaDIge1xyXG4gICAgICAgICAgICBtYXJnaW4tdG9wOiAwO1xyXG4gICAgICAgICAgICBmb250LXNpemU6IDEuMmVtO1xyXG4gICAgICAgICAgICBjb2xvcjogdmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLm1pY3JvdHlwb2dyYXBoaWUtaW5mby1jb250ZW50IHAge1xyXG4gICAgICAgICAgICBtYXJnaW46IDAuNWVtIDA7XHJcbiAgICAgICAgfVxyXG4gICAgYDtcclxuXHJcbiAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKHN0eWxlRWxlbWVudCk7XHJcbiAgfVxyXG5cclxuLyoqXHJcbiAqIENyXHUwMEU5ZSBsZXMgcGFyYW1cdTAwRTh0cmVzIGRlIGJhc2VcclxuICogQHBhcmFtIGNvbnRhaW5lckVsIENvbnRlbmV1ciBwYXJlbnRcclxuICovXHJcbnByaXZhdGUgY3JlYXRlQmFzaWNTZXR0aW5ncyhjb250YWluZXJFbDogSFRNTEVsZW1lbnQpOiB2b2lkIHtcclxuICAvLyBBam91dGVyIGxlcyBub3V2ZWF1eCBwYXJhbVx1MDBFOHRyZXMgcGVyc29ubmFsaXNhYmxlc1xyXG4gIGNvbnN0IGRlc0VsID0gY29udGFpbmVyRWwuY3JlYXRlRWwoXCJwXCIsIHtcclxuICAgIHRleHQ6IFwiQ2FyYWN0XHUwMEU4cmVzIHR5cG9ncmFwaGlxdWVzIHBlcnNvbm5hbGlzYWJsZXNcIixcclxuICB9KTtcclxuICBkZXNFbC5zdHlsZS5mb250V2VpZ2h0ID0gXCJib2xkXCI7XHJcblxyXG4gIC8vIE9wdGlvbiBwb3VyIGxlIGd1aWxsZW1ldCBkb3VibGUgb3V2cmFudFxyXG4gIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgLnNldE5hbWUoXCJHdWlsbGVtZXQgZG91YmxlIG91dnJhbnRcIilcclxuICAgIC5hZGRUZXh0KCh0ZXh0KSA9PlxyXG4gICAgICB0ZXh0XHJcbiAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLm9wZW5Eb3VibGVRdW90ZSlcclxuICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5vcGVuRG91YmxlUXVvdGUgPSB2YWx1ZTtcclxuICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgIH0pXHJcbiAgICApO1xyXG5cclxuICAvLyBPcHRpb24gcG91ciBsZSBndWlsbGVtZXQgZG91YmxlIGZlcm1hbnRcclxuICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgIC5zZXROYW1lKFwiR3VpbGxlbWV0IGRvdWJsZSBmZXJtYW50XCIpXHJcbiAgICAuYWRkVGV4dCgodGV4dCkgPT5cclxuICAgICAgdGV4dFxyXG4gICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5jbG9zZURvdWJsZVF1b3RlKVxyXG4gICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmNsb3NlRG91YmxlUXVvdGUgPSB2YWx1ZTtcclxuICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgIH0pXHJcbiAgICApO1xyXG5cclxuICAvLyBPcHRpb24gcG91ciBsZSBndWlsbGVtZXQgc2ltcGxlIG91dnJhbnQgKGFwb3N0cm9waGUpXHJcbiAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAuc2V0TmFtZShcIkd1aWxsZW1ldCBzaW1wbGUgb3V2cmFudFwiKVxyXG4gICAgLmFkZFRleHQoKHRleHQpID0+XHJcbiAgICAgIHRleHRcclxuICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Mub3BlblNpbmdsZVF1b3RlKVxyXG4gICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLm9wZW5TaW5nbGVRdW90ZSA9IHZhbHVlO1xyXG4gICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgfSlcclxuICAgICk7XHJcblxyXG4gIC8vIE9wdGlvbiBwb3VyIGxlIGd1aWxsZW1ldCBzaW1wbGUgZmVybWFudCAoYXBvc3Ryb3BoZSlcclxuICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgIC5zZXROYW1lKFwiR3VpbGxlbWV0IHNpbXBsZSBmZXJtYW50XCIpXHJcbiAgICAuYWRkVGV4dCgodGV4dCkgPT5cclxuICAgICAgdGV4dFxyXG4gICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5jbG9zZVNpbmdsZVF1b3RlKVxyXG4gICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmNsb3NlU2luZ2xlUXVvdGUgPSB2YWx1ZTtcclxuICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgIH0pXHJcbiAgICApO1xyXG5cclxuICAvLyBTZWN0aW9uIHBvdXIgbGVzIG5vdXZlbGxlcyBvcHRpb25zXHJcbiAgY29uc3QgdHJhbnNmb3JtVGl0bGUgPSBjb250YWluZXJFbC5jcmVhdGVFbChcInBcIiwge1xyXG4gICAgdGV4dDogXCJPcHRpb25zXCIsXHJcbiAgfSk7XHJcbiAgdHJhbnNmb3JtVGl0bGUuc3R5bGUuZm9udFdlaWdodCA9IFwiYm9sZFwiO1xyXG4gIHRyYW5zZm9ybVRpdGxlLnN0eWxlLm1hcmdpblRvcCA9IFwiMS41ZW1cIjtcclxuXHJcbiAgLy8gT3B0aW9uIHBvdXIgbGVzIHRpcmV0c1xyXG4gIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgLnNldE5hbWUoXCJUaXJldHNcIilcclxuICAgIC5zZXREZXNjKFxyXG4gICAgICBcIi0tIGRldmllbnQgdGlyZXQgZGVtaS1jYWRyYXRpbiAoXHUyMDEzKSwgXHUyMDEzLSBkZXZpZW50IHRpcmV0IGNhZHJhdGluIChcdTIwMTQpLCBcdTIwMTQtIGRldmllbnQgdHJvaXMgdGlyZXRzICgtLS0pXCJcclxuICAgIClcclxuICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cclxuICAgICAgdG9nZ2xlXHJcbiAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmRhc2hlc0VuYWJsZWQpXHJcbiAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZGFzaGVzRW5hYmxlZCA9IHZhbHVlO1xyXG4gICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgfSlcclxuICAgICk7XHJcblxyXG4gIC8vIE9wdGlvbiBwb3VyIHNhdXRlciBsZSB0aXJldCBkZW1pLWNhZHJhdGluXHJcbiAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAuc2V0TmFtZShcIklnbm9yZXIgbGUgdGlyZXQgZGVtaS1jYWRyYXRpblwiKVxyXG4gICAgLnNldERlc2MoXHJcbiAgICAgIFwiUXVhbmQgYWN0aXZcdTAwRTksIC0tIGVzdCBkaXJlY3RlbWVudCBjb252ZXJ0aSBlbiB0aXJldCBjYWRyYXRpbiAoXHUyMDE0KSBwbHV0XHUwMEY0dCBxdSdlbiBkZW1pLWNhZHJhdGluIChcdTIwMTMpXCJcclxuICAgIClcclxuICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cclxuICAgICAgdG9nZ2xlXHJcbiAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnNraXBFbkRhc2gpXHJcbiAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2tpcEVuRGFzaCA9IHZhbHVlO1xyXG4gICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgfSlcclxuICAgICk7XHJcblxyXG4gIC8vIE9wdGlvbiBwb3VyIGxlcyBwb2ludHMgZGUgc3VzcGVuc2lvblxyXG4gIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgLnNldE5hbWUoXCJQb2ludHMgZGUgc3VzcGVuc2lvblwiKVxyXG4gICAgLnNldERlc2MoXHJcbiAgICAgIFwiVHJvaXMgcG9pbnRzICguLi4pIHNlcm9udCBjb252ZXJ0aXMgZW4gcG9pbnRzIGRlIHN1c3BlbnNpb24gKFx1MjAyNilcIlxyXG4gICAgKVxyXG4gICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG4gICAgICB0b2dnbGVcclxuICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZWxsaXBzaXNFbmFibGVkKVxyXG4gICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmVsbGlwc2lzRW5hYmxlZCA9IHZhbHVlO1xyXG4gICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgfSlcclxuICAgICk7XHJcblxyXG4gIC8vIE9wdGlvbiBwb3VyIGxlcyBndWlsbGVtZXRzIGNoZXZyb25zXHJcbiAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAuc2V0TmFtZShcIkd1aWxsZW1ldHNcIilcclxuICAgIC5zZXREZXNjKFxyXG4gICAgICBcIkxlcyBjaGV2cm9ucyA8PCBldCA+PiBzZXJvbnQgY29udmVydGlzIGVuIGd1aWxsZW1ldHMgZnJhblx1MDBFN2FpcyBcdTAwQUIgZXQgXHUwMEJCXCJcclxuICAgIClcclxuICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cclxuICAgICAgdG9nZ2xlXHJcbiAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmd1aWxsZW1ldHNFbmFibGVkKVxyXG4gICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmd1aWxsZW1ldHNFbmFibGVkID0gdmFsdWU7XHJcbiAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICB9KVxyXG4gICAgKTtcclxuXHJcbiAgLy8gY29uc3QgZnJlbmNoUnVsZXNUaXRsZSA9IGNvbnRhaW5lckVsLmNyZWF0ZUVsKFwicFwiLCB7XHJcbiAgLy8gICB0ZXh0OiBcIlJcdTAwRThnbGVzIHR5cG9ncmFwaGlxdWVzIHBhciBsYW5ndWVcIixcclxuICAvLyB9KTtcclxuICAvLyBmcmVuY2hSdWxlc1RpdGxlLnN0eWxlLmZvbnRXZWlnaHQgPSBcImJvbGRcIjtcclxuXHJcbiAgLy8gQ3JcdTAwRTllciB1biBjb250ZW5ldXIgcG91ciBsZXMgclx1MDBFOGdsZXMgZnJhblx1MDBFN2Fpc2VzIGV0IGxldXIgZGVzY3JpcHRpb25cclxuICBjb25zdCBmcmVuY2hSdWxlc0NvbnRhaW5lciA9IGNvbnRhaW5lckVsLmNyZWF0ZUVsKFwiZGl2XCIpO1xyXG4gIGZyZW5jaFJ1bGVzQ29udGFpbmVyLnN0eWxlLm1hcmdpblRvcCA9IFwiM2VtXCI7XHJcblxyXG5cclxuICAvLyBPcHRpb24gcG91ciBsZXMgclx1MDBFOGdsZXMgdHlwb2dyYXBoaXF1ZXMgZnJhblx1MDBFN2Fpc2VzIGF2ZWMgdG9nZ2xlXHJcbiAgY29uc3QgZnJlbmNoUnVsZXNTZXR0aW5nID0gbmV3IFNldHRpbmcoZnJlbmNoUnVsZXNDb250YWluZXIpXHJcbiAgICAuc2V0TmFtZShcIlJcdTAwRThnbGVzIHR5cG9ncmFwaGlxdWVzIGZyYW5cdTAwRTdhaXNlc1wiKVxyXG4gICAgLnNldERlc2MoXHJcbiAgICAgIFwiXCJcclxuICAgIClcclxuICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cclxuICAgICAgdG9nZ2xlXHJcbiAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmZyZW5jaFJ1bGVzRW5hYmxlZClcclxuICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5mcmVuY2hSdWxlc0VuYWJsZWQgPSB2YWx1ZTtcclxuICAgICAgICAgIC8vIEFmZmljaGVyIG91IG1hc3F1ZXIgbGEgZGVzY3JpcHRpb24gZGVzIHJcdTAwRThnbGVzXHJcbiAgICAgICAgICBmcmVuY2hSdWxlc0Rlc2NDb250YWluZXIuc3R5bGUuZGlzcGxheSA9IHZhbHVlID8gXCJibG9ja1wiIDogXCJub25lXCI7XHJcbiAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICB9KVxyXG4gICAgKTtcclxuXHJcbiAgICBjb25zdCBuYW1lRWwgPSBmcmVuY2hSdWxlc1NldHRpbmcubmFtZUVsO1xyXG4gICAgaWYgKG5hbWVFbCkge1xyXG4gICAgICBuYW1lRWwuc3R5bGUuZm9udFdlaWdodCA9IFwiYm9sZFwiO1xyXG4gICAgICAvLyBuYW1lRWwuc3R5bGUubWFyZ2luVG9wID0gXCIzZW1cIjtcclxuICAgIH1cclxuXHJcbiAgLy8gQ29udGVuZXVyIHBvdXIgbGEgZGVzY3JpcHRpb24gZGVzIHJcdTAwRThnbGVzIGZyYW5cdTAwRTdhaXNlc1xyXG4gIGNvbnN0IGZyZW5jaFJ1bGVzRGVzY0NvbnRhaW5lciA9IGZyZW5jaFJ1bGVzQ29udGFpbmVyLmNyZWF0ZUVsKFwiZGl2XCIsIHtcclxuICAgIGNsczogXCJmcmVuY2gtcnVsZXMtZGVzY3JpcHRpb25cIlxyXG4gIH0pO1xyXG4gIFxyXG4gIC8vIERcdTAwRTlmaW5pciBsYSB2aXNpYmlsaXRcdTAwRTkgaW5pdGlhbGVcclxuICBmcmVuY2hSdWxlc0Rlc2NDb250YWluZXIuc3R5bGUuZGlzcGxheSA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmZyZW5jaFJ1bGVzRW5hYmxlZCA/IFwiYmxvY2tcIiA6IFwibm9uZVwiO1xyXG4gIGZyZW5jaFJ1bGVzRGVzY0NvbnRhaW5lci5zdHlsZS5wYWRkaW5nTGVmdCA9IFwiMjRweFwiO1xyXG4gIGZyZW5jaFJ1bGVzRGVzY0NvbnRhaW5lci5zdHlsZS5tYXJnaW5Ub3AgPSBcIjhweFwiO1xyXG5cclxuICAvLyBBam91dGVyIHVuZSBkZXNjcmlwdGlvbiBkZXMgclx1MDBFOGdsZXMgdHlwb2dyYXBoaXF1ZXMgZnJhblx1MDBFN2Fpc2VzXHJcbiAgY29uc3QgZnJlbmNoUnVsZXNEZXNjID0gZnJlbmNoUnVsZXNEZXNjQ29udGFpbmVyLmNyZWF0ZUVsKFwiZGl2XCIsIHtcclxuICAgIGNsczogXCJzZXR0aW5nLWl0ZW0tZGVzY3JpcHRpb25cIixcclxuICB9KTtcclxuXHJcbiAgZnJlbmNoUnVsZXNEZXNjLmNyZWF0ZUVsKFwicFwiLCB7XHJcbiAgICB0ZXh0OiBcIkNlcyByXHUwMEU4Z2xlcyBpbmNsdWVudCA6XCIsXHJcbiAgfSk7XHJcblxyXG4gIGNvbnN0IHJ1bGVzTGlzdCA9IGZyZW5jaFJ1bGVzRGVzYy5jcmVhdGVFbChcInVsXCIpO1xyXG4gIHJ1bGVzTGlzdC5zdHlsZS5tYXJnaW5MZWZ0ID0gXCIyMHB4XCI7XHJcbiAgLy8gcnVsZXNMaXN0LnN0eWxlLm1hcmdpblRvcCA9IFwiNXB4XCI7XHJcbiAgcnVsZXNMaXN0LnN0eWxlLm1hcmdpbkJvdHRvbSA9IFwiMTVweFwiO1xyXG5cclxuICBydWxlc0xpc3QuY3JlYXRlRWwoXCJsaVwiLCB7XHJcbiAgICB0ZXh0OiAnQ29udmVyc2lvbiBkZSAoXCIgXCIpIGVuIGd1aWxsZW1ldHMgZnJhblx1MDBFN2FpcyAoXHUwMEFCIFx1MDBCQiknLFxyXG4gIH0pO1xyXG4gIHJ1bGVzTGlzdC5jcmVhdGVFbChcImxpXCIsIHtcclxuICAgIHRleHQ6IFwiRXNwYWNlIGZpbmUgaW5zXHUwMEU5Y2FibGUgYXZhbnQgbGVzIHBvbmN0dWF0aW9ucyBkb3VibGVzICghID8gOyBcdTAwQkIpXCIsXHJcbiAgfSk7XHJcbiAgcnVsZXNMaXN0LmNyZWF0ZUVsKFwibGlcIiwge1xyXG4gICAgdGV4dDogXCJFc3BhY2UgaW5zXHUwMEU5Y2FibGUgYXZhbnQgbGVzIGRldXgtcG9pbnRzICg6KVwiLFxyXG4gIH0pO1xyXG4gIHJ1bGVzTGlzdC5jcmVhdGVFbChcImxpXCIsIHtcclxuICAgIHRleHQ6IFwiRXNwYWNlIGluc1x1MDBFOWNhYmxlIGFwclx1MDBFOHMgbGVzIG1vdHMgZCd1bmUgbGV0dHJlIChhLCB5LCBcdTAwRTAuLi4pXCIsXHJcbiAgfSk7XHJcbiAgcnVsZXNMaXN0LmNyZWF0ZUVsKFwibGlcIiwge1xyXG4gICAgdGV4dDogXCJFc3BhY2UgaW5zXHUwMEU5Y2FibGUgZGFucyBsZXMgbm9tcyBjb21wb3NcdTAwRTlzIChKZWFuIER1cG9udClcIixcclxuICB9KTtcclxuICBydWxlc0xpc3QuY3JlYXRlRWwoXCJsaVwiLCB7XHJcbiAgICB0ZXh0OiBcIkVzcGFjZSBpbnNcdTAwRTljYWJsZSBhdmFudCBsZXMgaW5pdGlhbGVzIChNLiBEdXBvbnQpXCIsXHJcbiAgfSk7XHJcbiAgcnVsZXNMaXN0LmNyZWF0ZUVsKFwibGlcIiwge1xyXG4gICAgdGV4dDogJ0VzcGFjZSBpbnNcdTAwRTljYWJsZSBhdmFudCBcInNpXHUwMEU4Y2xlXCIgKFhYZSBzaVx1MDBFOGNsZSknLFxyXG4gIH0pO1xyXG4gIHJ1bGVzTGlzdC5jcmVhdGVFbChcImxpXCIsIHtcclxuICAgIHRleHQ6ICdDb252ZXJzaW9uIGRlcyBsaWdhdHVyZXMgXCJvZS9PRVwiIGVuIFwiXHUwMTUzL1x1MDE1MlwiJyxcclxuICB9KTtcclxuICBydWxlc0xpc3QuY3JlYXRlRWwoXCJsaVwiLCB7XHJcbiAgICB0ZXh0OiBcIkV4cG9zYW50cyBwb3VyIGxlcyBvcmRpbmF1eCAoMWVyLCBYSUllKVwiLFxyXG4gIH0pO1xyXG4gIHJ1bGVzTGlzdC5jcmVhdGVFbChcImxpXCIsIHtcclxuICAgIHRleHQ6IFwiQ29udmVyc2lvbiBkZSAoLi4uKSBlbiBwb2ludHMgZGUgc3VzcGVuc2lvbiAoXHUyMDI2KVwiLFxyXG4gIH0pO1xyXG5cclxuICAvLyBBam91dGVyIHVuZSBub3RlIGV4cGxpY2F0aXZlIHN1ciBsZXMgZXNwYWNlcyBmaW5lcyBpbnNcdTAwRTljYWJsZXNcclxuICBjb25zdCBub3RlRWwgPSBmcmVuY2hSdWxlc0Rlc2NDb250YWluZXIuY3JlYXRlRWwoXCJkaXZcIiwge1xyXG4gICAgY2xzOiBcInNldHRpbmctaXRlbS1kZXNjcmlwdGlvblwiLFxyXG4gIH0pO1xyXG5cclxuICBub3RlRWwuY3JlYXRlRWwoXCJwXCIsIHtcclxuICAgIHRleHQ6IFwiU291cmNlcyA6XCIsXHJcbiAgfSk7XHJcblxyXG4gIGNvbnN0IGluZm9MaXN0ID0gbm90ZUVsLmNyZWF0ZUVsKFwidWxcIik7XHJcbiAgY29uc3QgaW5mb0l0ZW0gPSBpbmZvTGlzdC5jcmVhdGVFbChcImxpXCIpO1xyXG4gIGluZm9JdGVtLmNyZWF0ZUVsKFwiYVwiLCB7XHJcbiAgICBocmVmOiBcImh0dHBzOi8vZ2l0bGFiLmNvbS9KdWxpZUJsYW5jL3R5cGVzZXR0aW5nLXRvb2xzLy0vYmxvYi9tYXN0ZXIvcmVnZXgtdHlwby5qcz9yZWZfdHlwZT1oZWFkc1wiLFxyXG4gICAgdGV4dDogXCJ0eXBlc2V0dGluZy10b29scyAoSnVsaWUgQmxhbmMpXCIsXHJcbiAgfSk7XHJcblxyXG4gIGNvbnN0IGluZm9JdGVtMiA9IGluZm9MaXN0LmNyZWF0ZUVsKFwibGlcIik7XHJcbiAgaW5mb0l0ZW0yLmNyZWF0ZUVsKFwiYVwiLCB7XHJcbiAgICBocmVmOiBcImh0dHBzOi8vdHlwb21hbmllLmZyL3RhZy9taWNyby10eXBvZ3JhcGhpZS9cIixcclxuICAgIHRleHQ6IFwiTGUgUGV0aXQgbWFudWVsIGRlIGNvbXBvc2l0aW9uIHR5cG9ncmFwaGlxdWUuIChNdXJpZWwgUGFyaXMpXCIsXHJcbiAgfSk7XHJcbn1cclxuXHJcbiAgLyoqXHJcbiAgICogQ3JcdTAwRTllIGxlcyBwYXJhbVx1MDBFOHRyZXMgZGUgbWlzZSBlbiBcdTAwRTl2aWRlbmNlXHJcbiAgICogQHBhcmFtIGNvbnRhaW5lckVsIENvbnRlbmV1ciBwYXJlbnRcclxuICAgKi9cclxuICBwcml2YXRlIGNyZWF0ZUhpZ2hsaWdodFNldHRpbmdzKGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudCk6IHZvaWQge1xyXG4gICAgY29uc3QgZGVzRWwgPSBjb250YWluZXJFbC5jcmVhdGVFbChcInBcIiwge1xyXG4gICAgICB0ZXh0OiBcIkFmZmljaGFnZSBkZXMgY2FyYWN0XHUwMEU4cmVzIGludmlzaWJsZXNcIixcclxuICAgIH0pO1xyXG4gICAgZGVzRWwuc3R5bGUuZm9udFdlaWdodCA9IFwiYm9sZFwiO1xyXG4gICAgZGVzRWwuc3R5bGUubWFyZ2luVG9wID0gXCIzZW1cIjtcclxuXHJcbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgLnNldE5hbWUoXCJBY3RpdmVyIGwnYWZmaWNoYWdlIGRlcyBjYXJhY3RcdTAwRThyZXMgaW52aXNpYmxlc1wiKVxyXG4gICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XHJcbiAgICAgICAgdG9nZ2xlXHJcbiAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuaGlnaGxpZ2h0RW5hYmxlZClcclxuICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuaGlnaGxpZ2h0RW5hYmxlZCA9IHZhbHVlO1xyXG4gICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgIH0pXHJcbiAgICAgICk7XHJcblxyXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgIC5zZXROYW1lKFwiQm91dG9uIGRhbnMgbGEgYmFycmUgZCdcdTAwRTl0YXRcIilcclxuICAgICAgLnNldERlc2MoXHJcbiAgICAgICAgXCJBZmZpY2hlciB1biBib3V0b24gZCdhY3RpdmF0aW9uL2RcdTAwRTlzYWN0aXZhdGlvblwiXHJcbiAgICAgIClcclxuICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG4gICAgICAgIHRvZ2dsZVxyXG4gICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmhpZ2hsaWdodEJ1dHRvbilcclxuICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuaGlnaGxpZ2h0QnV0dG9uID0gdmFsdWU7XHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgKTtcclxuXHJcbiAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAuc2V0TmFtZShcIkJvdXRvbiBkYW5zIGxhIGJhcnJlIGRlIHRpdHJlXCIpXHJcbiAgICAgIC5zZXREZXNjKFxyXG4gICAgICAgICAgXCJBZmZpY2hlciB1biBib3V0b24gZCdhY3RpdmF0aW9uL2RcdTAwRTlzYWN0aXZhdGlvbiBkYW5zIGxhIGJhcnJlIGRlIHRpdHJlIGRlcyBvbmdsZXRzXCJcclxuICAgICAgKVxyXG4gICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XHJcbiAgICAgICAgICB0b2dnbGVcclxuICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MudGFiVGl0bGVCYXJCdXR0b24pXHJcbiAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy50YWJUaXRsZUJhckJ1dHRvbiA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICB9KVxyXG4gICAgICApO1xyXG5cclxuXHJcbiAgfVxyXG59XHJcbiIsICJpbXBvcnQgeyBFZGl0b3JWaWV3LCBEZWNvcmF0aW9uLCBWaWV3UGx1Z2luLCBWaWV3VXBkYXRlIH0gZnJvbSBcIkBjb2RlbWlycm9yL3ZpZXdcIjtcclxuaW1wb3J0IHsgUmFuZ2VTZXRCdWlsZGVyIH0gZnJvbSBcIkBjb2RlbWlycm9yL3N0YXRlXCI7XHJcbmltcG9ydCB7IE1pY3JvdHlwb2dyYXBoaWVTZXR0aW5ncyB9IGZyb20gJy4uL3NldHRpbmdzL3NldHRpbmdzJztcclxuXHJcblxyXG4vKipcclxuICogQ3JcdTAwRTllIGxlcyBkXHUwMEU5Y29yYXRpb25zIHZpc3VlbGxlcyBwb3VyIGxlcyBjYXJhY3RcdTAwRThyZXMgc3BcdTAwRTljaWF1eFxyXG4gKiBAcGFyYW0gc2V0dGluZ3MgUGFyYW1cdTAwRTh0cmVzIGR1IHBsdWdpblxyXG4gKiBAcmV0dXJucyBFeHRlbnNpb24gcG91ciBsJ1x1MDBFOWRpdGV1ciBDb2RlTWlycm9yXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlRGVjb3JhdGlvbnMoc2V0dGluZ3M6IE1pY3JvdHlwb2dyYXBoaWVTZXR0aW5ncykge1xyXG4gICAgLy8gRFx1MDBFOWNvcmF0aW9uIHBvdXIgbCdlc3BhY2UgaW5zXHUwMEU5Y2FibGUgbm9ybWFsZVxyXG4gICAgY29uc3Qgbm9uQnJlYWtpbmdTcGFjZURlY29yYXRpb24gPSBEZWNvcmF0aW9uLm1hcmsoe1xyXG4gICAgICAgIGNsYXNzOiAnbm9uQnJlYWtpbmdTcGFjZSdcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIERcdTAwRTljb3JhdGlvbiBwb3VyIGwnZXNwYWNlIGZpbmUgaW5zXHUwMEU5Y2FibGVcclxuICAgIGNvbnN0IHRoaW5TcGFjZURlY29yYXRpb24gPSBEZWNvcmF0aW9uLm1hcmsoe1xyXG4gICAgICAgIGNsYXNzOiAndGhpblNwYWNlJ1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gRFx1MDBFOWNvcmF0aW9uIHBvdXIgbGUgdGlyZXQgY2FkcmF0aW5cclxuICAgIGNvbnN0IGVtRGFzaERlY29yYXRpb24gPSBEZWNvcmF0aW9uLm1hcmsoe1xyXG4gICAgICAgIGNsYXNzOiAnZW0tZGFzaCdcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIERcdTAwRTljb3JhdGlvbiBwb3VyIGwnZXNwYWNlIG5vcm1hbGVcclxuICAgIGNvbnN0IHJlZ3VsYXJTcGFjZURlY29yYXRpb24gPSBEZWNvcmF0aW9uLm1hcmsoe1xyXG4gICAgICAgIGNsYXNzOiAncmVndWxhclNwYWNlJ1xyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIFZpZXdQbHVnaW4uZnJvbUNsYXNzKGNsYXNzIHtcclxuICAgICAgICBkZWNvcmF0aW9uczogYW55O1xyXG5cclxuICAgICAgICBjb25zdHJ1Y3Rvcih2aWV3OiBFZGl0b3JWaWV3KSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGVjb3JhdGlvbnMgPSB0aGlzLmJ1aWxkRGVjb3JhdGlvbnModmlldyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB1cGRhdGUodXBkYXRlOiBWaWV3VXBkYXRlKSB7XHJcbiAgICAgICAgICAgIGlmICh1cGRhdGUuZG9jQ2hhbmdlZCB8fCB1cGRhdGUudmlld3BvcnRDaGFuZ2VkKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRlY29yYXRpb25zID0gdGhpcy5idWlsZERlY29yYXRpb25zKHVwZGF0ZS52aWV3KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgYnVpbGREZWNvcmF0aW9ucyh2aWV3OiBFZGl0b3JWaWV3KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGJ1aWxkZXIgPSBuZXcgUmFuZ2VTZXRCdWlsZGVyPERlY29yYXRpb24+KCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBBcHBsaXF1ZXIgbGVzIGRcdTAwRTljb3JhdGlvbnMgdW5pcXVlbWVudCBzaSBsYSBtaXNlIGVuIFx1MDBFOXZpZGVuY2UgZXN0IGFjdGl2XHUwMEU5ZVxyXG4gICAgICAgICAgICBpZiAoc2V0dGluZ3MuaGlnaGxpZ2h0RW5hYmxlZCkge1xyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgeyBmcm9tLCB0byB9IG9mIHZpZXcudmlzaWJsZVJhbmdlcykge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCB0ZXh0ID0gdmlldy5zdGF0ZS5kb2Muc2xpY2VTdHJpbmcoZnJvbSwgdG8pO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBkb2N1bWVudFRleHQgPSB2aWV3LnN0YXRlLmRvYy50b1N0cmluZygpO1xyXG4gICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIFBvc2l0aW9uIGRlIGRcdTAwRTlwYXJ0IHBvdXIgbGUgdHJhaXRlbWVudCBkdSB0ZXh0ZVxyXG4gICAgICAgICAgICAgICAgICAgIGxldCBzdGFydFBvcyA9IGZyb207XHJcbiAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gQW5hbHlzZXIgbGUgdGV4dGUgcG91ciBkXHUwMEU5dGVjdGVyIGxlcyBmcm9udG1hdHRlciBldCBibG9jcyBkZSBjb2RlXHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGluRnJvbnRtYXR0ZXIgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgaW5Db2RlQmxvY2sgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgbGluZVN0YXJ0ID0gdHJ1ZTsgLy8gUG91ciBkXHUwMEU5dGVjdGVyIGxlIGRcdTAwRTlidXQgZCd1bmUgbGlnbmVcclxuICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRleHQubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hhciA9IHRleHRbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHBvcyA9IHN0YXJ0UG9zICsgaTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE9idGVuaXIgbGEgcG9zaXRpb24gZGUgbGlnbmUgYWN0dWVsbGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY3VycmVudFBvcyA9IHZpZXcuc3RhdGUuZG9jLmxpbmVBdChwb3MpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBsaW5lTnVtYmVyID0gY3VycmVudFBvcy5udW1iZXIgLSAxOyAvLyBMZXMgbGlnbmVzIGNvbW1lbmNlbnQgXHUwMEUwIDEgZGFucyBDb2RlTWlycm9yXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBEXHUwMEU5dGVjdGlvbiBkdSBkXHUwMEU5YnV0IGV0IGZpbiBkdSBmcm9udG1hdHRlciAoLS0tKSBcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxpbmVTdGFydCAmJiB0ZXh0LnN1YnN0cihpLCAzKSA9PT0gJy0tLScpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluRnJvbnRtYXR0ZXIgPSAhaW5Gcm9udG1hdHRlcjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgKz0gMjsgLy8gU2F1dGVyIGxlcyAzIHRpcmV0cyAob24gaW5jclx1MDBFOW1lbnRlcmEgZW5jb3JlIGkgZGFucyBsYSBib3VjbGUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5lU3RhcnQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBEXHUwMEU5dGVjdGlvbiBkdSBkXHUwMEU5YnV0IGV0IGZpbiBkZXMgYmxvY3MgZGUgY29kZSAoYGBgKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobGluZVN0YXJ0ICYmIHRleHQuc3Vic3RyKGksIDMpID09PSAnYGBgJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5Db2RlQmxvY2sgPSAhaW5Db2RlQmxvY2s7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpICs9IDI7IC8vIFNhdXRlciBsZXMgMyBiYWNrdGlja3NcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVTdGFydCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIERcdTAwRTl0ZWN0aW9uIGR1IGRcdTAwRTlidXQgZCd1bmUgbm91dmVsbGUgbGlnbmVcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNoYXIgPT09ICdcXG4nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5lU3RhcnQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGxpbmVTdGFydCAmJiBjaGFyICE9PSAnICcgJiYgY2hhciAhPT0gJ1xcdCcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVTdGFydCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBWXHUwMEU5cmlmaWVyIHNpIGxhIGxpZ25lIGFjdHVlbGxlIGVzdCBkYW5zIHVuIGJsb2Mgc3BcdTAwRTljaWFsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzSW5TcGVjaWFsQmxvY2sgPSBpbkZyb250bWF0dGVyIHx8IGluQ29kZUJsb2NrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQXBwbGlxdWVyIGxlcyBkXHUwMEU5Y29yYXRpb25zIHNldWxlbWVudCBzaSBvbiBuJ2VzdCBwYXMgZGFucyB1biBibG9jIHNwXHUwMEU5Y2lhbFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWlzSW5TcGVjaWFsQmxvY2spIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjaGFyID09PSAnXFx1MDBBMCcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBidWlsZGVyLmFkZChwb3MsIHBvcyArIDEsIG5vbkJyZWFraW5nU3BhY2VEZWNvcmF0aW9uKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjaGFyID09PSAnXFx1MjAyRicpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBidWlsZGVyLmFkZChwb3MsIHBvcyArIDEsIHRoaW5TcGFjZURlY29yYXRpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNoYXIgPT09ICdcdTIwMTQnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnVpbGRlci5hZGQocG9zLCBwb3MgKyAxLCBlbURhc2hEZWNvcmF0aW9uKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjaGFyID09PSAnICcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBidWlsZGVyLmFkZChwb3MsIHBvcyArIDEsIHJlZ3VsYXJTcGFjZURlY29yYXRpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gYnVpbGRlci5maW5pc2goKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIFxyXG4gICAgfSwge1xyXG4gICAgICAgIGRlY29yYXRpb25zOiB2ID0+IHYuZGVjb3JhdGlvbnNcclxuICAgIH0pO1xyXG59IiwgImltcG9ydCB7IFBsdWdpbiwgc2V0SWNvbiB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5cclxuXHJcbi8qKlxyXG4gKiBDclx1MDBFOWUgdW4gYm91dG9uIGRhbnMgbGEgYmFycmUgZCdcdTAwRTl0YXRcclxuICogQHBhcmFtIHBsdWdpbiBJbnN0YW5jZSBkdSBwbHVnaW5cclxuICogQHBhcmFtIGlzRW5hYmxlZCBcdTAwQzl0YXQgaW5pdGlhbCAoYWN0aXZcdTAwRTkvZFx1MDBFOXNhY3Rpdlx1MDBFOSlcclxuICogQHBhcmFtIHRvZ2dsZUNhbGxiYWNrIEZvbmN0aW9uIGRlIHJhcHBlbCBwb3VyIGxlIGJhc2N1bGVtZW50XHJcbiAqIEByZXR1cm5zIFx1MDBDOWxcdTAwRTltZW50IEhUTUwgZHUgYm91dG9uXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlU3RhdHVzQmFyQnV0dG9uKFxyXG4gICAgcGx1Z2luOiBQbHVnaW4sXHJcbiAgICBpc0VuYWJsZWQ6IGJvb2xlYW4sXHJcbiAgICB0b2dnbGVDYWxsYmFjazogKCkgPT4gdm9pZFxyXG4pOiBIVE1MRWxlbWVudCB7XHJcbiAgICBjb25zdCBzdGF0dXNCYXJJdGVtRWwgPSBwbHVnaW4uYWRkU3RhdHVzQmFySXRlbSgpO1xyXG4gICAgc3RhdHVzQmFySXRlbUVsLmlkID0gXCJoaWdobGlnaHQtc3RhdHVzLWJhci1idXR0b25cIjtcclxuICAgIFxyXG4gICAgc3RhdHVzQmFySXRlbUVsLmFkZENsYXNzKFwibW9kLWNsaWNrYWJsZVwiKTtcclxuICAgIFxyXG4gICAgLy8gQ3JcdTAwRTllciBsJ2ljXHUwMEY0bmUgZXQgbCdham91dGVyIGF1IGJvdXRvblxyXG4gICAgc2V0SWNvbihzdGF0dXNCYXJJdGVtRWwsIFwicGlsY3Jvd1wiKTtcclxuXHJcbiAgICBzdGF0dXNCYXJJdGVtRWwuc2V0QXR0cmlidXRlKFwiYXJpYS1sYWJlbFwiLCBcIkFmZmljaGVyL01hc3F1ZXIgbGVzIGNhcmFjdFx1MDBFOHJlcyBpbnZpc2libGVzXCIpO1xyXG4gICAgc3RhdHVzQmFySXRlbUVsLnNldEF0dHJpYnV0ZShcImRhdGEtdG9vbHRpcC1wb3NpdGlvblwiLCBcInRvcFwiKTtcclxuXHJcbiAgICAvLyBEXHUwMEU5ZmluaXIgbCdhcHBhcmVuY2UgaW5pdGlhbGVcclxuICAgIHVwZGF0ZVN0YXR1c0JhckJ1dHRvbihzdGF0dXNCYXJJdGVtRWwsIGlzRW5hYmxlZCk7XHJcblxyXG4gICAgLy8gQWpvdXRlciBsJ1x1MDBFOXZcdTAwRTluZW1lbnQgZGUgY2xpY1xyXG4gICAgc3RhdHVzQmFySXRlbUVsLm9uQ2xpY2tFdmVudCgoKSA9PiB7XHJcbiAgICAgICAgdG9nZ2xlQ2FsbGJhY2soKTtcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICByZXR1cm4gc3RhdHVzQmFySXRlbUVsO1xyXG59XHJcblxyXG4vKipcclxuICogQ3JcdTAwRTllIHVuIGJvdXRvbiBkYW5zIGxhIGJhcnJlIGRlIHRpdHJlIGRlcyBvbmdsZXRzXHJcbiAqIEBwYXJhbSBwbHVnaW4gSW5zdGFuY2UgZHUgcGx1Z2luXHJcbiAqIEBwYXJhbSBpc0VuYWJsZWQgXHUwMEM5dGF0IGluaXRpYWwgKGFjdGl2XHUwMEU5L2RcdTAwRTlzYWN0aXZcdTAwRTkpXHJcbiAqIEBwYXJhbSB0b2dnbGVDYWxsYmFjayBGb25jdGlvbiBkZSByYXBwZWwgcG91ciBsZSBiYXNjdWxlbWVudFxyXG4gKiBAcmV0dXJucyBcdTAwQzlsXHUwMEU5bWVudCBIVE1MIGR1IGJvdXRvblxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVRhYlRpdGxlQmFyQnV0dG9uKFxyXG4gICAgcGx1Z2luOiBQbHVnaW4sXHJcbiAgICBpc0VuYWJsZWQ6IGJvb2xlYW4sXHJcbiAgICB0b2dnbGVDYWxsYmFjazogKCkgPT4gdm9pZFxyXG4pOiBIVE1MRWxlbWVudCB7XHJcbiAgICAvLyBDclx1MDBFOWVyIGxlIGJvdXRvblxyXG4gICAgY29uc3QgYnV0dG9uRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcclxuICAgIGJ1dHRvbkVsLmlkID0gXCJoaWdobGlnaHQtdGFiLXRpdGxlLWJ1dHRvblwiO1xyXG4gICAgYnV0dG9uRWwuY2xhc3NOYW1lID0gXCJjbGlja2FibGUtaWNvbiB2aWV3LWFjdGlvblwiO1xyXG4gICAgYnV0dG9uRWwuc2V0QXR0cmlidXRlKFwiYXJpYS1sYWJlbFwiLCBcIkFmZmljaGVyL01hc3F1ZXIgbGVzIGNhcmFjdFx1MDBFOHJlcyBpbnZpc2libGVzXCIpO1xyXG4gICAgXHJcbiAgICAvLyBDclx1MDBFOWVyIGwnaWNcdTAwRjRuZSBldCBsJ2Fqb3V0ZXIgYXUgYm91dG9uXHJcbiAgICBzZXRJY29uKGJ1dHRvbkVsLCBcInBpbGNyb3dcIik7XHJcbiAgICBcclxuICAgIC8vIERcdTAwRTlmaW5pciBsJ2FwcGFyZW5jZSBpbml0aWFsZVxyXG4gICAgdXBkYXRlVGFiVGl0bGVCYXJCdXR0b24oYnV0dG9uRWwsIGlzRW5hYmxlZCk7XHJcbiAgICBcclxuICAgIC8vIEFqb3V0ZXIgbCdcdTAwRTl2XHUwMEU5bmVtZW50IGRlIGNsaWNcclxuICAgIGJ1dHRvbkVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2ZW50KSA9PiB7XHJcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICB0b2dnbGVDYWxsYmFjaygpO1xyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8vIEFqb3V0ZXIgbGUgYm91dG9uIFx1MDBFMCBsYSBiYXJyZSBkZSB0aXRyZVxyXG4gICAgY29uc3QgdGl0bGVCYXJFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy52aWV3LWhlYWRlci10aXRsZS1jb250YWluZXInKTtcclxuICAgIGlmICh0aXRsZUJhckVsKSB7XHJcbiAgICAgICAgY29uc3QgYWN0aW9uc0VsID0gdGl0bGVCYXJFbC5uZXh0RWxlbWVudFNpYmxpbmcgYXMgSFRNTEVsZW1lbnQ7XHJcbiAgICAgICAgaWYgKGFjdGlvbnNFbCAmJiBhY3Rpb25zRWwuY2xhc3NMaXN0LmNvbnRhaW5zKCd2aWV3LWFjdGlvbnMnKSkge1xyXG4gICAgICAgICAgICBhY3Rpb25zRWwucHJlcGVuZChidXR0b25FbCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gYnV0dG9uRWw7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBNZXQgXHUwMEUwIGpvdXIgbCdhcHBhcmVuY2UgZHUgYm91dG9uIGRlIGxhIGJhcnJlIGQnXHUwMEU5dGF0XHJcbiAqIEBwYXJhbSBidXR0b25FbCBcdTAwQzlsXHUwMEU5bWVudCBIVE1MIGR1IGJvdXRvblxyXG4gKiBAcGFyYW0gaXNFbmFibGVkIFx1MDBDOXRhdCAoYWN0aXZcdTAwRTkvZFx1MDBFOXNhY3Rpdlx1MDBFOSlcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVTdGF0dXNCYXJCdXR0b24oYnV0dG9uRWw6IEhUTUxFbGVtZW50IHwgbnVsbCwgaXNFbmFibGVkOiBib29sZWFuKTogdm9pZCB7XHJcbiAgICBpZiAoIWJ1dHRvbkVsKSByZXR1cm47XHJcbiAgICBcclxuICAgIGlmIChpc0VuYWJsZWQpIHtcclxuICAgICAgICBidXR0b25FbC5hZGRDbGFzcygnaGlnaGxpZ2h0LWVuYWJsZWQnKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgYnV0dG9uRWwucmVtb3ZlQ2xhc3MoJ2hpZ2hsaWdodC1lbmFibGVkJyk7XHJcbiAgICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBNZXQgXHUwMEUwIGpvdXIgbCdhcHBhcmVuY2UgZHUgYm91dG9uIGRlIGxhIGJhcnJlIGRlIHRpdHJlXHJcbiAqIEBwYXJhbSBidXR0b25FbCBcdTAwQzlsXHUwMEU5bWVudCBIVE1MIGR1IGJvdXRvblxyXG4gKiBAcGFyYW0gaXNFbmFibGVkIFx1MDBDOXRhdCAoYWN0aXZcdTAwRTkvZFx1MDBFOXNhY3Rpdlx1MDBFOSlcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVUYWJUaXRsZUJhckJ1dHRvbihidXR0b25FbDogSFRNTEVsZW1lbnQgfCBudWxsLCBpc0VuYWJsZWQ6IGJvb2xlYW4pOiB2b2lkIHtcclxuICAgIGlmICghYnV0dG9uRWwpIHJldHVybjtcclxuICAgIFxyXG4gICAgaWYgKGlzRW5hYmxlZCkge1xyXG4gICAgICAgIGJ1dHRvbkVsLmFkZENsYXNzKCdpcy1hY3RpdmUnKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgYnV0dG9uRWwucmVtb3ZlQ2xhc3MoJ2lzLWFjdGl2ZScpO1xyXG4gICAgfVxyXG59XHJcblxyXG4vKipcclxuICogU3VwcHJpbWUgbGUgYm91dG9uIGRlIGxhIGJhcnJlIGQnXHUwMEU5dGF0XHJcbiAqIEBwYXJhbSBidXR0b25FbCBcdTAwQzlsXHUwMEU5bWVudCBIVE1MIGR1IGJvdXRvblxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZVN0YXR1c0JhckJ1dHRvbihidXR0b25FbDogSFRNTEVsZW1lbnQgfCBudWxsKTogdm9pZCB7XHJcbiAgICBpZiAoYnV0dG9uRWwpIHtcclxuICAgICAgICBidXR0b25FbC5yZW1vdmUoKTtcclxuICAgIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFN1cHByaW1lIGxlIGJvdXRvbiBkZSBsYSBiYXJyZSBkZSB0aXRyZVxyXG4gKiBAcGFyYW0gYnV0dG9uRWwgXHUwMEM5bFx1MDBFOW1lbnQgSFRNTCBkdSBib3V0b25cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiByZW1vdmVUYWJUaXRsZUJhckJ1dHRvbihidXR0b25FbDogSFRNTEVsZW1lbnQgfCBudWxsKTogdm9pZCB7XHJcbiAgICBpZiAoYnV0dG9uRWwpIHtcclxuICAgICAgICBidXR0b25FbC5yZW1vdmUoKTtcclxuICAgIH1cclxufSIsICIvKipcclxuICogSW50ZXJmYWNlIHBvdXIgbGVzIHBvc2l0aW9ucyBkYW5zIGwnXHUwMEU5ZGl0ZXVyXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIEVkaXRvclBvc2l0aW9uIHtcclxuICAgIGxpbmU6IG51bWJlcjtcclxuICAgIGNoOiBudW1iZXI7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBJbnRlcmZhY2UgcG91ciBsZSByXHUwMEU5c3VsdGF0IGRlIGwnYW5hbHlzZSBkZXMgYmxvY3NcclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgQmxvY2tBbmFseXNpc1Jlc3VsdCB7XHJcbiAgICBsaW5lVHlwZXM6IHN0cmluZ1tdO1xyXG59XHJcblxyXG4vKipcclxuICogQW5hbHlzZSBsYSBzdHJ1Y3R1cmUgZHUgZG9jdW1lbnQgcG91ciBpZGVudGlmaWVyIGxlcyBibG9jcyBzcFx1MDBFOWNpYXV4XHJcbiAqIEBwYXJhbSBkb2N1bWVudFRleHQgVGV4dGUgY29tcGxldCBkdSBkb2N1bWVudFxyXG4gKiBAcGFyYW0gc3RhcnRMaW5lIExpZ25lIGRlIGRcdTAwRTlidXQgZGUgbGEgc1x1MDBFOWxlY3Rpb25cclxuICogQHBhcmFtIGVuZExpbmUgTGlnbmUgZGUgZmluIGRlIGxhIHNcdTAwRTlsZWN0aW9uXHJcbiAqIEByZXR1cm5zIFJcdTAwRTlzdWx0YXQgZGUgbCdhbmFseXNlIGF2ZWMgdHlwZXMgZGUgbGlnbmVzXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gYW5hbHl6ZURvY3VtZW50U3RydWN0dXJlKGRvY3VtZW50VGV4dDogc3RyaW5nLCBzdGFydExpbmU6IG51bWJlciwgZW5kTGluZTogbnVtYmVyKTogQmxvY2tBbmFseXNpc1Jlc3VsdCB7XHJcbiAgICBjb25zdCBsaW5lcyA9IGRvY3VtZW50VGV4dC5zcGxpdCgnXFxuJyk7XHJcbiAgICBjb25zdCBsaW5lVHlwZXMgPSBuZXcgQXJyYXkoZW5kTGluZSAtIHN0YXJ0TGluZSArIDEpLmZpbGwoJ25vcm1hbCcpO1xyXG4gICAgXHJcbiAgICBsZXQgaW5Gcm9udG1hdHRlciA9IGZhbHNlO1xyXG4gICAgbGV0IGluQ29kZUJsb2NrID0gZmFsc2U7XHJcbiAgICBcclxuICAgIC8vIFVuZSBzZXVsZSBwYXNzZSBwb3VyIGFuYWx5c2VyIHRvdXQgbGUgZG9jdW1lbnRcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGluZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBjb25zdCBsaW5lID0gbGluZXNbaV07XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKGxpbmUudHJpbSgpID09PSAnLS0tJykge1xyXG4gICAgICAgICAgICBpbkZyb250bWF0dGVyID0gIWluRnJvbnRtYXR0ZXI7XHJcbiAgICAgICAgfSBlbHNlIGlmIChsaW5lLnRyaW0oKS5zdGFydHNXaXRoKCdgYGAnKSkge1xyXG4gICAgICAgICAgICBpbkNvZGVCbG9jayA9ICFpbkNvZGVCbG9jaztcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gU2kgbm91cyBzb21tZXMgZGFucyBsJ2ludGVydmFsbGUgZGUgc1x1MDBFOWxlY3Rpb24sIGVucmVnaXN0cmVyIGxlIHR5cGVcclxuICAgICAgICBpZiAoaSA+PSBzdGFydExpbmUgJiYgaSA8PSBlbmRMaW5lKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlbGF0aXZlSW5kZXggPSBpIC0gc3RhcnRMaW5lO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgaWYgKGxpbmUudHJpbSgpID09PSAnLS0tJyB8fCBsaW5lLnRyaW0oKS5zdGFydHNXaXRoKCdgYGAnKSkge1xyXG4gICAgICAgICAgICAgICAgbGluZVR5cGVzW3JlbGF0aXZlSW5kZXhdID0gJ2RlbGltaXRlcic7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaW5Gcm9udG1hdHRlcikge1xyXG4gICAgICAgICAgICAgICAgbGluZVR5cGVzW3JlbGF0aXZlSW5kZXhdID0gJ2Zyb250bWF0dGVyJztcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChpbkNvZGVCbG9jaykge1xyXG4gICAgICAgICAgICAgICAgbGluZVR5cGVzW3JlbGF0aXZlSW5kZXhdID0gJ2NvZGUnO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFNpIG5vdXMgYXZvbnMgZFx1MDBFOXBhc3NcdTAwRTkgbCdpbnRlcnZhbGxlLCBub3VzIHBvdXZvbnMgc29ydGlyXHJcbiAgICAgICAgaWYgKGkgPiBlbmRMaW5lKSBicmVhaztcclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIHsgbGluZVR5cGVzIH07XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBWXHUwMEU5cmlmaWUgc2kgdW5lIGxpZ25lIHNwXHUwMEU5Y2lmaXF1ZSBzZSB0cm91dmUgZGFucyB1biBibG9jIHNwXHUwMEU5Y2lhbFxyXG4gKiBAcGFyYW0gZG9jdW1lbnRUZXh0IFRleHRlIGNvbXBsZXQgZHUgZG9jdW1lbnRcclxuICogQHBhcmFtIGxpbmVOdW1iZXIgTnVtXHUwMEU5cm8gZGUgbGlnbmUgXHUwMEUwIHZcdTAwRTlyaWZpZXJcclxuICogQHJldHVybnMgdHJ1ZSBzaSBsYSBsaWduZSBlc3QgZGFucyB1biBibG9jIHNwXHUwMEU5Y2lhbFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGlzTGluZUluU3BlY2lhbEJsb2NrKGRvY3VtZW50VGV4dDogc3RyaW5nLCBsaW5lTnVtYmVyOiBudW1iZXIpOiBib29sZWFuIHtcclxuICAgIGNvbnN0IGxpbmVzID0gZG9jdW1lbnRUZXh0LnNwbGl0KCdcXG4nKTtcclxuICAgIFxyXG4gICAgbGV0IGluRnJvbnRtYXR0ZXIgPSBmYWxzZTtcclxuICAgIGxldCBpbkNvZGVCbG9jayA9IGZhbHNlO1xyXG4gICAgXHJcbiAgICAvLyBBbmFseXNlciBsZSBkb2N1bWVudCBqdXNxdSdcdTAwRTAgbGEgbGlnbmUgc3BcdTAwRTljaWZpXHUwMEU5ZVxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPD0gbGluZU51bWJlcjsgaSsrKSB7XHJcbiAgICAgICAgY29uc3QgbGluZSA9IGxpbmVzW2ldO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmIChsaW5lLnRyaW0oKSA9PT0gJy0tLScpIHtcclxuICAgICAgICAgICAgaW5Gcm9udG1hdHRlciA9ICFpbkZyb250bWF0dGVyO1xyXG4gICAgICAgIH0gZWxzZSBpZiAobGluZS50cmltKCkuc3RhcnRzV2l0aCgnYGBgJykpIHtcclxuICAgICAgICAgICAgaW5Db2RlQmxvY2sgPSAhaW5Db2RlQmxvY2s7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFNpIG5vdXMgc29tbWVzIFx1MDBFMCBsYSBsaWduZSBjaWJsZSwgcmV0b3VybmVyIGxlIHJcdTAwRTlzdWx0YXRcclxuICAgICAgICBpZiAoaSA9PT0gbGluZU51bWJlcikge1xyXG4gICAgICAgICAgICByZXR1cm4gaW5Gcm9udG1hdHRlciB8fCBpbkNvZGVCbG9jaztcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJldHVybiBmYWxzZTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEFuYWx5c2UgcmFwaWRlIHBvdXIgZFx1MDBFOXRlY3RlciBsZSB0eXBlIGRlIGJsb2MgZCd1bmUgbGlnbmVcclxuICogQHBhcmFtIGRvY3VtZW50VGV4dCBUZXh0ZSBkdSBkb2N1bWVudFxyXG4gKiBAcGFyYW0gbGluZU51bWJlciBOdW1cdTAwRTlybyBkZSBsaWduZVxyXG4gKiBAcmV0dXJucyBUeXBlIGRlIGJsb2M6ICdub3JtYWwnLCAnZnJvbnRtYXR0ZXInLCAnY29kZScsICdkZWxpbWl0ZXInXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0TGluZUJsb2NrVHlwZShkb2N1bWVudFRleHQ6IHN0cmluZywgbGluZU51bWJlcjogbnVtYmVyKTogc3RyaW5nIHtcclxuICAgIGNvbnN0IGxpbmVzID0gZG9jdW1lbnRUZXh0LnNwbGl0KCdcXG4nKTtcclxuICAgIGNvbnN0IGxpbmUgPSBsaW5lc1tsaW5lTnVtYmVyXTtcclxuICAgIFxyXG4gICAgLy8gVlx1MDBFOXJpZmllciBzaSBjJ2VzdCB1biBkXHUwMEU5bGltaXRldXJcclxuICAgIGlmIChsaW5lLnRyaW0oKSA9PT0gJy0tLScgfHwgbGluZS50cmltKCkuc3RhcnRzV2l0aCgnYGBgJykpIHtcclxuICAgICAgICByZXR1cm4gJ2RlbGltaXRlcic7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIFZcdTAwRTlyaWZpZXIgc2kgbGEgbGlnbmUgZXN0IGRhbnMgdW4gYmxvYyBzcFx1MDBFOWNpYWxcclxuICAgIGlmIChpc0xpbmVJblNwZWNpYWxCbG9jayhkb2N1bWVudFRleHQsIGxpbmVOdW1iZXIpKSB7XHJcbiAgICAgICAgLy8gRFx1MDBFOXRlcm1pbmVyIGxlIHR5cGUgZGUgYmxvYyBzcFx1MDBFOWNpYWxcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhbmFseXplRG9jdW1lbnRTdHJ1Y3R1cmUoZG9jdW1lbnRUZXh0LCBsaW5lTnVtYmVyLCBsaW5lTnVtYmVyKTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0LmxpbmVUeXBlc1swXTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuICdub3JtYWwnO1xyXG59IiwgImltcG9ydCB7IFBsdWdpbiwgRWRpdG9yIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbmltcG9ydCB7IGlzTGluZUluU3BlY2lhbEJsb2NrIH0gZnJvbSBcIi4uL2NvcmUvYmxvY2tBbmFseXplclwiO1xyXG5cclxuXHJcbi8qKlxyXG4gKiBWXHUwMEU5cmlmaWUgc2kgbGUgY3Vyc2V1ciBlc3QgZGFucyB1biBibG9jIHNwXHUwMEU5Y2lhbCAoZnJvbnRtYXR0ZXIgb3UgY29kZSlcclxuICogQHBhcmFtIGVkaXRvciBcdTAwQzlkaXRldXIgT2JzaWRpYW5cclxuICogQHJldHVybnMgdHJ1ZSBzaSBsZSBjdXJzZXVyIGVzdCBkYW5zIHVuIGJsb2Mgc3BcdTAwRTljaWFsXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gaXNJblNwZWNpYWxCbG9jayhlZGl0b3I6IEVkaXRvcik6IGJvb2xlYW4ge1xyXG4gICAgY29uc3QgY3Vyc29yID0gZWRpdG9yLmdldEN1cnNvcigpO1xyXG4gICAgY29uc3QgdGV4dCA9IGVkaXRvci5nZXRWYWx1ZSgpO1xyXG4gICAgXHJcbiAgICByZXR1cm4gaXNMaW5lSW5TcGVjaWFsQmxvY2sodGV4dCwgY3Vyc29yLmxpbmUpO1xyXG59XHJcblxyXG5cclxuLyoqXHJcbiAqIFZcdTAwRTlyaWZpZSBzaSBsZSBjdXJzZXVyIGVzdCBkYW5zIHVuIFx1MDBFOWxcdTAwRTltZW50IE1hcmtkb3duIHNwXHUwMEU5Y2lhbCBcdTAwRTAgcHJcdTAwRTlzZXJ2ZXJcclxuICogQHBhcmFtIGVkaXRvciBcdTAwQzlkaXRldXIgT2JzaWRpYW5cclxuICogQHJldHVybnMgdHJ1ZSBzaSBsZSBjdXJzZXVyIGVzdCBkYW5zIHVuIFx1MDBFOWxcdTAwRTltZW50IFx1MDBFMCBwclx1MDBFOXNlcnZlclxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGlzSW5QcmVzZXJ2ZWRNYXJrZG93bihlZGl0b3I6IEVkaXRvcik6IGJvb2xlYW4ge1xyXG4gICAgY29uc3QgY3Vyc29yID0gZWRpdG9yLmdldEN1cnNvcigpO1xyXG4gICAgY29uc3QgbGluZSA9IGVkaXRvci5nZXRMaW5lKGN1cnNvci5saW5lKTtcclxuICAgIFxyXG4gICAgLy8gMS4gVlx1MDBFOXJpZmllciBzaSBvbiBlc3QgZGFucyB1biBjb2RlIGlubGluZSAoZW50cmUgYmFja3RpY2tzKVxyXG4gICAgY29uc3QgY29kZUlubGluZVBhdHRlcm4gPSAvYFteYF0qYC9nO1xyXG4gICAgY29uc3QgY29kZUlubGluZU1hdGNoZXMgPSBbLi4ubGluZS5tYXRjaEFsbChjb2RlSW5saW5lUGF0dGVybildO1xyXG4gICAgZm9yIChjb25zdCBtYXRjaCBvZiBjb2RlSW5saW5lTWF0Y2hlcykge1xyXG4gICAgICAgIGNvbnN0IHN0YXJ0ID0gbWF0Y2guaW5kZXggfHwgMDtcclxuICAgICAgICBjb25zdCBlbmQgPSBzdGFydCArIG1hdGNoWzBdLmxlbmd0aDtcclxuICAgICAgICBpZiAoY3Vyc29yLmNoID49IHN0YXJ0ICYmIGN1cnNvci5jaCA8PSBlbmQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyAyLiBWXHUwMEU5cmlmaWVyIHNpIG9uIGVzdCBkYW5zIHVuIGxpZW4gaW50ZXJuZSBPYnNpZGlhblxyXG4gICAgY29uc3Qgb2JzaWRpYW5MaW5rUGF0dGVybiA9IC9cXFtcXFtbXlxcXV0qXFxdXFxdL2c7XHJcbiAgICBjb25zdCBvYnNpZGlhbkxpbmtNYXRjaGVzID0gWy4uLmxpbmUubWF0Y2hBbGwob2JzaWRpYW5MaW5rUGF0dGVybildO1xyXG4gICAgZm9yIChjb25zdCBtYXRjaCBvZiBvYnNpZGlhbkxpbmtNYXRjaGVzKSB7XHJcbiAgICAgICAgY29uc3Qgc3RhcnQgPSBtYXRjaC5pbmRleCB8fCAwO1xyXG4gICAgICAgIGNvbnN0IGVuZCA9IHN0YXJ0ICsgbWF0Y2hbMF0ubGVuZ3RoO1xyXG4gICAgICAgIGlmIChjdXJzb3IuY2ggPj0gc3RhcnQgJiYgY3Vyc29yLmNoIDw9IGVuZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIDMuIFZcdTAwRTlyaWZpZXIgc2kgb24gZXN0IGRhbnMgdW5lIFx1MDBFOXF1YXRpb24gbWF0aFx1MDBFOW1hdGlxdWUgaW5saW5lXHJcbiAgICBjb25zdCBtYXRoSW5saW5lUGF0dGVybiA9IC9cXCRbXiRdKlxcJC9nO1xyXG4gICAgY29uc3QgbWF0aElubGluZU1hdGNoZXMgPSBbLi4ubGluZS5tYXRjaEFsbChtYXRoSW5saW5lUGF0dGVybildO1xyXG4gICAgZm9yIChjb25zdCBtYXRjaCBvZiBtYXRoSW5saW5lTWF0Y2hlcykge1xyXG4gICAgICAgIGNvbnN0IHN0YXJ0ID0gbWF0Y2guaW5kZXggfHwgMDtcclxuICAgICAgICBjb25zdCBlbmQgPSBzdGFydCArIG1hdGNoWzBdLmxlbmd0aDtcclxuICAgICAgICBpZiAoY3Vyc29yLmNoID49IHN0YXJ0ICYmIGN1cnNvci5jaCA8PSBlbmQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyA0LiBWXHUwMEU5cmlmaWVyIHNpIG9uIGVzdCBkYW5zIHVuZSBcdTAwRTlxdWF0aW9uIG1hdGhcdTAwRTltYXRpcXVlIGJsb2NcclxuICAgIC8vIE9uIG5lIHZcdTAwRTlyaWZpZSBxdWUgbGUgZFx1MDBFOWJ1dCBldCBsYSBmaW4gY2FyIGxlIGJsb2MgcGV1dCBzJ1x1MDBFOXRlbmRyZSBzdXIgcGx1c2lldXJzIGxpZ25lc1xyXG4gICAgaWYgKGxpbmUuaW5jbHVkZXMoXCIkJFwiKSkge1xyXG4gICAgICAgIGNvbnN0IG1hdGNoZXMgPSBbLi4ubGluZS5tYXRjaEFsbCgvXFwkXFwkL2cpXTtcclxuICAgICAgICBmb3IgKGNvbnN0IG1hdGNoIG9mIG1hdGNoZXMpIHtcclxuICAgICAgICAgICAgY29uc3Qgc3RhcnQgPSBtYXRjaC5pbmRleCB8fCAwO1xyXG4gICAgICAgICAgICBjb25zdCBlbmQgPSBzdGFydCArIDI7XHJcbiAgICAgICAgICAgIGlmIChjdXJzb3IuY2ggPj0gc3RhcnQgJiYgY3Vyc29yLmNoIDw9IGVuZCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIDUuIFZcdTAwRTlyaWZpZXIgc2kgb24gZXN0IGRhbnMgdW4gY2FsbG91dFxyXG4gICAgY29uc3QgY2FsbG91dFBhdHRlcm4gPSAvXj5cXHMrXFxbIS4qXFxdLztcclxuICAgIGlmIChjYWxsb3V0UGF0dGVybi50ZXN0KGxpbmUpICYmIGN1cnNvci5jaCA8PSBsaW5lLmxlbmd0aCkge1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyA2LiBWXHUwMEU5cmlmaWVyIHNpIG9uIGVzdCBkYW5zIHVuZSBVUkwgZGlyZWN0ZVxyXG4gICAgY29uc3QgdXJsUGF0dGVybiA9IC8oaHR0cHM/OlxcL1xcL3x3d3dcXC4pW15cXHNdKy9nO1xyXG4gICAgY29uc3QgdXJsTWF0Y2hlcyA9IFsuLi5saW5lLm1hdGNoQWxsKHVybFBhdHRlcm4pXTtcclxuICAgIGZvciAoY29uc3QgbWF0Y2ggb2YgdXJsTWF0Y2hlcykge1xyXG4gICAgICAgIGNvbnN0IHN0YXJ0ID0gbWF0Y2guaW5kZXggfHwgMDtcclxuICAgICAgICBjb25zdCBlbmQgPSBzdGFydCArIG1hdGNoWzBdLmxlbmd0aDtcclxuICAgICAgICBpZiAoY3Vyc29yLmNoID49IHN0YXJ0ICYmIGN1cnNvci5jaCA8PSBlbmQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyA3LiBQb3VyIGxlcyBpbWFnZXMgZXQgbGllbnMsIHZcdTAwRTlyaWZpZXIgc2kgbGUgY3Vyc2V1ciBlc3QgXHUwMEUwIGwnaW50XHUwMEU5cmlldXJcclxuICAgIGNvbnN0IGltYWdlUGF0dGVybiA9IC8hXFxbLio/XFxdXFwoLio/XFwpL2c7XHJcbiAgICBjb25zdCBpbWFnZU1hdGNoZXMgPSBbLi4ubGluZS5tYXRjaEFsbChpbWFnZVBhdHRlcm4pXTtcclxuICAgIGZvciAoY29uc3QgbWF0Y2ggb2YgaW1hZ2VNYXRjaGVzKSB7XHJcbiAgICAgICAgY29uc3Qgc3RhcnQgPSBtYXRjaC5pbmRleCB8fCAwO1xyXG4gICAgICAgIGNvbnN0IGVuZCA9IHN0YXJ0ICsgbWF0Y2hbMF0ubGVuZ3RoO1xyXG4gICAgICAgIGlmIChjdXJzb3IuY2ggPj0gc3RhcnQgJiYgY3Vyc29yLmNoIDw9IGVuZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIDguIFBvdXIgbGVzIGxpZW5zIE1hcmtkb3duXHJcbiAgICBjb25zdCBsaW5rUGF0dGVybiA9IC9cXFsuKj9cXF1cXCguKj9cXCkvZztcclxuICAgIGNvbnN0IGxpbmtNYXRjaGVzID0gWy4uLmxpbmUubWF0Y2hBbGwobGlua1BhdHRlcm4pXTtcclxuICAgIGZvciAoY29uc3QgbWF0Y2ggb2YgbGlua01hdGNoZXMpIHtcclxuICAgICAgICBjb25zdCBzdGFydCA9IG1hdGNoLmluZGV4IHx8IDA7XHJcbiAgICAgICAgY29uc3QgZW5kID0gc3RhcnQgKyBtYXRjaFswXS5sZW5ndGg7XHJcbiAgICAgICAgaWYgKGN1cnNvci5jaCA+PSBzdGFydCAmJiBjdXJzb3IuY2ggPD0gZW5kKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gOS4gUG91ciBsZXMgYmFsaXNlcyBIVE1MXHJcbiAgICBjb25zdCBodG1sVGFnUGF0dGVybiA9IC88W14+XSo+L2c7XHJcbiAgICBjb25zdCBodG1sTWF0Y2hlcyA9IFsuLi5saW5lLm1hdGNoQWxsKGh0bWxUYWdQYXR0ZXJuKV07XHJcbiAgICBmb3IgKGNvbnN0IG1hdGNoIG9mIGh0bWxNYXRjaGVzKSB7XHJcbiAgICAgICAgY29uc3Qgc3RhcnQgPSBtYXRjaC5pbmRleCB8fCAwO1xyXG4gICAgICAgIGNvbnN0IGVuZCA9IHN0YXJ0ICsgbWF0Y2hbMF0ubGVuZ3RoO1xyXG4gICAgICAgIGlmIChjdXJzb3IuY2ggPj0gc3RhcnQgJiYgY3Vyc29yLmNoIDw9IGVuZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIDEwLiBWXHUwMEU5cmlmaWVyIHNpIG9uIGVzdCBkYW5zIHVuIGlkZW50aWZpYW50IGRlIHRcdTAwRTJjaGVcclxuICAgIGNvbnN0IHRhc2tQYXR0ZXJuID0gL15cXHMqLSBcXFtbIHhdXFxdLztcclxuICAgIGlmICh0YXNrUGF0dGVybi50ZXN0KGxpbmUpICYmIGN1cnNvci5jaCA8PSBsaW5lLmluZGV4T2YoXCJdXCIpICsgMSkge1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbn1cclxuXHJcblxyXG4vKipcclxuICogSW5qZWN0ZSB1biBmaWNoaWVyIENTUyBkYW5zIGxlIGRvY3VtZW50XHJcbiAqIEBwYXJhbSBwbHVnaW4gSW5zdGFuY2UgZHUgcGx1Z2luXHJcbiAqIEBwYXJhbSBmaWxlTmFtZSBOb20gZHUgZmljaGllciBDU1MgKHJlbGF0aWYgYXUgclx1MDBFOXBlcnRvaXJlIGR1IHBsdWdpbilcclxuICogQHJldHVybnMgUHJvbWVzc2Ugclx1MDBFOXNvbHVlIHVuZSBmb2lzIGxlIENTUyBpbmplY3RcdTAwRTlcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpbmplY3RDU1NGcm9tRmlsZShwbHVnaW46IFBsdWdpbiwgZmlsZU5hbWU6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBwbHVnaW5EaXIgPSBwbHVnaW4ubWFuaWZlc3QuZGlyO1xyXG4gICAgICAgIGNvbnN0IGZpbGVQYXRoID0gYCR7cGx1Z2luRGlyfS8ke2ZpbGVOYW1lfWA7XHJcblxyXG4gICAgICAgIGNvbnN0IGNzc0NvbnRlbnQgPSBhd2FpdCBwbHVnaW4uYXBwLnZhdWx0LmFkYXB0ZXIucmVhZChmaWxlUGF0aCk7XHJcbiAgICAgICAgY29uc3Qgc3R5bGVFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3N0eWxlJyk7XHJcbiAgICAgICAgc3R5bGVFbC50ZXh0Q29udGVudCA9IGNzc0NvbnRlbnQ7XHJcbiAgICAgICAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChzdHlsZUVsKTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcIlx1MDBDOWNoZWMgZGUgY2hhcmdlbWVudCBkdSBmaWNoaWVyIENTUzpcIiwgZXJyb3IpO1xyXG4gICAgfVxyXG59XHJcblxyXG4vKipcclxuICogVlx1MDBFOXJpZmllIHNpIHVuZSBjaGFcdTAwRUVuZSBkZSBjYXJhY3RcdTAwRThyZXMgZXN0IHZpZGUgb3UgbmUgY29udGllbnQgcXVlIGRlcyBlc3BhY2VzXHJcbiAqIEBwYXJhbSBzdHIgQ2hhXHUwMEVFbmUgXHUwMEUwIHZcdTAwRTlyaWZpZXJcclxuICogQHJldHVybnMgdHJ1ZSBzaSBsYSBjaGFcdTAwRUVuZSBlc3QgdmlkZSBvdSBuZSBjb250aWVudCBxdWUgZGVzIGVzcGFjZXNcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBpc0VtcHR5T3JXaGl0ZXNwYWNlKHN0cjogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gc3RyID09PSBudWxsIHx8IHN0ci50cmltKCkgPT09ICcnO1xyXG59XHJcblxyXG4vKipcclxuICogT2J0aWVudCBsYSBwb3NpdGlvbiBkdSB0ZXh0ZSBkYW5zIHVuIGRvY3VtZW50XHJcbiAqIEBwYXJhbSB0ZXh0IFRleHRlIGNvbXBsZXRcclxuICogQHBhcmFtIHNlYXJjaFRleHQgVGV4dGUgXHUwMEUwIHJlY2hlcmNoZXJcclxuICogQHBhcmFtIHN0YXJ0SW5kZXggSW5kZXggZGUgZFx1MDBFOXBhcnQgcG91ciBsYSByZWNoZXJjaGUgKG9wdGlvbm5lbClcclxuICogQHJldHVybnMgT2JqZXQgYXZlYyBsZXMgcHJvcHJpXHUwMEU5dFx1MDBFOXMgZnJvbUxpbmUsIGZyb21DaCwgdG9MaW5lLCB0b0NoIG91IG51bGwgc2kgbm9uIHRyb3V2XHUwMEU5XHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0VGV4dFBvc2l0aW9uKHRleHQ6IHN0cmluZywgc2VhcmNoVGV4dDogc3RyaW5nLCBzdGFydEluZGV4ID0gMCk6IHtcclxuICAgIGZyb21MaW5lOiBudW1iZXIsIFxyXG4gICAgZnJvbUNoOiBudW1iZXIsIFxyXG4gICAgdG9MaW5lOiBudW1iZXIsIFxyXG4gICAgdG9DaDogbnVtYmVyXHJcbn0gfCBudWxsIHtcclxuICAgIGNvbnN0IGluZGV4ID0gdGV4dC5pbmRleE9mKHNlYXJjaFRleHQsIHN0YXJ0SW5kZXgpO1xyXG4gICAgaWYgKGluZGV4ID09PSAtMSkge1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBjb25zdCB0ZXh0QmVmb3JlID0gdGV4dC5zdWJzdHJpbmcoMCwgaW5kZXgpO1xyXG4gICAgY29uc3QgbGluZXMgPSB0ZXh0QmVmb3JlLnNwbGl0KCdcXG4nKTtcclxuICAgIGNvbnN0IGZyb21MaW5lID0gbGluZXMubGVuZ3RoIC0gMTtcclxuICAgIGNvbnN0IGZyb21DaCA9IGxpbmVzW2Zyb21MaW5lXS5sZW5ndGg7XHJcbiAgICBcclxuICAgIGNvbnN0IHNlYXJjaExpbmVzID0gc2VhcmNoVGV4dC5zcGxpdCgnXFxuJyk7XHJcbiAgICBjb25zdCB0b0xpbmUgPSBmcm9tTGluZSArIHNlYXJjaExpbmVzLmxlbmd0aCAtIDE7XHJcbiAgICBjb25zdCB0b0NoID0gdG9MaW5lID09PSBmcm9tTGluZSA/IFxyXG4gICAgICAgIGZyb21DaCArIHNlYXJjaFRleHQubGVuZ3RoIDogXHJcbiAgICAgICAgc2VhcmNoTGluZXNbc2VhcmNoTGluZXMubGVuZ3RoIC0gMV0ubGVuZ3RoO1xyXG4gICAgXHJcbiAgICByZXR1cm4geyBmcm9tTGluZSwgZnJvbUNoLCB0b0xpbmUsIHRvQ2ggfTtcclxufVxyXG5cclxuLyoqXHJcbiAqIE1lc3VyZSBsZSB0ZW1wcyBkJ2V4XHUwMEU5Y3V0aW9uIGQndW5lIGZvbmN0aW9uXHJcbiAqIEBwYXJhbSBmbiBGb25jdGlvbiBcdTAwRTAgbWVzdXJlclxyXG4gKiBAcGFyYW0gYXJncyBBcmd1bWVudHMgXHUwMEUwIHBhc3NlciBcdTAwRTAgbGEgZm9uY3Rpb25cclxuICogQHJldHVybnMgTGUgclx1MDBFOXN1bHRhdCBkZSBsYSBmb25jdGlvbiBldCBsZSB0ZW1wcyBkJ2V4XHUwMEU5Y3V0aW9uIGVuIG1zXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbWVhc3VyZUV4ZWN1dGlvblRpbWU8VCwgQSBleHRlbmRzIGFueVtdPihcclxuICAgIGZuOiAoLi4uYXJnczogQSkgPT4gUHJvbWlzZTxUPiB8IFQsIFxyXG4gICAgLi4uYXJnczogQVxyXG4pOiBQcm9taXNlPHsgcmVzdWx0OiBULCBleGVjdXRpb25UaW1lOiBudW1iZXIgfT4ge1xyXG4gICAgY29uc3Qgc3RhcnRUaW1lID0gcGVyZm9ybWFuY2Uubm93KCk7XHJcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBmbiguLi5hcmdzKTtcclxuICAgIGNvbnN0IGVuZFRpbWUgPSBwZXJmb3JtYW5jZS5ub3coKTtcclxuICAgIGNvbnN0IGV4ZWN1dGlvblRpbWUgPSBlbmRUaW1lIC0gc3RhcnRUaW1lO1xyXG4gICAgXHJcbiAgICByZXR1cm4geyByZXN1bHQsIGV4ZWN1dGlvblRpbWUgfTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEFmZmljaGUgdW4gbWVzc2FnZSBkZSBwZXJmb3JtYW5jZSBkYW5zIGxhIGNvbnNvbGVcclxuICogQHBhcmFtIG9wZXJhdGlvbiBOb20gZGUgbCdvcFx1MDBFOXJhdGlvblxyXG4gKiBAcGFyYW0gZXhlY3V0aW9uVGltZSBUZW1wcyBkJ2V4XHUwMEU5Y3V0aW9uIGVuIG1zXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gbG9nUGVyZm9ybWFuY2Uob3BlcmF0aW9uOiBzdHJpbmcsIGV4ZWN1dGlvblRpbWU6IG51bWJlcik6IHZvaWQge1xyXG4gICAgY29uc29sZS5sb2coYFBlcmZvcm1hbmNlIC0gJHtvcGVyYXRpb259OiAke2V4ZWN1dGlvblRpbWUudG9GaXhlZCgyKX1tc2ApO1xyXG59XHJcblxyXG4vKipcclxuICogRXhcdTAwRTljdXRlIHVuZSBmb25jdGlvbiBhdmVjIHVuIGRcdTAwRTlsYWkgZCdhdHRlbnRlXHJcbiAqIENldHRlIGZvbmN0aW9uIGVzdCB1dGlsZSBwb3VyIFx1MDBFOXZpdGVyIGRlIGJsb3F1ZXIgbCdpbnRlcmZhY2UgdXRpbGlzYXRldXJcclxuICogQHBhcmFtIGZuIEZvbmN0aW9uIFx1MDBFMCBleFx1MDBFOWN1dGVyXHJcbiAqIEBwYXJhbSBkZWxheSBEXHUwMEU5bGFpIGVuIG1zXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZGVib3VuY2U8RiBleHRlbmRzICguLi5hcmdzOiBhbnlbXSkgPT4gYW55PihmbjogRiwgZGVsYXk6IG51bWJlcik6ICguLi5hcmdzOiBQYXJhbWV0ZXJzPEY+KSA9PiB2b2lkIHtcclxuICAgIGxldCB0aW1lb3V0OiBOb2RlSlMuVGltZW91dDtcclxuICAgIFxyXG4gICAgcmV0dXJuIGZ1bmN0aW9uKC4uLmFyZ3M6IFBhcmFtZXRlcnM8Rj4pIHtcclxuICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dCk7XHJcbiAgICAgICAgdGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4gZm4oLi4uYXJncyksIGRlbGF5KTtcclxuICAgIH07XHJcbn0iLCAiLy8gTW9kdWxlIGQnYXBlclx1MDBFN3UgZGlyZWN0IG1pcyBcdTAwRTAgam91clxyXG5cclxuaW1wb3J0IHsgRWRpdG9yIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbmltcG9ydCB7IE1pY3JvdHlwb2dyYXBoaWVTZXR0aW5ncyB9IGZyb20gJy4uL3NldHRpbmdzL3NldHRpbmdzJztcclxuaW1wb3J0IHsgaXNJblNwZWNpYWxCbG9jaywgaXNJblByZXNlcnZlZE1hcmtkb3duIH0gZnJvbSAnLi4vdXRpbHMvaGVscGVycyc7XHJcblxyXG5leHBvcnQgY2xhc3MgTGl2ZVR5cG9ncmFwaHlNb2R1bGUge1xyXG4gICAgcHJpdmF0ZSBzZXR0aW5nczogTWljcm90eXBvZ3JhcGhpZVNldHRpbmdzO1xyXG4gICAgcHJpdmF0ZSBvcGVuUXVvdGU6IGJvb2xlYW4gPSB0cnVlO1xyXG4gICAgXHJcbiAgICBjb25zdHJ1Y3RvcihzZXR0aW5nczogTWljcm90eXBvZ3JhcGhpZVNldHRpbmdzKSB7XHJcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IHNldHRpbmdzO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogSW5pdGlhbGlzZSBsZSBtb2R1bGUgYXZlYyBsZXMgcGFyYW1cdTAwRTh0cmVzIGFjdHVlbHNcclxuICAgICAqIEBwYXJhbSBzZXR0aW5ncyBQYXJhbVx1MDBFOHRyZXMgbWlzIFx1MDBFMCBqb3VyXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyB1cGRhdGVTZXR0aW5ncyhzZXR0aW5nczogTWljcm90eXBvZ3JhcGhpZVNldHRpbmdzKSB7XHJcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IHNldHRpbmdzO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBwdWJsaWMgcmVzZXRRdW90ZVN0YXRlKCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMub3BlblF1b3RlID0gdHJ1ZTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBHXHUwMEU4cmUgbGVzIFx1MDBFOXZcdTAwRTluZW1lbnRzIGNsYXZpZXIgcG91ciBhcHBsaXF1ZXIgbGVzIHJcdTAwRThnbGVzIHR5cG9ncmFwaGlxdWVzIGVuIHRlbXBzIHJcdTAwRTllbFxyXG4gICAgICogQHBhcmFtIGV2ZW50IFx1MDBDOXZcdTAwRTluZW1lbnQgY2xhdmllclxyXG4gICAgICogQHBhcmFtIGVkaXRvciBcdTAwQzlkaXRldXIgT2JzaWRpYW5cclxuICAgICAqIEByZXR1cm5zIHRydWUgc2kgbCdcdTAwRTl2XHUwMEU5bmVtZW50IGEgXHUwMEU5dFx1MDBFOSBnXHUwMEU5clx1MDBFOSwgZmFsc2Ugc2lub25cclxuICAgICAqL1xyXG4gICAgcHVibGljIGhhbmRsZUtleUV2ZW50KGV2ZW50OiBLZXlib2FyZEV2ZW50LCBlZGl0b3I6IEVkaXRvcik6IGJvb2xlYW4ge1xyXG4gICAgICAgIC8vIFZcdTAwRTlyaWZpZXIgc2kgbGUgY3Vyc2V1ciBlc3QgZGFucyB1biBibG9jIHNwXHUwMEU5Y2lhbCBvdSB1biBcdTAwRTlsXHUwMEU5bWVudCBcdTAwRTAgcHJcdTAwRTlzZXJ2ZXJcclxuICAgICAgICBpZiAoaXNJblNwZWNpYWxCbG9jayhlZGl0b3IpIHx8IGlzSW5QcmVzZXJ2ZWRNYXJrZG93bihlZGl0b3IpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IGN1cnNvciA9IGVkaXRvci5nZXRDdXJzb3IoKTtcclxuICAgICAgICBsZXQgaGFuZGxlZCA9IGZhbHNlO1xyXG5cclxuICAgICAgICAvLyBHXHUwMEU5cmVyIGwnYXBvc3Ryb3BoZSB0eXBvZ3JhcGhpcXVlXHJcbiAgICAgICAgaWYgKGV2ZW50LmtleSA9PT0gXCInXCIpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgY29uc3Qgc2VsZWN0aW9uID0gZWRpdG9yLmdldFNlbGVjdGlvbigpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgaWYgKHNlbGVjdGlvbi5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBlZGl0b3IucmVwbGFjZVNlbGVjdGlvbih0aGlzLnNldHRpbmdzLm9wZW5TaW5nbGVRdW90ZSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKHRoaXMuc2V0dGluZ3Mub3BlblNpbmdsZVF1b3RlLCBjdXJzb3IpO1xyXG4gICAgICAgICAgICAgICAgZWRpdG9yLnNldEN1cnNvcih7IGxpbmU6IGN1cnNvci5saW5lLCBjaDogY3Vyc29yLmNoICsgdGhpcy5zZXR0aW5ncy5vcGVuU2luZ2xlUXVvdGUubGVuZ3RoIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGhhbmRsZWQgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICAvLyBHXHUwMEU5cmVyIGxlcyBlc3BhY2VzIGluc1x1MDBFOWNhYmxlcyBhdmFudCBsYSBwb25jdHVhdGlvbiAoclx1MDBFOGdsZXMgZnJhblx1MDBFN2Fpc2VzKVxyXG4gICAgICAgIGVsc2UgaWYgKFsnIScsICc/JywgJzsnXS5pbmNsdWRlcyhldmVudC5rZXkpICYmIHRoaXMuc2V0dGluZ3MuZnJlbmNoUnVsZXNFbmFibGVkKSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGNoYXJCZWZvcmUgPSBlZGl0b3IuZ2V0UmFuZ2UoXHJcbiAgICAgICAgICAgICAgICB7IGxpbmU6IGN1cnNvci5saW5lLCBjaDogY3Vyc29yLmNoIC0gMSB9LFxyXG4gICAgICAgICAgICAgICAgY3Vyc29yXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBpZiAoY2hhckJlZm9yZSA9PT0gXCIgXCIpIHtcclxuICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UoXCJcXHUyMDJGXCIgKyBldmVudC5rZXksIFxyXG4gICAgICAgICAgICAgICAgICAgIHsgbGluZTogY3Vyc29yLmxpbmUsIGNoOiBjdXJzb3IuY2ggLSAxIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgY3Vyc29yXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZShldmVudC5rZXksIGN1cnNvcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWRpdG9yLnNldEN1cnNvcih7IGxpbmU6IGN1cnNvci5saW5lLCBjaDogY3Vyc29yLmNoICsgMSB9KTtcclxuICAgICAgICAgICAgaGFuZGxlZCA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIEdcdTAwRTlyZXIgbGVzIGVzcGFjZXMgaW5zXHUwMEU5Y2FibGVzIGF2YW50IGxlcyBkZXV4LXBvaW50cyAoclx1MDBFOGdsZXMgZnJhblx1MDBFN2Fpc2VzKVxyXG4gICAgICAgIGVsc2UgaWYgKGV2ZW50LmtleSA9PT0gJzonICYmIHRoaXMuc2V0dGluZ3MuZnJlbmNoUnVsZXNFbmFibGVkKSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGNoYXJCZWZvcmUgPSBlZGl0b3IuZ2V0UmFuZ2UoXHJcbiAgICAgICAgICAgICAgICB7IGxpbmU6IGN1cnNvci5saW5lLCBjaDogY3Vyc29yLmNoIC0gMSB9LFxyXG4gICAgICAgICAgICAgICAgY3Vyc29yXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBpZiAoY2hhckJlZm9yZSA9PT0gXCIgXCIpIHtcclxuICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UoXCJcXHUwMEEwXCIgKyBldmVudC5rZXksIFxyXG4gICAgICAgICAgICAgICAgICAgIHsgbGluZTogY3Vyc29yLmxpbmUsIGNoOiBjdXJzb3IuY2ggLSAxIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgY3Vyc29yXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZShldmVudC5rZXksIGN1cnNvcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWRpdG9yLnNldEN1cnNvcih7IGxpbmU6IGN1cnNvci5saW5lLCBjaDogY3Vyc29yLmNoICsgMSB9KTtcclxuICAgICAgICAgICAgaGFuZGxlZCA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIEdcdTAwRTlyZXIgbGVzIGd1aWxsZW1ldHMgcGVyc29ubmFsaXNhYmxlc1xyXG4gICAgICAgIGVsc2UgaWYgKGV2ZW50LmtleSA9PT0gJ1wiJykge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgaWYgKHRoaXMub3BlblF1b3RlKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBJbnNcdTAwRTlyZXIgbGUgZ3VpbGxlbWV0IG91dnJhbnRcclxuICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UodGhpcy5zZXR0aW5ncy5vcGVuRG91YmxlUXVvdGUsIGN1cnNvcik7XHJcbiAgICAgICAgICAgICAgICBlZGl0b3Iuc2V0Q3Vyc29yKHsgXHJcbiAgICAgICAgICAgICAgICAgICAgbGluZTogY3Vyc29yLmxpbmUsIFxyXG4gICAgICAgICAgICAgICAgICAgIGNoOiBjdXJzb3IuY2ggKyB0aGlzLnNldHRpbmdzLm9wZW5Eb3VibGVRdW90ZS5sZW5ndGggXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIEluc1x1MDBFOXJlciBsZSBndWlsbGVtZXQgZmVybWFudFxyXG4gICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZSh0aGlzLnNldHRpbmdzLmNsb3NlRG91YmxlUXVvdGUsIGN1cnNvcik7XHJcbiAgICAgICAgICAgICAgICBlZGl0b3Iuc2V0Q3Vyc29yKHsgXHJcbiAgICAgICAgICAgICAgICAgICAgbGluZTogY3Vyc29yLmxpbmUsIFxyXG4gICAgICAgICAgICAgICAgICAgIGNoOiBjdXJzb3IuY2ggKyB0aGlzLnNldHRpbmdzLmNsb3NlRG91YmxlUXVvdGUubGVuZ3RoIFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIEFsdGVybmVyIHBvdXIgbGUgcHJvY2hhaW4gZ3VpbGxlbWV0XHJcbiAgICAgICAgICAgIHRoaXMub3BlblF1b3RlID0gIXRoaXMub3BlblF1b3RlO1xyXG4gICAgICAgICAgICBoYW5kbGVkID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gR2VzdGlvbiBwb3VyIGxlcyBwb2ludHMgZGUgc3VzcGVuc2lvblxyXG4gICAgICAgIGVsc2UgaWYgKGV2ZW50LmtleSA9PT0gJy4nICYmIHRoaXMuc2V0dGluZ3MuZWxsaXBzaXNFbmFibGVkKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHRleHRCZWZvcmUgPSBlZGl0b3IuZ2V0UmFuZ2UoXHJcbiAgICAgICAgICAgICAgICB7IGxpbmU6IGN1cnNvci5saW5lLCBjaDogY3Vyc29yLmNoIC0gMiB9LCBcclxuICAgICAgICAgICAgICAgIGN1cnNvclxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgaWYgKHRleHRCZWZvcmUgPT09ICcuLicpIHtcclxuICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKCdcdTIwMjYnLCBcclxuICAgICAgICAgICAgICAgICAgICB7IGxpbmU6IGN1cnNvci5saW5lLCBjaDogY3Vyc29yLmNoIC0gMiB9LCBcclxuICAgICAgICAgICAgICAgICAgICBjdXJzb3JcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICBlZGl0b3Iuc2V0Q3Vyc29yKHsgbGluZTogY3Vyc29yLmxpbmUsIGNoOiBjdXJzb3IuY2ggLSAxIH0pO1xyXG4gICAgICAgICAgICAgICAgaGFuZGxlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gR2VzdGlvbiBwb3VyIGxlcyB0aXJldHNcclxuICAgICAgICBlbHNlIGlmIChldmVudC5rZXkgPT09ICctJyAmJiB0aGlzLnNldHRpbmdzLmRhc2hlc0VuYWJsZWQpIHtcclxuICAgICAgICAgICAgY29uc3QgdGV4dEJlZm9yZSA9IGVkaXRvci5nZXRSYW5nZShcclxuICAgICAgICAgICAgICAgIHsgbGluZTogY3Vyc29yLmxpbmUsIGNoOiBjdXJzb3IuY2ggLSAxIH0sIFxyXG4gICAgICAgICAgICAgICAgY3Vyc29yXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5za2lwRW5EYXNoKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBNb2RlIGRpcmVjdCAtLSB2ZXJzIGVtLWRhc2ggKFx1MjAxNClcclxuICAgICAgICAgICAgICAgIGlmICh0ZXh0QmVmb3JlID09PSAnLScpIHtcclxuICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UoJ1x1MjAxNCcsIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7IGxpbmU6IGN1cnNvci5saW5lLCBjaDogY3Vyc29yLmNoIC0gMSB9LCBcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3Vyc29yXHJcbiAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICBlZGl0b3Iuc2V0Q3Vyc29yKHsgbGluZTogY3Vyc29yLmxpbmUsIGNoOiBjdXJzb3IuY2ggfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyBNb2RlIHByb2dyZXNzaWY6IC0tIHZlcnMgZW4tZGFzaCwgcHVpcyBlbi1kYXNoLSB2ZXJzIGVtLWRhc2gsIHB1aXMgZW0tZGFzaC0gdmVycyAtLS1cclxuICAgICAgICAgICAgICAgIGlmICh0ZXh0QmVmb3JlID09PSAnLScpIHtcclxuICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UoJ1x1MjAxMycsIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7IGxpbmU6IGN1cnNvci5saW5lLCBjaDogY3Vyc29yLmNoIC0gMSB9LCBcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3Vyc29yXHJcbiAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICBlZGl0b3Iuc2V0Q3Vyc29yKHsgbGluZTogY3Vyc29yLmxpbmUsIGNoOiBjdXJzb3IuY2ggfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRleHRCZWZvcmUgPT09ICdcdTIwMTMnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKCdcdTIwMTQnLCBcclxuICAgICAgICAgICAgICAgICAgICAgICAgeyBsaW5lOiBjdXJzb3IubGluZSwgY2g6IGN1cnNvci5jaCAtIDEgfSwgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnNvclxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgZWRpdG9yLnNldEN1cnNvcih7IGxpbmU6IGN1cnNvci5saW5lLCBjaDogY3Vyc29yLmNoIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGhhbmRsZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0ZXh0QmVmb3JlID09PSAnXHUyMDE0Jykge1xyXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZSgnLS0tJywgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHsgbGluZTogY3Vyc29yLmxpbmUsIGNoOiBjdXJzb3IuY2ggLSAxIH0sIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJzb3JcclxuICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgIGVkaXRvci5zZXRDdXJzb3IoeyBsaW5lOiBjdXJzb3IubGluZSwgY2g6IGN1cnNvci5jaCArIDIgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gR2VzdGlvbiBwb3VyIGxlcyBndWlsbGVtZXRzIGZyYW5cdTAwRTdhaXMgdmlhIGNoZXZyb25zXHJcbiAgICAgICAgZWxzZSBpZiAoZXZlbnQua2V5ID09PSAnPicgJiYgdGhpcy5zZXR0aW5ncy5ndWlsbGVtZXRzRW5hYmxlZCkge1xyXG4gICAgICAgICAgICBjb25zdCB0ZXh0QmVmb3JlID0gZWRpdG9yLmdldFJhbmdlKFxyXG4gICAgICAgICAgICAgICAgeyBsaW5lOiBjdXJzb3IubGluZSwgY2g6IGN1cnNvci5jaCAtIDEgfSwgXHJcbiAgICAgICAgICAgICAgICBjdXJzb3JcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGlmICh0ZXh0QmVmb3JlID09PSAnPicpIHtcclxuICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKCdcXHUyMDJGXHUwMEJCJywgXHJcbiAgICAgICAgICAgICAgICAgICAgeyBsaW5lOiBjdXJzb3IubGluZSwgY2g6IGN1cnNvci5jaCAtIDEgfSwgXHJcbiAgICAgICAgICAgICAgICAgICAgY3Vyc29yXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgZWRpdG9yLnNldEN1cnNvcih7IGxpbmU6IGN1cnNvci5saW5lLCBjaDogY3Vyc29yLmNoIH0pO1xyXG4gICAgICAgICAgICAgICAgaGFuZGxlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LmtleSA9PT0gJzwnICYmIHRoaXMuc2V0dGluZ3MuZ3VpbGxlbWV0c0VuYWJsZWQpIHtcclxuICAgICAgICAgICAgY29uc3QgdGV4dEJlZm9yZSA9IGVkaXRvci5nZXRSYW5nZShcclxuICAgICAgICAgICAgICAgIHsgbGluZTogY3Vyc29yLmxpbmUsIGNoOiBjdXJzb3IuY2ggLSAxIH0sIFxyXG4gICAgICAgICAgICAgICAgY3Vyc29yXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBpZiAodGV4dEJlZm9yZSA9PT0gJzwnKSB7XHJcbiAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZSgnXHUwMEFCXFx1MjAyRicsIFxyXG4gICAgICAgICAgICAgICAgICAgIHsgbGluZTogY3Vyc29yLmxpbmUsIGNoOiBjdXJzb3IuY2ggLSAxIH0sIFxyXG4gICAgICAgICAgICAgICAgICAgIGN1cnNvclxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIGVkaXRvci5zZXRDdXJzb3IoeyBsaW5lOiBjdXJzb3IubGluZSwgY2g6IGN1cnNvci5jaCB9KTtcclxuICAgICAgICAgICAgICAgIGhhbmRsZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiBoYW5kbGVkO1xyXG4gICAgfVxyXG59IiwgIi8vIEZpY2hpZXIgdHlwb2dyYXBoeVJ1bGVzLnRzIGF2ZWMgdW5lIHNvbHV0aW9uIHNpbXBsZSBwb3VyIGwnaW1icmljYXRpb25cclxuXHJcbmltcG9ydCB7IE1pY3JvdHlwb2dyYXBoaWVTZXR0aW5ncyB9IGZyb20gXCIuLi9zZXR0aW5ncy9zZXR0aW5nc1wiO1xyXG5cclxuLyoqXHJcbiAqIEludGVyZmFjZSBwb3VyIHVuZSByXHUwMEU4Z2xlIHR5cG9ncmFwaGlxdWVcclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgVHlwb2dyYXBoaWNSdWxlIHtcclxuICByZWc6IFJlZ0V4cDtcclxuICByZXBsOiBzdHJpbmc7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBTdHJ1Y3R1cmUgcG91ciBsJ2Vuc2VtYmxlIGRlcyByXHUwMEU4Z2xlcyBjb21waWxcdTAwRTllc1xyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBDb21waWxlZFJ1bGVzIHtcclxuICBmcmVuY2hSdWxlczogVHlwb2dyYXBoaWNSdWxlW107IC8vIFJcdTAwRThnbGVzIHR5cG9ncmFwaGlxdWVzIGZyYW5cdTAwRTdhaXNlc1xyXG4gIGRhc2hSdWxlczogVHlwb2dyYXBoaWNSdWxlW107IC8vIFJcdTAwRThnbGVzIHBvdXIgbGVzIHRpcmV0c1xyXG59XHJcblxyXG4vLyBEXHUwMEU5ZmluaXIgbGVzIHJcdTAwRThnbGVzIHR5cG9ncmFwaGlxdWVzIGZyYW5cdTAwRTdhaXNlc1xyXG5jb25zdCBGUkVOQ0hfUlVMRVM6IFR5cG9ncmFwaGljUnVsZVtdID0gW1xyXG4gIC8vIFJcdTAwRThnbGVzIG9ydGhvZ3JhcGhpcXVlc1xyXG4gIHsgcmVnOiAvKFh8SXxWKVx1MDBFOG1lL2csIHJlcGw6IFwiJDFlXCIgfSxcclxuICB7IHJlZzogLyhYfEl8VillbWUvZywgcmVwbDogXCIkMWVcIiB9LFxyXG4gIHsgcmVnOiAvKFh8SXxWKVx1MDBFOW1lL2csIHJlcGw6IFwiJDFlXCIgfSxcclxuICB7IHJlZzogL29lL2csIHJlcGw6IFwiXHUwMTUzXCIgfSxcclxuICB7IHJlZzogL09FL2csIHJlcGw6IFwiXHUwMTUyXCIgfSxcclxuICB7IHJlZzogL09lL2csIHJlcGw6IFwiXHUwMTUyXCIgfSxcclxuICB7IHJlZzogL2FlL2csIHJlcGw6IFwiXHUwMEU2XCIgfSxcclxuICB7IHJlZzogL0FFL2csIHJlcGw6IFwiXHUwMEM2XCIgfSxcclxuICB7IHJlZzogL0FlL2csIHJlcGw6IFwiXHUwMEM2XCIgfSxcclxuXHJcbiAgLy8gcmVhbCBhcG9zdHJvcGhlXHJcbiAgeyByZWc6IC9cXCcvZywgcmVwbDogXCInXCIgfSxcclxuICAvLyByZWFsIHN1c3BlbnNpb24gcG9pbnRzXHJcbiAgeyByZWc6IC9cXC57Myx9L2csIHJlcGw6IFwiXFx1MjAyNlwiIH0sXHJcbiAgLy8gZGVsZXRlIGFsbCBzcGFjZXMgYWZ0ZXIgXHUwMEFCXHUyMDM5XCJbKFxyXG4gIHsgcmVnOiAvKFtcdTAwQUJcdTIwMzlcIlxcWyhdKVxccysvZywgcmVwbDogXCIkMVwiIH0sXHJcbiAgLy8gZGVsZXRlIGFsbCBzcGFjZXMgYmVmb3JlIHB1bmN0dWF0aW9uICE/OzpcdTAwQkJcdTIwM0FcIildLixcclxuICB7IHJlZzogL1xccysoWyE/OzpcdTAwQkJcdTIwM0FcIilcXF1cXC5cXCxdKS9nLCByZXBsOiBcIiQxXCIgfSxcclxuICAvLyBhZGQgbmFycm93IG5vIGJyZWFrIHNwYWNlIGJlZm9yZSAhPztcdTAwQkJcdTIwM0FcclxuICB7IHJlZzogLyhbIT87XHUwMEJCXHUyMDNBXSkvZywgcmVwbDogXCJcXHUyMDJGJDFcIiB9LFxyXG4gIC8vIGFkZCBubyBicmVhayBzcGFjZSBiZWZvcmUgOiAoY29ycmVjdGx5IGhhbmRsaW5nIGV4aXN0aW5nIHNwYWNlcywgYnV0IGF2b2lkaW5nIFVSTHMpXHJcbiAgeyByZWc6IC9cXHMrKDopKD8hXFwvXFwvKS9nLCByZXBsOiBcIlxcdTAwQTAkMVwiIH0sXHJcbiAgeyByZWc6IC8oW15cXHM6XFwvXSkoOikoPyFcXC9cXC8pL2csIHJlcGw6IFwiJDFcXHUwMEEwJDJcIiB9LFxyXG5cclxuICAvLyBhZGQgbmFycm93IG5vIGJyZWFrIHNwYWNlIGFmdGVyIFx1MDBBQlx1MjAzOVxyXG4gIHsgcmVnOiAvKFtcdTAwQUJcdTIwMzldKS9nLCByZXBsOiBcIiQxXFx1MjAyRlwiIH0sXHJcbiAgLy8gbm8gYnJlYWsgc3BhY2UgYWZ0ZXIgb25lIGxldHRlciB3b3Jkc1xyXG4gIHsgcmVnOiAvXFxzKyhbYS16XHUwMEUwXSlcXHMrL2dpLCByZXBsOiBcIiAkMVxcdTAwQTBcIiB9LFxyXG4gIC8vIG5vIGJyZWFrIHNwYWNlIGludG8gbmFtZXNcclxuICB7XHJcbiAgICByZWc6IC8oW0EtWlx1MDBDMC1cdTAwRDZcdTAwRDhcdTAxNTJdKShbQS1aYS16XHUwMEMwLVx1MDBENlx1MDBEOC1cdTAwRjZcdTAwRjgtXHUwMEZGXHUwMTUzXHUwMTUyXSspXFxzKyhbQS1aXHUwMEMwLVx1MDBENlx1MDBEOFx1MDE1Ml0pKFtBLVphLXpcdTAwQzAtXHUwMEQ2XHUwMEQ4LVx1MDBGNlx1MDBGOC1cdTAwRkZcdTAxNTNcdTAxNTJdKykvZyxcclxuICAgIHJlcGw6IFwiJDEkMlxcdTAwQTAkMyQ0XCIsXHJcbiAgfSxcclxuICAvLyBubyBicmVhayBzcGFjZSBhZnRlciBhYmJyZXZpYXRpb24gd2l0aCBwZXJpb2RcclxuICB7XHJcbiAgICByZWc6IC8oW0EtWlx1MDBDMC1cdTAwRDZcdTAwRDhcdTAxNTJdXFwuKVxccysoW0EtWlx1MDBDMC1cdTAwRDZcdTAwRDhcdTAxNTJdW0EtWmEtelx1MDBDMC1cdTAwRDZcdTAwRDgtXHUwMEY2XHUwMEY4LVx1MDBGRlx1MDE1M1x1MDE1Ml0rKS9nLFxyXG4gICAgcmVwbDogXCIkMVxcdTAwQTAkMlwiLFxyXG4gIH0sXHJcbiAgLy8gbm8gYnJlYWsgc3BhY2UgYmVmb3JlICdzaVx1MDBFOGNsZXMnXHJcbiAgeyByZWc6IC8oWHxJfFYpKGVyfGUpXFxzK3NpXHUwMEU4Y2xlL2csIHJlcGw6IFwiJDEkMlxcdTAwQTBzaVx1MDBFOGNsZVwiIH0sXHJcbiAgLy8gYWRkIHN1YlxyXG4gIHsgcmVnOiAvKFxcc3xeKShcXGQrfFtJVlhdKykoZXJ8ZXxcdTAwRThtZXxlbWUpKFxcc3wkKS9naSwgcmVwbDogXCIkMSQyPHN1cD4kMzwvc3VwPiQ0XCIgfSxcclxuICAvLyBUcmFuc2Zvcm1lciBsZXMgZ3VpbGxlbWV0cyBzaW1wbGVzIFx1MDBFMCBsJ2ludFx1MDBFOXJpZXVyIGRlIGd1aWxsZW1ldHMgZG91YmxlcyBlbiBndWlsbGVtZXRzIGFuZ2xhaXNcclxuICB7IHJlZzogLyhcdTAwQUJcXHUyMDJGW15cdTAwQkJdKiknKFteJ10qKScoW15cdTAwQkJdKlxcdTIwMkZcdTAwQkIpL2csIHJlcGw6ICckMVx1MjAxQyQyXHUyMDFEJDMnIH0sXHJcbiAgLy8gYWpvdXRlciBlc3BhY2UgYXByXHUwMEU4cyBndWlsbGVtZXQgZmVybWFudCBzdWl2aSBkJ3VuIG1vdFxyXG4gIHsgcmVnOiAvKFx1MDBCQikoW0EtWmEtelx1MDBDMC1cdTAwRDZcdTAwRDgtXHUwMEY2XHUwMEY4LVx1MDBGRlx1MDE1M1x1MDE1MjAtOV0pL2csIHJlcGw6IFwiJDEgJDJcIiB9LFxyXG4gIC8vIFRyYW5zZm9ybWVyIGxlcyBndWlsbGVtZXRzIHNpbXBsZXMgXHUwMEUwIGwnaW50XHUwMEU5cmlldXIgZGUgZ3VpbGxlbWV0cyBkb3VibGVzIGVuIGd1aWxsZW1ldHMgYW5nbGFpc1xyXG4gIHsgcmVnOiAvKFx1MDBBQlxcdTIwMkZbXlx1MDBCQl0qKVx1MDBBQlxcdTIwMkYoW15cdTAwQkJdKilcXHUyMDJGXHUwMEJCKFteXHUwMEJCXSpcXHUyMDJGXHUwMEJCKS9nLCByZXBsOiAnJDFcdTIwMUMkMlx1MjAxRCQzJyAgfSxcclxuXTtcclxuXHJcbi8vIFJcdTAwRThnbGVzIGRlIGJhc2UgcG91ciBsZXMgZXNwYWNlcyAobm9uIHNwXHUwMEU5Y2lmaXF1ZXMgYXUgZnJhblx1MDBFN2FpcylcclxuY29uc3QgQkFTRV9SVUxFUzogVHlwb2dyYXBoaWNSdWxlW10gPSBbXTtcclxuXHJcbi8qKlxyXG4gKiBDb21waWxlIGwnZW5zZW1ibGUgZGVzIHJcdTAwRThnbGVzIHR5cG9ncmFwaGlxdWVzIGVuIGZvbmN0aW9uIGRlcyBwYXJhbVx1MDBFOHRyZXNcclxuICogQHBhcmFtIHNldHRpbmdzIFBhcmFtXHUwMEU4dHJlcyBkdSBwbHVnaW5cclxuICogQHJldHVybnMgRW5zZW1ibGUgZGVzIHJcdTAwRThnbGVzIGNvbXBpbFx1MDBFOWVzXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gY29tcGlsZVJ1bGVzKFxyXG4gIHNldHRpbmdzOiBNaWNyb3R5cG9ncmFwaGllU2V0dGluZ3NcclxuKTogQ29tcGlsZWRSdWxlcyB7XHJcbiAgLy8gSW5pdGlhbGlzZXIgbGUgdGFibGVhdSBkZSByXHUwMEU4Z2xlc1xyXG4gIGxldCBmcmVuY2hSdWxlczogVHlwb2dyYXBoaWNSdWxlW10gPSBbXTtcclxuXHJcbiAgLy8gUlx1MDBFOGdsZXMgcG91ciBsZXMgZ3VpbGxlbWV0cyAtIFZFUlNJT04gU0lNUExJRklcdTAwQzlFXHJcbiAgZnJlbmNoUnVsZXMucHVzaChcclxuICAgIC8vIFJlbXBsYWNlciB0b3VzIGxlcyBndWlsbGVtZXRzIHBhciB1biBwbGFjZWhvbGRlciBVTklRVUVNRU5UXHJcbiAgICB7XHJcbiAgICAgIHJlZzogL1wiL2csXHJcbiAgICAgIHJlcGw6IFwiUVVPVEVfUExBQ0VIT0xERVJcIlxyXG4gICAgfVxyXG4gICAgLy8gUExVUyBkZSByXHUwMEU4Z2xlcyBkZSBzdXBwcmVzc2lvbiBkJ2VzcGFjZXMgcXVpIGNhc3NlbnQgbGEgZFx1MDBFOXRlY3Rpb24gIVxyXG4gICk7XHJcblxyXG4gIC8vIEFwb3N0cm9waGUgdHlwb2dyYXBoaXF1ZSBwZXJzb25uYWxpc2FibGVcclxuICBmcmVuY2hSdWxlcy5wdXNoKHsgcmVnOiAvXFwnL2csIHJlcGw6IHNldHRpbmdzLm9wZW5TaW5nbGVRdW90ZSB9KTtcclxuXHJcbiAgLy8gVHJhaXRlbWVudCBkZXMgcG9pbnRzIGRlIHN1c3BlbnNpb24gc2kgYWN0aXZcdTAwRTlcclxuICBpZiAoc2V0dGluZ3MuZWxsaXBzaXNFbmFibGVkKSB7XHJcbiAgICBmcmVuY2hSdWxlcy5wdXNoKHsgcmVnOiAvXFwuezMsfS9nLCByZXBsOiBcIlxcdTIwMjZcIiB9KTtcclxuICB9XHJcblxyXG4gIC8vIFJcdTAwRThnbGVzIHBvdXIgbGVzIGd1aWxsZW1ldHMgdmlhIGNoZXZyb25zIHNpIGFjdGl2XHUwMEU5c1xyXG4gIGlmIChzZXR0aW5ncy5ndWlsbGVtZXRzRW5hYmxlZCkge1xyXG4gICAgZnJlbmNoUnVsZXMucHVzaCh7IHJlZzogLzw8L2csIHJlcGw6IFwiXHUwMEFCXFx1MjAyRlwiIH0sIHsgcmVnOiAvPj4vZywgcmVwbDogXCJcXHUyMDJGXHUwMEJCXCIgfSk7XHJcbiAgfVxyXG5cclxuICAvLyBBam91dGVyIGxlcyByXHUwMEU4Z2xlcyBmcmFuXHUwMEU3YWlzZXMgc2kgYWN0aXZcdTAwRTllc1xyXG4gIGlmIChzZXR0aW5ncy5mcmVuY2hSdWxlc0VuYWJsZWQpIHtcclxuICAgIGZyZW5jaFJ1bGVzID0gWy4uLmZyZW5jaFJ1bGVzLCAuLi5GUkVOQ0hfUlVMRVNdO1xyXG4gICAgXHJcbiAgICAvLyBBam91dGVyIGxhIHJcdTAwRThnbGUgcG91ciBsZXMgZ3VpbGxlbWV0cyBhbmdsYWlzIGRhbnMgbGVzIGd1aWxsZW1ldHMgZnJhblx1MDBFN2Fpc1xyXG4gICAgZnJlbmNoUnVsZXMucHVzaCh7IFxyXG4gICAgICByZWc6IC8oXHUwMEFCXFx1MjAyRlteXHUwMEJCXSopXHUwMEFCXFx1MjAyRihbXlx1MDBCQl0qKVxcdTIwMkZcdTAwQkIoW15cdTAwQkJdKlxcdTIwMkZcdTAwQkIpL2csIFxyXG4gICAgICByZXBsOiAnJDFcIiQyXCIkMycgIFxyXG4gICAgfSk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGZyZW5jaFJ1bGVzID0gWy4uLmZyZW5jaFJ1bGVzLCAuLi5CQVNFX1JVTEVTXTtcclxuICB9XHJcblxyXG4gIC8vIENyXHUwMEU5ZXIgbGVzIHJcdTAwRThnbGVzIHBvdXIgbGVzIHRpcmV0cyBlbiBmb25jdGlvbiBkZXMgcGFyYW1cdTAwRTh0cmVzXHJcbiAgY29uc3QgZGFzaFJ1bGVzOiBUeXBvZ3JhcGhpY1J1bGVbXSA9IFtdO1xyXG5cclxuICBpZiAoc2V0dGluZ3MuZGFzaGVzRW5hYmxlZCkge1xyXG4gICAgaWYgKHNldHRpbmdzLnNraXBFbkRhc2gpIHtcclxuICAgICAgLy8gTW9kZSBkaXJlY3Q6IC0tIGRldmllbnQgZGlyZWN0ZW1lbnQgXHUyMDE0XHJcbiAgICAgIGRhc2hSdWxlcy5wdXNoKHsgcmVnOiAvLS0vZywgcmVwbDogXCJcdTIwMTRcIiB9KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIC8vIE1vZGUgcHJvZ3Jlc3NpZlxyXG4gICAgICBkYXNoUnVsZXMucHVzaChcclxuICAgICAgICB7IHJlZzogLy0tL2csIHJlcGw6IFwiXHUyMDEzXCIgfSwgLy8gLS0gZGV2aWVudCBcdTIwMTNcclxuICAgICAgICB7IHJlZzogL1x1MjAxMy0vZywgcmVwbDogXCJcdTIwMTRcIiB9LCAvLyBcdTIwMTMtIGRldmllbnQgXHUyMDE0XHJcbiAgICAgICAgeyByZWc6IC9cdTIwMTQtL2csIHJlcGw6IFwiLS0tXCIgfSAvLyBcdTIwMTQtIGRldmllbnQgLS0tXHJcbiAgICAgICk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICByZXR1cm4geyBmcmVuY2hSdWxlcywgZGFzaFJ1bGVzIH07XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBMT0dJUVVFIFNJTVBMSUZJXHUwMEM5RSA6IDQgZ3VpbGxlbWV0cyA9IGltYnJpY2F0aW9uLCBzYXVmIHNpIHNcdTAwRTlwYXJcdTAwRTlzIHBhciBmaW4gZGUgcGhyYXNlXHJcbiAqIFNpIGxlIHRleHRlIGNvbnRpbnVlIGFwclx1MDBFOHMgbGUgM2UgZ3VpbGxlbWV0IChzYW5zIG1hanVzY3VsZSkgPSBpbWJyaWNhdGlvblxyXG4gKi9cclxuZnVuY3Rpb24gcHJvY2Vzc1F1b3Rlcyh0ZXh0OiBzdHJpbmcsIG9wZW5RdW90ZTogc3RyaW5nLCBjbG9zZVF1b3RlOiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gIGxldCByZXN1bHQgPSB0ZXh0O1xyXG4gIFxyXG4gIC8vIENvbXB0ZXIgbGVzIGd1aWxsZW1ldHNcclxuICBjb25zdCB0b3RhbFF1b3RlcyA9IChyZXN1bHQubWF0Y2goL1FVT1RFX1BMQUNFSE9MREVSL2cpIHx8IFtdKS5sZW5ndGg7XHJcbiAgXHJcbiAgaWYgKHRvdGFsUXVvdGVzID09PSA0KSB7XHJcbiAgICAvLyBEaXZpc2VyIGxlIHRleHRlIGVuIHNlZ21lbnRzIHBhciBsZXMgZ3VpbGxlbWV0c1xyXG4gICAgY29uc3Qgc2VnbWVudHMgPSByZXN1bHQuc3BsaXQoJ1FVT1RFX1BMQUNFSE9MREVSJyk7XHJcbiAgICBcclxuICAgIGlmIChzZWdtZW50cy5sZW5ndGggPT09IDUpIHtcclxuICAgICAgY29uc3Qgc2VnbWVudDEgPSBzZWdtZW50c1sxXTsgLy8gQ29udGVudSBlbnRyZSAxZXIgZXQgMmUgZ3VpbGxlbWV0XHJcbiAgICAgIGNvbnN0IHNlZ21lbnQyID0gc2VnbWVudHNbMl07IC8vIENvbnRlbnUgZW50cmUgMmUgZXQgM2UgZ3VpbGxlbWV0IChwb3RlbnRpZWxsZW1lbnQgaW1icmlxdVx1MDBFOSlcclxuICAgICAgY29uc3Qgc2VnbWVudDMgPSBzZWdtZW50c1szXTsgLy8gQ29udGVudSBlbnRyZSAzZSBldCA0ZSBndWlsbGVtZXRcclxuICAgICAgXHJcbiAgICAgIC8vIGNvbnNvbGUubG9nKGBcdUQ4M0RcdUREMEQgQW5hbHlzZSBkZXMgc2VnbWVudHM6YCk7XHJcbiAgICAgIC8vIGNvbnNvbGUubG9nKGAgIFNlZ21lbnQgMTogXCIke3NlZ21lbnQxfVwiYCk7XHJcbiAgICAgIC8vIGNvbnNvbGUubG9nKGAgIFNlZ21lbnQgMjogXCIke3NlZ21lbnQyfVwiYCk7XHJcbiAgICAgIC8vIGNvbnNvbGUubG9nKGAgIFNlZ21lbnQgMzogXCIke3NlZ21lbnQzfVwiYCk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBMT0dJUVVFIFNJTVBMRSA6IHNpIHNlZ21lbnQzIGNvbW1lbmNlIHBhciBtaW51c2N1bGUgb3UgZXNwYWNlK21pbnVzY3VsZSA9IGNvbnRpbnVhdGlvbiA9IGltYnJpY2F0aW9uXHJcbiAgICAgIGNvbnN0IHNlZ21lbnQzU3RhcnRzV2l0aExvd2VyY2FzZSA9IC9eXFxzKlthLXpcdTAwRTAtXHUwMEZGXS8udGVzdChzZWdtZW50Myk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBPVSBzaSBzZWdtZW50MiBlc3QgcmVsYXRpdmVtZW50IGNvdXJ0ICg8IDUwIGNhcmFjdFx1MDBFOHJlcykgRVQgc2VnbWVudDMgbidlc3QgcGFzIHZpZGVcclxuICAgICAgY29uc3Qgc2VnbWVudDJJc1Nob3J0ID0gc2VnbWVudDIubGVuZ3RoIDwgNTA7XHJcbiAgICAgIGNvbnN0IHNlZ21lbnQzTm90RW1wdHkgPSBzZWdtZW50My50cmltKCkubGVuZ3RoID4gMDtcclxuICAgICAgXHJcbiAgICAgIGlmICgoc2VnbWVudDNTdGFydHNXaXRoTG93ZXJjYXNlICYmIHNlZ21lbnQzTm90RW1wdHkpIHx8IFxyXG4gICAgICAgICAgKHNlZ21lbnQySXNTaG9ydCAmJiBzZWdtZW50M05vdEVtcHR5ICYmIHNlZ21lbnQzU3RhcnRzV2l0aExvd2VyY2FzZSkpIHtcclxuICAgICAgICBcclxuICAgICAgICAvLyBjb25zb2xlLmxvZyhgXHUyNzA1IEltYnJpY2F0aW9uIGRcdTAwRTl0ZWN0XHUwMEU5ZWApO1xyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKGAgIHNlZ21lbnQzU3RhcnRzV2l0aExvd2VyY2FzZTogJHtzZWdtZW50M1N0YXJ0c1dpdGhMb3dlcmNhc2V9YCk7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2coYCAgc2VnbWVudDJJc1Nob3J0OiAke3NlZ21lbnQySXNTaG9ydH1gKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBJbWJyaWNhdGlvbiA6IGZyYW5cdTAwRTdhaXMgXHUwMEUwIGwnZXh0XHUwMEU5cmlldXIsIGFuZ2xhaXMgXHUwMEUwIGwnaW50XHUwMEU5cmlldXJcclxuICAgICAgICBsZXQgdGVtcFJlc3VsdCA9IHJlc3VsdDtcclxuICAgICAgICB0ZW1wUmVzdWx0ID0gdGVtcFJlc3VsdC5yZXBsYWNlKC9RVU9URV9QTEFDRUhPTERFUi8sIG9wZW5RdW90ZSk7ICAgICAvLyAxZXIgOiBcdTAwQUJcclxuICAgICAgICB0ZW1wUmVzdWx0ID0gdGVtcFJlc3VsdC5yZXBsYWNlKC9RVU9URV9QTEFDRUhPTERFUi8sICdcdTIwMUMnKTsgICAgICAgICAgIC8vIDJlIDogXCJcclxuICAgICAgICB0ZW1wUmVzdWx0ID0gdGVtcFJlc3VsdC5yZXBsYWNlKC9RVU9URV9QTEFDRUhPTERFUi8sICdcdTIwMUQnKTsgICAgICAgICAgIC8vIDNlIDogXCJcclxuICAgICAgICB0ZW1wUmVzdWx0ID0gdGVtcFJlc3VsdC5yZXBsYWNlKC9RVU9URV9QTEFDRUhPTERFUi8sIGNsb3NlUXVvdGUpOyAgICAvLyA0ZSA6IFx1MDBCQlxyXG4gICAgICAgIHJldHVybiB0ZW1wUmVzdWx0O1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKGBcdTI3NEMgUGFzIGQnaW1icmljYXRpb24gZFx1MDBFOXRlY3RcdTAwRTllYCk7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2coYCAgc2VnbWVudDNTdGFydHNXaXRoTG93ZXJjYXNlOiAke3NlZ21lbnQzU3RhcnRzV2l0aExvd2VyY2FzZX1gKTtcclxuICAgICAgICAvLyBjb25zb2xlLmxvZyhgICBzZWdtZW50MklzU2hvcnQ6ICR7c2VnbWVudDJJc1Nob3J0fWApO1xyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKGAgIHNlZ21lbnQzTm90RW1wdHk6ICR7c2VnbWVudDNOb3RFbXB0eX1gKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuICBcclxuICAvLyBDYXMgc3RhbmRhcmQgOiBhbHRlcm5hbmNlIHNpbXBsZSAob3V2cmFudC9mZXJtYW50KVxyXG4gIGNvbnNvbGUubG9nKGBcdUQ4M0RcdUREMDQgQWx0ZXJuYW5jZSBzaW1wbGUgcG91ciAke3RvdGFsUXVvdGVzfSBndWlsbGVtZXRzYCk7XHJcbiAgbGV0IHF1b3RlSW5kZXggPSAwO1xyXG4gIHJlc3VsdCA9IHJlc3VsdC5yZXBsYWNlKC9RVU9URV9QTEFDRUhPTERFUi9nLCAoKSA9PiB7XHJcbiAgICBjb25zdCBpc09wZW5pbmcgPSAocXVvdGVJbmRleCAlIDIgPT09IDApO1xyXG4gICAgcXVvdGVJbmRleCsrO1xyXG4gICAgcmV0dXJuIGlzT3BlbmluZyA/IG9wZW5RdW90ZSA6IGNsb3NlUXVvdGU7XHJcbiAgfSk7XHJcbiAgXHJcbiAgcmV0dXJuIHJlc3VsdDtcclxufVxyXG5cclxuLyoqXHJcbiAqIEFwcGxpcXVlIHVuZSBzXHUwMEU5cmllIGRlIHJcdTAwRThnbGVzIHR5cG9ncmFwaGlxdWVzIFx1MDBFMCB1biB0ZXh0ZVxyXG4gKiBAcGFyYW0gdGV4dCBUZXh0ZSBkJ2VudHJcdTAwRTllXHJcbiAqIEBwYXJhbSBydWxlcyBSXHUwMEU4Z2xlcyBcdTAwRTAgYXBwbGlxdWVyXHJcbiAqIEBwYXJhbSBzZXR0aW5ncyBQYXJhbVx1MDBFOHRyZXMgcG91ciBsZSB0cmFpdGVtZW50IGRlcyBndWlsbGVtZXRzXHJcbiAqIEByZXR1cm5zIFRleHRlIHRyYW5zZm9ybVx1MDBFOVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGFwcGx5UnVsZXModGV4dDogc3RyaW5nLCBydWxlczogVHlwb2dyYXBoaWNSdWxlW10sIHNldHRpbmdzPzogTWljcm90eXBvZ3JhcGhpZVNldHRpbmdzKTogc3RyaW5nIHtcclxuICBsZXQgcmVzdWx0ID0gdGV4dDtcclxuICBmb3IgKGNvbnN0IHJ1bGUgb2YgcnVsZXMpIHtcclxuICAgIGNvbnN0IGJlZm9yZSA9IHJlc3VsdDtcclxuICAgIHJlc3VsdCA9IHJlc3VsdC5yZXBsYWNlKHJ1bGUucmVnLCBydWxlLnJlcGwpO1xyXG4gICAgaWYgKGJlZm9yZSAhPT0gcmVzdWx0KSB7XHJcbiAgICAgIC8vIGNvbnNvbGUubG9nKFwiXHVEODNEXHVERDA0IFJcdTAwRThnbGUgYXBwbGlxdVx1MDBFOWU6XCIpO1xyXG4gICAgICAvLyBjb25zb2xlLmxvZyhcIiAgIFJlZ2V4OlwiLCBydWxlLnJlZyk7XHJcbiAgICAgIC8vIGNvbnNvbGUubG9nKFwiICAgQXZhbnQ6XCIsIGJlZm9yZSk7XHJcbiAgICAgIC8vIGNvbnNvbGUubG9nKFwiICAgQXByXHUwMEU4czpcIiwgcmVzdWx0KTtcclxuICAgICAgLy8gY29uc29sZS5sb2coXCItLS1cIik7XHJcbiAgICB9XHJcbiAgfVxyXG4gIFxyXG4gIC8vIFRyYWl0ZW1lbnQgc3BcdTAwRTljaWFsIGRlcyBndWlsbGVtZXRzIHNpIGRlcyBwYXJhbVx1MDBFOHRyZXMgc29udCBmb3VybmlzXHJcbiAgaWYgKHNldHRpbmdzICYmIHJlc3VsdC5pbmNsdWRlcyhcIlFVT1RFX1BMQUNFSE9MREVSXCIpKSB7XHJcbiAgICAvLyBjb25zb2xlLmxvZyhcIlx1RDgzRFx1REQwNCBUcmFpdGVtZW50IGRlcyBndWlsbGVtZXRzIHBhciBhbHRlcm5hbmNlXCIpO1xyXG4gICAgLy8gY29uc29sZS5sb2coXCIgICBBdmFudDpcIiwgcmVzdWx0KTtcclxuICAgIHJlc3VsdCA9IHByb2Nlc3NRdW90ZXMocmVzdWx0LCBzZXR0aW5ncy5vcGVuRG91YmxlUXVvdGUsIHNldHRpbmdzLmNsb3NlRG91YmxlUXVvdGUpO1xyXG4gICAgLy8gY29uc29sZS5sb2coXCIgICBBcHJcdTAwRThzOlwiLCByZXN1bHQpO1xyXG4gICAgLy8gY29uc29sZS5sb2coXCItLS1cIik7XHJcbiAgfVxyXG4gIFxyXG4gIHJldHVybiByZXN1bHQ7XHJcbn0iLCAiLy8gUHJvY2Vzc2V1ciBkZSB0ZXh0ZSBtaXMgXHUwMEUwIGpvdXIgcG91ciBsYSBub3V2ZWxsZSBzdHJ1Y3R1cmVcclxuXHJcbmltcG9ydCB7IENvbXBpbGVkUnVsZXMsIGFwcGx5UnVsZXMgfSBmcm9tICcuL3R5cG9ncmFwaHlSdWxlcyc7XHJcbmltcG9ydCB7IE1pY3JvdHlwb2dyYXBoaWVTZXR0aW5ncyB9IGZyb20gJy4uL3NldHRpbmdzL3NldHRpbmdzJztcclxuXHJcbi8qKlxyXG4gKiBBcHBsaXF1ZSB0b3V0ZXMgbGVzIGNhdFx1MDBFOWdvcmllcyBkZSByXHUwMEU4Z2xlcyBcdTAwRTAgdW4gdGV4dGVcclxuICogQHBhcmFtIHRleHQgVGV4dGUgZCdlbnRyXHUwMEU5ZVxyXG4gKiBAcGFyYW0gcnVsZXMgRW5zZW1ibGUgZGVzIHJcdTAwRThnbGVzIGNvbXBpbFx1MDBFOWVzXHJcbiAqIEBwYXJhbSBzZXR0aW5ncyBQYXJhbVx1MDBFOHRyZXMgcG91ciBsZSB0cmFpdGVtZW50IGRlcyBndWlsbGVtZXRzXHJcbiAqIEByZXR1cm5zIFRleHRlIHRyYW5zZm9ybVx1MDBFOVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGFwcGx5QWxsUnVsZXModGV4dDogc3RyaW5nLCBydWxlczogQ29tcGlsZWRSdWxlcywgc2V0dGluZ3M6IE1pY3JvdHlwb2dyYXBoaWVTZXR0aW5ncyk6IHN0cmluZyB7XHJcbiAgICBsZXQgcmVzdWx0ID0gdGV4dDtcclxuICAgIFxyXG4gICAgLy8gVGFibGVhdSBwb3VyIHN0b2NrZXIgbGVzIFx1MDBFOWxcdTAwRTltZW50cyBcdTAwRTAgcHJcdTAwRTlzZXJ2ZXJcclxuICAgIGNvbnN0IHByZXNlcnZlZEVsZW1lbnRzOiBzdHJpbmdbXSA9IFtdO1xyXG4gICAgXHJcbiAgICAvLyBMaXN0ZSBkZXMgcGF0dGVybnMgXHUwMEUwIHByXHUwMEU5c2VydmVyXHJcbiAgICBjb25zdCBwYXR0ZXJucyA9IFtcclxuICAgICAgICAvXFxbXFxbLio/XFxdXFxdL2csICAgICAgICAgICAvLyBMaWVucyBPYnNpZGlhbiBbW2xpZW5dXVxyXG4gICAgICAgIC9cXFsuKj9cXF1cXCguKj9cXCkvZywgICAgICAgIC8vIExpZW5zIE1hcmtkb3duIFt0ZXh0ZV0odXJsKVxyXG4gICAgICAgIC8hXFxbLio/XFxdXFwoLio/XFwpL2csICAgICAgIC8vIEltYWdlcyAhW2FsdF0odXJsKVxyXG4gICAgICAgIC9gW15gXStgL2csICAgICAgICAgICAgICAgLy8gQ29kZSBpbmxpbmUgYGNvZGVgXHJcbiAgICAgICAgL2BgYFtcXHNcXFNdKj9gYGAvZywgICAgICAgIC8vIEJsb2NzIGRlIGNvZGVcclxuICAgICAgICAvPlxccy4qJC9nbSwgICAgICAgICAgICAgICAvLyBDYWxsb3V0cyAobGlnbmVzIGNvbW1lblx1MDBFN2FudCBwYXIgXCI+IFwiKVxyXG4gICAgICAgIC88W14+XSo+L2csICAgICAgICAgICAgICAgLy8gQmFsaXNlcyBIVE1MXHJcbiAgICAgICAgL1xcJFxcJFteJF0qXFwkXFwkL2csICAgICAgICAgLy8gXHUwMEM5cXVhdGlvbnMgbWF0aFx1MDBFOW1hdGlxdWVzICQkZXF1YXRpb24kJFxyXG4gICAgICAgIC9cXCRbXiRdKlxcJC9nLCAgICAgICAgICAgICAvLyBcdTAwQzlxdWF0aW9ucyBtYXRoXHUwMEU5bWF0aXF1ZXMgaW5saW5lICRlcXVhdGlvbiRcclxuICAgICAgICAvXFx7W159XSpcXH0vZywgICAgICAgICAgICAgLy8gQ29udGVudSBlbnRyZSBhY2NvbGFkZXMge2NvbnRlbnV9XHJcbiAgICAgICAgL2h0dHBzPzpcXC9cXC9bXlxcc10rL2csICAgICAvLyBVUkxzIGF2ZWMgaHR0cDogb3UgaHR0cHM6XHJcbiAgICAgICAgL1thLXpdKzpcXC9cXC9bXlxcc10rL2csICAgICAvLyBBdXRyZXMgcHJvdG9jb2xlcyAoZnRwOiwgZmlsZTosIGV0Yy4pXHJcbiAgICAgICAgL1thLXpBLVowLTlfListXStAW2EtekEtWjAtOS1dK1xcLlthLXpBLVowLTktLl0rL2csIC8vIEFkcmVzc2VzIGVtYWlsXHJcbiAgICBdO1xyXG4gICAgXHJcbiAgICAvLyBFeHRyYWlyZSBldCByZW1wbGFjZXIgbGVzIFx1MDBFOWxcdTAwRTltZW50cyBcdTAwRTAgcHJcdTAwRTlzZXJ2ZXJcclxuICAgIGxldCB0ZW1wVGV4dCA9IHJlc3VsdDtcclxuICAgIGxldCBlbGVtZW50SW5kZXggPSAwO1xyXG4gICAgXHJcbiAgICAvLyBQb3VyIGNoYXF1ZSBwYXR0ZXJuXHJcbiAgICBmb3IgKGNvbnN0IHBhdHRlcm4gb2YgcGF0dGVybnMpIHtcclxuICAgICAgICBsZXQgbWF0Y2g7XHJcbiAgICAgICAgLy8gVXRpbGlzZXIgdW5lIGNoYVx1MDBFRW5lIHRlbXBvcmFpcmUgcG91ciBcdTAwRTl2aXRlciBsZXMgcHJvYmxcdTAwRThtZXMgZGUgcmVtcGxhY2VtZW50XHJcbiAgICAgICAgbGV0IHNlYXJjaFRleHQgPSB0ZW1wVGV4dDtcclxuICAgICAgICBsZXQgcmVwbGFjZWRUZXh0ID0gdGVtcFRleHQ7XHJcbiAgICAgICAgXHJcbiAgICAgICAgd2hpbGUgKChtYXRjaCA9IHBhdHRlcm4uZXhlYyhzZWFyY2hUZXh0KSkgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgY29uc3QgcGxhY2Vob2xkZXIgPSBgX19QUkVTRVJWRURfRUxFTUVOVF8ke2VsZW1lbnRJbmRleH1fX2A7XHJcbiAgICAgICAgICAgIHByZXNlcnZlZEVsZW1lbnRzLnB1c2gobWF0Y2hbMF0pO1xyXG4gICAgICAgICAgICAvLyBSZW1wbGFjZXIgdW5pcXVlbWVudCBsYSBwcmVtaVx1MDBFOHJlIG9jY3VycmVuY2VcclxuICAgICAgICAgICAgcmVwbGFjZWRUZXh0ID0gcmVwbGFjZWRUZXh0LnJlcGxhY2UobWF0Y2hbMF0sIHBsYWNlaG9sZGVyKTtcclxuICAgICAgICAgICAgZWxlbWVudEluZGV4Kys7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIHRlbXBUZXh0ID0gcmVwbGFjZWRUZXh0O1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBjb25zb2xlLmxvZyhcIlx1RDgzRFx1REZFNiBBVkFOVCByXHUwMEU4Z2xlcyBmcmFuXHUwMEU3YWlzZXM6XCIsIHRlbXBUZXh0KTtcclxuICAgIFxyXG4gICAgLy8gQXBwbGlxdWVyIGxlcyByXHUwMEU4Z2xlcyB0eXBvZ3JhcGhpcXVlcyBmcmFuXHUwMEU3YWlzZXMgYXZlYyBsZXMgcGFyYW1cdTAwRTh0cmVzXHJcbiAgICB0ZW1wVGV4dCA9IGFwcGx5UnVsZXModGVtcFRleHQsIHJ1bGVzLmZyZW5jaFJ1bGVzLCBzZXR0aW5ncyk7XHJcbiAgICBcclxuICAgIC8vIGNvbnNvbGUubG9nKFwiXHVEODNEXHVERkU4IEFQUlx1MDBDOFMgclx1MDBFOGdsZXMgZnJhblx1MDBFN2Fpc2VzOlwiLCB0ZW1wVGV4dCk7XHJcbiAgICBcclxuICAgIC8vIEFwcGxpcXVlciBsZXMgclx1MDBFOGdsZXMgZGUgdGlyZXRzXHJcbiAgICB0ZW1wVGV4dCA9IGFwcGx5UnVsZXModGVtcFRleHQsIHJ1bGVzLmRhc2hSdWxlcyk7XHJcbiAgICBcclxuICAgIC8vIGNvbnNvbGUubG9nKFwiXHVEODNEXHVERkU5IEFQUlx1MDBDOFMgclx1MDBFOGdsZXMgdGlyZXRzOlwiLCB0ZW1wVGV4dCk7XHJcbiAgICBcclxuICAgIC8vIFJcdTAwRTlpbnRcdTAwRTlncmVyIGxlcyBcdTAwRTlsXHUwMEU5bWVudHMgcHJcdTAwRTlzZXJ2XHUwMEU5c1xyXG4gICAgcmVzdWx0ID0gdGVtcFRleHQ7XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHByZXNlcnZlZEVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgY29uc3QgcGxhY2Vob2xkZXIgPSBgX19QUkVTRVJWRURfRUxFTUVOVF8ke2l9X19gO1xyXG4gICAgICAgIHJlc3VsdCA9IHJlc3VsdC5yZXBsYWNlKHBsYWNlaG9sZGVyLCBwcmVzZXJ2ZWRFbGVtZW50c1tpXSk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIGNvbnNvbGUubG9nKFwiXHVEODNEXHVERkVBIFJcdTAwQzlTVUxUQVQgRklOQUw6XCIsIHJlc3VsdCk7XHJcbiAgICBcclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBUcmFpdGUgdW4gdGV4dGUgZW4gcmVzcGVjdGFudCBsZXMgYmxvY3Mgc3BcdTAwRTljaWF1eCAoY29kZSwgZnJvbnRtYXR0ZXIpXHJcbiAqIEBwYXJhbSB0ZXh0IFRleHRlIFx1MDBFMCB0cmFpdGVyXHJcbiAqIEBwYXJhbSBibG9ja3MgVHlwZXMgZGUgYmxvY3MgcG91ciBjaGFxdWUgbGlnbmVcclxuICogQHBhcmFtIHJ1bGVzIFJcdTAwRThnbGVzIGNvbXBpbFx1MDBFOWVzXHJcbiAqIEBwYXJhbSBzZXR0aW5ncyBQYXJhbVx1MDBFOHRyZXMgcG91ciBsZSB0cmFpdGVtZW50IGRlcyBndWlsbGVtZXRzXHJcbiAqIEByZXR1cm5zIFRleHRlIHRyYW5zZm9ybVx1MDBFOVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHByb2Nlc3NUZXh0V2l0aEJsb2Nrcyh0ZXh0OiBzdHJpbmcsIGJsb2Nrczogc3RyaW5nW10sIHJ1bGVzOiBDb21waWxlZFJ1bGVzLCBzZXR0aW5nczogTWljcm90eXBvZ3JhcGhpZVNldHRpbmdzKTogc3RyaW5nIHtcclxuICAgIGNvbnN0IGxpbmVzID0gdGV4dC5zcGxpdCgnXFxuJyk7XHJcbiAgICBjb25zdCBwcm9jZXNzZWRMaW5lcyA9IFtdO1xyXG4gICAgXHJcbiAgICAvLyBSZWdyb3VwZXIgbGVzIGxpZ25lcyBub3JtYWxlcyBjb25zXHUwMEU5Y3V0aXZlcyBwb3VyIHVuIHRyYWl0ZW1lbnQgcGx1cyBlZmZpY2FjZVxyXG4gICAgbGV0IG5vcm1hbFRleHRCdWZmZXIgPSBbXTtcclxuICAgIGxldCBsYXN0QmxvY2tUeXBlID0gJyc7XHJcbiAgICBcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGluZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBjb25zdCBjdXJyZW50QmxvY2tUeXBlID0gYmxvY2tzW2ldO1xyXG4gICAgICAgIGNvbnN0IGxpbmUgPSBsaW5lc1tpXTtcclxuICAgICAgICBcclxuICAgICAgICBpZiAoY3VycmVudEJsb2NrVHlwZSA9PT0gJ25vcm1hbCcpIHtcclxuICAgICAgICAgICAgLy8gQWpvdXRlciBhdSBidWZmZXIgcG91ciB0cmFpdGVtZW50IGdyb3VwXHUwMEU5XHJcbiAgICAgICAgICAgIG5vcm1hbFRleHRCdWZmZXIucHVzaChsaW5lKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBUcmFpdGVyIGxlIGJ1ZmZlciBhY2N1bXVsXHUwMEU5IHNpIG5cdTAwRTljZXNzYWlyZVxyXG4gICAgICAgICAgICBpZiAobm9ybWFsVGV4dEJ1ZmZlci5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBwcm9jZXNzZWRCdWZmZXIgPSBhcHBseUFsbFJ1bGVzKG5vcm1hbFRleHRCdWZmZXIuam9pbignXFxuJyksIHJ1bGVzLCBzZXR0aW5ncyk7XHJcbiAgICAgICAgICAgICAgICBwcm9jZXNzZWRMaW5lcy5wdXNoKC4uLnByb2Nlc3NlZEJ1ZmZlci5zcGxpdCgnXFxuJykpO1xyXG4gICAgICAgICAgICAgICAgbm9ybWFsVGV4dEJ1ZmZlciA9IFtdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBBam91dGVyIGxhIGxpZ25lIHNwXHUwMEU5Y2lhbGUgc2FucyBtb2RpZmljYXRpb25cclxuICAgICAgICAgICAgcHJvY2Vzc2VkTGluZXMucHVzaChsaW5lKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgbGFzdEJsb2NrVHlwZSA9IGN1cnJlbnRCbG9ja1R5cGU7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIFRyYWl0ZXIgdG91dCB0ZXh0ZSBub3JtYWwgcmVzdGFudCBkYW5zIGxlIGJ1ZmZlclxyXG4gICAgaWYgKG5vcm1hbFRleHRCdWZmZXIubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIGNvbnN0IHByb2Nlc3NlZEJ1ZmZlciA9IGFwcGx5QWxsUnVsZXMobm9ybWFsVGV4dEJ1ZmZlci5qb2luKCdcXG4nKSwgcnVsZXMsIHNldHRpbmdzKTtcclxuICAgICAgICBwcm9jZXNzZWRMaW5lcy5wdXNoKC4uLnByb2Nlc3NlZEJ1ZmZlci5zcGxpdCgnXFxuJykpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gcHJvY2Vzc2VkTGluZXMuam9pbignXFxuJyk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBWZXJzaW9uIG9wdGltaXNcdTAwRTllIHBvdXIgbGUgdHJhaXRlbWVudCBhc3luY2hyb25lIGRlIGdyYW5kcyBkb2N1bWVudHNcclxuICogQHBhcmFtIHRleHQgVGV4dGUgXHUwMEUwIHRyYWl0ZXJcclxuICogQHBhcmFtIGJsb2NrcyBUeXBlcyBkZSBibG9jcyBwb3VyIGNoYXF1ZSBsaWduZVxyXG4gKiBAcGFyYW0gcnVsZXMgUlx1MDBFOGdsZXMgY29tcGlsXHUwMEU5ZXNcclxuICogQHBhcmFtIHNldHRpbmdzIFBhcmFtXHUwMEU4dHJlcyBwb3VyIGxlIHRyYWl0ZW1lbnQgZGVzIGd1aWxsZW1ldHNcclxuICogQHBhcmFtIGNhbGxiYWNrIEZvbmN0aW9uIGRlIGNhbGxiYWNrIGFwcGVsXHUwMEU5ZSBhdmVjIGxlIHJcdTAwRTlzdWx0YXRcclxuICogQHBhcmFtIGJhdGNoU2l6ZSBUYWlsbGUgZGVzIGxvdHMgZGUgbGlnbmVzIFx1MDBFMCB0cmFpdGVyXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcHJvY2Vzc0xhcmdlRG9jdW1lbnQoXHJcbiAgICB0ZXh0OiBzdHJpbmcsIFxyXG4gICAgYmxvY2tzOiBzdHJpbmdbXSwgXHJcbiAgICBydWxlczogQ29tcGlsZWRSdWxlcyxcclxuICAgIHNldHRpbmdzOiBNaWNyb3R5cG9ncmFwaGllU2V0dGluZ3MsXHJcbiAgICBjYWxsYmFjazogKHJlc3VsdDogc3RyaW5nKSA9PiB2b2lkLFxyXG4gICAgYmF0Y2hTaXplOiBudW1iZXIgPSA1MDBcclxuKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICBjb25zdCBsaW5lcyA9IHRleHQuc3BsaXQoJ1xcbicpO1xyXG4gICAgY29uc3QgcHJvY2Vzc2VkTGluZXM6IHN0cmluZ1tdID0gW107XHJcbiAgICBcclxuICAgIC8vIFRyYWl0ZXIgcGFyIGxvdHMgcG91ciBcdTAwRTl2aXRlciBkZSBibG9xdWVyIGwnaW50ZXJmYWNlXHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IE1hdGguY2VpbChsaW5lcy5sZW5ndGggLyBiYXRjaFNpemUpOyBpKyspIHtcclxuICAgICAgICBjb25zdCBzdGFydElkeCA9IGkgKiBiYXRjaFNpemU7XHJcbiAgICAgICAgY29uc3QgZW5kSWR4ID0gTWF0aC5taW4oKGkgKyAxKSAqIGJhdGNoU2l6ZSwgbGluZXMubGVuZ3RoKTtcclxuICAgICAgICBjb25zdCBiYXRjaExpbmVzID0gbGluZXMuc2xpY2Uoc3RhcnRJZHgsIGVuZElkeCk7XHJcbiAgICAgICAgY29uc3QgYmF0Y2hCbG9ja3MgPSBibG9ja3Muc2xpY2Uoc3RhcnRJZHgsIGVuZElkeCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gVHJhaXRlciBjZSBsb3QgZGUgbGlnbmVzXHJcbiAgICAgICAgY29uc3QgYmF0Y2hUZXh0ID0gYmF0Y2hMaW5lcy5qb2luKCdcXG4nKTtcclxuICAgICAgICBjb25zdCBwcm9jZXNzZWRCYXRjaCA9IHByb2Nlc3NUZXh0V2l0aEJsb2NrcyhiYXRjaFRleHQsIGJhdGNoQmxvY2tzLCBydWxlcywgc2V0dGluZ3MpO1xyXG4gICAgICAgIHByb2Nlc3NlZExpbmVzLnB1c2goLi4ucHJvY2Vzc2VkQmF0Y2guc3BsaXQoJ1xcbicpKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBMYWlzc2VyIHJlc3BpcmVyIGwnaW50ZXJmYWNlIHV0aWxpc2F0ZXVyXHJcbiAgICAgICAgaWYgKGkgPCBNYXRoLmNlaWwobGluZXMubGVuZ3RoIC8gYmF0Y2hTaXplKSAtIDEpIHtcclxuICAgICAgICAgICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDApKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIEFwcGVsZXIgbGUgY2FsbGJhY2sgYXZlYyBsZSByXHUwMEU5c3VsdGF0XHJcbiAgICBjYWxsYmFjayhwcm9jZXNzZWRMaW5lcy5qb2luKCdcXG4nKSk7XHJcbn0iLCAiLy8gTW9kdWxlIGRlIHRyYWl0ZW1lbnQgcGFyIGxvdCBtaXMgXHUwMEUwIGpvdXJcclxuXHJcbmltcG9ydCB7IEVkaXRvciB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5pbXBvcnQgeyBNaWNyb3R5cG9ncmFwaGllU2V0dGluZ3MgfSBmcm9tICcuLi9zZXR0aW5ncy9zZXR0aW5ncyc7XHJcbmltcG9ydCB7IGNvbXBpbGVSdWxlcyB9IGZyb20gJy4uL2NvcmUvdHlwb2dyYXBoeVJ1bGVzJztcclxuaW1wb3J0IHsgYW5hbHl6ZURvY3VtZW50U3RydWN0dXJlIH0gZnJvbSAnLi4vY29yZS9ibG9ja0FuYWx5emVyJztcclxuaW1wb3J0IHsgcHJvY2Vzc1RleHRXaXRoQmxvY2tzLCBwcm9jZXNzTGFyZ2VEb2N1bWVudCB9IGZyb20gJy4uL2NvcmUvdGV4dFByb2Nlc3Nvcic7XHJcblxyXG5leHBvcnQgY2xhc3MgQmF0Y2hUeXBvZ3JhcGh5TW9kdWxlIHtcclxuICAgIHByaXZhdGUgc2V0dGluZ3M6IE1pY3JvdHlwb2dyYXBoaWVTZXR0aW5ncztcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihzZXR0aW5nczogTWljcm90eXBvZ3JhcGhpZVNldHRpbmdzKSB7XHJcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IHNldHRpbmdzO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogSW5pdGlhbGlzZSBsZSBtb2R1bGUgYXZlYyBsZXMgcGFyYW1cdTAwRTh0cmVzIGFjdHVlbHNcclxuICAgICAqIEBwYXJhbSBzZXR0aW5ncyBQYXJhbVx1MDBFOHRyZXMgbWlzIFx1MDBFMCBqb3VyXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyB1cGRhdGVTZXR0aW5ncyhzZXR0aW5nczogTWljcm90eXBvZ3JhcGhpZVNldHRpbmdzKSB7XHJcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IHNldHRpbmdzO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQXBwbGlxdWUgdG91dGVzIGxlcyByXHUwMEU4Z2xlcyB0eXBvZ3JhcGhpcXVlcyBzdXIgdW4gdGV4dGUgc1x1MDBFOWxlY3Rpb25uXHUwMEU5XHJcbiAgICAgKiBAcGFyYW0gZWRpdG9yIFx1MDBDOWRpdGV1ciBPYnNpZGlhblxyXG4gICAgICogQHJldHVybnMgdHJ1ZSBzaSBkZXMgbW9kaWZpY2F0aW9ucyBvbnQgXHUwMEU5dFx1MDBFOSBhcHBsaXF1XHUwMEU5ZXNcclxuICAgICAqL1xyXG4gICAgcHVibGljIGFwcGx5VHlwb2dyYXBoaWNSdWxlcyhlZGl0b3I6IEVkaXRvcik6IGJvb2xlYW4ge1xyXG4gICAgICAgIC8vIFZcdTAwRTlyaWZpZXIgcydpbCB5IGEgdW5lIHNcdTAwRTlsZWN0aW9uXHJcbiAgICAgICAgY29uc3Qgc2VsZWN0aW9uID0gZWRpdG9yLmdldFNlbGVjdGlvbigpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFNpIGF1Y3VuZSBzXHUwMEU5bGVjdGlvbiwgbmUgcmllbiBmYWlyZVxyXG4gICAgICAgIGlmICghc2VsZWN0aW9uIHx8IHNlbGVjdGlvbi5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICAvLyBDb25zZXJ2ZXIgbGVzIHBvc2l0aW9ucyBkZSBzXHUwMEU5bGVjdGlvblxyXG4gICAgICAgIGNvbnN0IHNlbGVjdGlvblN0YXJ0ID0gZWRpdG9yLmdldEN1cnNvcignZnJvbScpO1xyXG4gICAgICAgIGNvbnN0IHNlbGVjdGlvbkVuZCA9IGVkaXRvci5nZXRDdXJzb3IoJ3RvJyk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gUHJcdTAwRTljb21waWxlciBsZXMgclx1MDBFOGdsZXMgdHlwb2dyYXBoaXF1ZXMgYXZlYyBsZXMgcGFyYW1cdTAwRTh0cmVzIGNvdXJhbnRzXHJcbiAgICAgICAgY29uc3QgcnVsZXMgPSBjb21waWxlUnVsZXModGhpcy5zZXR0aW5ncyk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gQW5hbHlzZXIgbGEgc3RydWN0dXJlIGR1IGRvY3VtZW50IHBvdXIgZFx1MDBFOXRlY3RlciBsZXMgYmxvY3Mgc3BcdTAwRTljaWF1eFxyXG4gICAgICAgIGNvbnN0IGJsb2NrcyA9IGFuYWx5emVEb2N1bWVudFN0cnVjdHVyZShcclxuICAgICAgICAgICAgZWRpdG9yLmdldFZhbHVlKCksXHJcbiAgICAgICAgICAgIHNlbGVjdGlvblN0YXJ0LmxpbmUsXHJcbiAgICAgICAgICAgIHNlbGVjdGlvbkVuZC5saW5lXHJcbiAgICAgICAgKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBUcmFpdGVyIGxlIHRleHRlIGF2ZWMgbGVzIHJcdTAwRThnbGVzIGNvbXBpbFx1MDBFOWVzIGV0IGxlcyBwYXJhbVx1MDBFOHRyZXNcclxuICAgICAgICBjb25zdCBwcm9jZXNzZWRUZXh0ID0gcHJvY2Vzc1RleHRXaXRoQmxvY2tzKHNlbGVjdGlvbiwgYmxvY2tzLmxpbmVUeXBlcywgcnVsZXMsIHRoaXMuc2V0dGluZ3MpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFZcdTAwRTlyaWZpZXIgc2kgbGUgdGV4dGUgYSBjaGFuZ1x1MDBFOVxyXG4gICAgICAgIGlmIChwcm9jZXNzZWRUZXh0ID09PSBzZWxlY3Rpb24pIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgIFxyXG4gICAgICAgIGVkaXRvci5yZXBsYWNlU2VsZWN0aW9uKHByb2Nlc3NlZFRleHQpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFJlc3RhdXJlciBsYSBzXHUwMEU5bGVjdGlvblxyXG4gICAgICAgIC8vIGVkaXRvci5zZXRTZWxlY3Rpb24oc2VsZWN0aW9uU3RhcnQsIHNlbGVjdGlvbkVuZCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBUcmFpdGUgZGUgZ3JhbmRzIGRvY3VtZW50cyBkZSBtYW5pXHUwMEU4cmUgYXN5bmNocm9uZVxyXG4gICAgICogQHBhcmFtIGVkaXRvciBcdTAwQzlkaXRldXIgT2JzaWRpYW5cclxuICAgICAqIEBwYXJhbSBjYWxsYmFjayBGb25jdGlvbiBhcHBlbFx1MDBFOWUgbG9yc3F1ZSBsZSB0cmFpdGVtZW50IGVzdCB0ZXJtaW5cdTAwRTlcclxuICAgICAqL1xyXG4gICAgcHVibGljIGFzeW5jIHByb2Nlc3NMYXJnZVNlbGVjdGlvbihlZGl0b3I6IEVkaXRvciwgY2FsbGJhY2s/OiAoKSA9PiB2b2lkKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICAgICAgY29uc3Qgc2VsZWN0aW9uID0gZWRpdG9yLmdldFNlbGVjdGlvbigpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmICghc2VsZWN0aW9uIHx8IHNlbGVjdGlvbi5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgaWYgKGNhbGxiYWNrKSBjYWxsYmFjaygpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnN0IHNlbGVjdGlvblN0YXJ0ID0gZWRpdG9yLmdldEN1cnNvcignZnJvbScpO1xyXG4gICAgICAgIGNvbnN0IHNlbGVjdGlvbkVuZCA9IGVkaXRvci5nZXRDdXJzb3IoJ3RvJyk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gU2kgbGEgc1x1MDBFOWxlY3Rpb24gZXN0IHBldGl0ZSwgdXRpbGlzZXIgbGEgbVx1MDBFOXRob2RlIHN5bmNocm9uZVxyXG4gICAgICAgIGlmIChzZWxlY3Rpb24ubGVuZ3RoIDwgMTAwMDApIHtcclxuICAgICAgICAgICAgdGhpcy5hcHBseVR5cG9ncmFwaGljUnVsZXMoZWRpdG9yKTtcclxuICAgICAgICAgICAgaWYgKGNhbGxiYWNrKSBjYWxsYmFjaygpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFBvdXIgbGVzIGdyYW5kZXMgc1x1MDBFOWxlY3Rpb25zLCB1dGlsaXNlciBsZSB0cmFpdGVtZW50IGFzeW5jaHJvbmVcclxuICAgICAgICBjb25zdCBydWxlcyA9IGNvbXBpbGVSdWxlcyh0aGlzLnNldHRpbmdzKTtcclxuICAgICAgICBjb25zdCBibG9ja3MgPSBhbmFseXplRG9jdW1lbnRTdHJ1Y3R1cmUoXHJcbiAgICAgICAgICAgIGVkaXRvci5nZXRWYWx1ZSgpLFxyXG4gICAgICAgICAgICBzZWxlY3Rpb25TdGFydC5saW5lLFxyXG4gICAgICAgICAgICBzZWxlY3Rpb25FbmQubGluZVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgYXdhaXQgcHJvY2Vzc0xhcmdlRG9jdW1lbnQoXHJcbiAgICAgICAgICAgIHNlbGVjdGlvbiwgXHJcbiAgICAgICAgICAgIGJsb2Nrcy5saW5lVHlwZXMsIFxyXG4gICAgICAgICAgICBydWxlcywgXHJcbiAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MsXHJcbiAgICAgICAgICAgIChwcm9jZXNzZWRUZXh0KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBlZGl0b3IucmVwbGFjZVNlbGVjdGlvbihwcm9jZXNzZWRUZXh0KTtcclxuICAgICAgICAgICAgICAgIGVkaXRvci5zZXRTZWxlY3Rpb24oc2VsZWN0aW9uU3RhcnQsIHNlbGVjdGlvbkVuZCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2spIGNhbGxiYWNrKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICApO1xyXG4gICAgfVxyXG59Il0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLElBQUFBLG1CQUFxQzs7O0FDdUI5QixJQUFNLG1CQUE2QztBQUFBLEVBQ3RELGlCQUFpQjtBQUFBO0FBQUEsRUFDakIsa0JBQWtCO0FBQUE7QUFBQSxFQUNsQixpQkFBaUI7QUFBQTtBQUFBLEVBQ2pCLGtCQUFrQjtBQUFBO0FBQUEsRUFDbEIsb0JBQW9CO0FBQUEsRUFDcEIsZUFBZTtBQUFBLEVBQ2YsWUFBWTtBQUFBLEVBQ1osaUJBQWlCO0FBQUEsRUFDakIsbUJBQW1CO0FBQUEsRUFDbkIsa0JBQWtCO0FBQUEsRUFDbEIsaUJBQWlCO0FBQUEsRUFDakIsbUJBQW1CO0FBQUE7QUFDdkI7OztBQ3BDQSxzQkFBK0M7QUFPeEMsSUFBTSw2QkFBTixjQUF5QyxpQ0FBaUI7QUFBQTtBQUFBLEVBSS9ELFlBQVksS0FBVSxRQUEwQjtBQUM5QyxVQUFNLEtBQUssTUFBTTtBQUNqQixTQUFLLFNBQVM7QUFBQSxFQUNoQjtBQUFBLEVBRUEsVUFBZ0I7QUFDZCxVQUFNLEVBQUUsWUFBWSxJQUFJO0FBRXhCLGdCQUFZLE1BQU07QUFFbEIsZ0JBQVksU0FBUyxNQUFNLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQU12RCxTQUFLLG9CQUFvQixXQUFXO0FBR3BDLFNBQUssd0JBQXdCLFdBQVc7QUFBQSxFQUMxQztBQUFBO0FBQUE7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Q3RCO0FBQUE7QUFBQSxFQUdBLHFCQUFxQjtBQUNqQixTQUFLLElBQUksVUFBVSxpQkFBaUIsQ0FBQyxTQUFTO0FBQzFDLFVBQUksS0FBSyxnQkFBZ0IsaUNBQWdCLEtBQUssS0FBSyxRQUFRO0FBQ3ZELGNBQU0sYUFBYyxLQUFLLEtBQUssT0FBZTtBQUU3QyxZQUFJLFlBQVk7QUFDWixxQkFBVyxTQUFTO0FBQUEsWUFDaEIsU0FBUztBQUFBLGNBQ0wsTUFBTTtBQUFBLGNBQ04sSUFBSSxXQUFXLE1BQU0sSUFBSTtBQUFBLGNBQ3pCLFFBQVEsV0FBVyxNQUFNLElBQUksU0FBUztBQUFBLFlBQzFDO0FBQUEsVUFDSixDQUFDO0FBQUEsUUFDTDtBQUFBLE1BQ0o7QUFBQSxJQUNKLENBQUM7QUFBQSxFQUNMO0FBQUEsRUFFQSxXQUFXO0FBRVAsNEJBQXdCLEtBQUssaUJBQWlCO0FBQUEsRUFDbEQ7QUFDSjsiLAogICJuYW1lcyI6IFsiaW1wb3J0X29ic2lkaWFuIiwgImlzSW5TcGVjaWFsQmxvY2siLCAiaW1wb3J0X29ic2lkaWFuIl0KfQo=
