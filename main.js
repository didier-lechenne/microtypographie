/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => Microtypographie
});
module.exports = __toCommonJS(main_exports);
var import_obsidian3 = require("obsidian");

// src/settings/settings.ts
var DEFAULT_SETTINGS = {
  openDoubleQuote: "\xAB\u202F",
  // Guillemet français ouvrant avec espace fine insécable
  closeDoubleQuote: "\u202F\xBB",
  // Guillemet français fermant avec espace fine insécable
  openSingleQuote: "\u201C",
  // Apostrophe typographique
  closeSingleQuote: "\u201D",
  // Apostrophe typographique
  frenchRulesEnabled: true,
  dashesEnabled: true,
  skipEnDash: false,
  ellipsisEnabled: true,
  guillemetsEnabled: false,
  highlightEnabled: false,
  highlightButton: true,
  tabTitleBarButton: true
  // Activé par défaut
};

// src/settings/settingsTab.ts
var import_obsidian = require("obsidian");
var MicrotypographieSettingTab = class extends import_obsidian.PluginSettingTab {
  // Pour stocker la référence au container du champ de texte
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h3", { text: "Microtypographie" });
    this.createBasicSettings(containerEl);
    this.createHighlightSettings(containerEl);
  }
  /**
   * Crée le bloc d'information
   * @param containerEl Conteneur parent
   */
  createInfoBlock(containerEl) {
    const infoContainer = containerEl.createEl("div", {
      cls: "microtypographie-info-container"
    });
    const infoContent = infoContainer.createEl("div", {
      cls: "microtypographie-info-content"
    });
    infoContent.createEl("p", {
      text: "Ce plugin applique automatiquement une partie des r\xE8gles typographiques fran\xE7aises pendant la saisie."
    });
    const rulesList = infoContent.createEl("ul");
    rulesList.createEl("li", {
      text: "Espaces ins\xE9cables avant les ponctuations doubles (! ? ; \xBB)"
    });
    rulesList.createEl("li", { text: "Espaces fines ins\xE9cables avant (:)" });
    rulesList.createEl("li", {
      text: "Espaces fines ins\xE9cables dans les guillemets fran\xE7ais (\xAB\u202Fphrase\u202F\xBB)"
    });
    rulesList.createEl("li", { text: "Apostrophe typographique (\u2019)" });
    rulesList.createEl("li", {
      text: "Conversion de (--) en tiret cadratin (\u2014)"
    });
    infoContent.createEl("p", {
      text: "Utilisez Alt+F pour appliquer toutes les r\xE8gles sur un texte existant."
    });
    const transformationsList = infoContent.createEl("ul");
    transformationsList.createEl("li", {
      text: 'Conversion de (" ") en guillemets fran\xE7ais (\xAB \xBB)'
    });
    transformationsList.createEl("li", {
      text: "Conversion de ' en apostrophe typographique (\u2019)"
    });
    transformationsList.createEl("li", {
      text: "Espace fine ins\xE9cable avant : (! ? ; \xBB \u203A)"
    });
    transformationsList.createEl("li", {
      text: "Espace ins\xE9cable avant : (:)"
    });
    transformationsList.createEl("li", {
      text: "Espace fine ins\xE9cable apr\xE8s : (\xAB \u2039)"
    });
    transformationsList.createEl("li", {
      text: "Espace ins\xE9cable apr\xE8s les mots d'une lettre (a, y, \xE0 \u2026)"
    });
    transformationsList.createEl("li", {
      text: "Espace ins\xE9cable dans les noms compos\xE9s (Jean\xA0Dupont)"
    });
    transformationsList.createEl("li", {
      text: "Espace ins\xE9cable avant les initiales (M.\xA0Dupont)"
    });
    transformationsList.createEl("li", {
      text: "Espace ins\xE9cable avant (si\xE8cle) (XXe\xA0si\xE8cle)"
    });
    transformationsList.createEl("li", {
      text: "Conversion de (oe/OE) en ligatures (\u0153/\u0152)"
    });
    transformationsList.createEl("li", {
      text: "Conversion de (--) en tiret cadratin (\u2014)"
    });
    transformationsList.createEl("li", {
      text: "Conversion de (...) en points de suspension (\u2026)"
    });
    infoContent.createEl("p", {
      text: "Info pour ins\xE9rer une espace ins\xE9cable avec Obsidian :"
    });
    const shortcutsList = infoContent.createEl("ul");
    shortcutsList.createEl("li", { text: "Windows : Alt+255" });
    shortcutsList.createEl("li", { text: "macOS : Alt+Espace" });
    this.addInfoBlockStyles();
  }
  /**
   * Ajoute les styles CSS pour le bloc d'information
   */
  addInfoBlockStyles() {
    const styleElement = document.createElement("style");
    styleElement.textContent = `
        .microtypographie-info-container {
            background-color: rgba(var(--interactive-accent-rgb), 0.1);
            border-left: 4px solid var(--interactive-accent);
            margin: 1em 0;
            padding: 1em;
            border-radius: 4px;
        }
        
        .microtypographie-info-container h2 {
            margin-top: 0;
            font-size: 1.2em;
            color: var(--interactive-accent);
        }
        
        .microtypographie-info-content p {
            margin: 0.5em 0;
        }
    `;
    document.head.appendChild(styleElement);
  }
  /**
   * Crée les paramètres de base
   * @param containerEl Conteneur parent
   */
  createBasicSettings(containerEl) {
    const desEl = containerEl.createEl("p", {
      text: "Caract\xE8res typographiques personnalisables"
    });
    desEl.style.fontWeight = "bold";
    new import_obsidian.Setting(containerEl).setName("Guillemet double ouvrant").addText(
      (text) => text.setValue(this.plugin.settings.openDoubleQuote).onChange(async (value) => {
        this.plugin.settings.openDoubleQuote = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian.Setting(containerEl).setName("Guillemet double fermant").addText(
      (text) => text.setValue(this.plugin.settings.closeDoubleQuote).onChange(async (value) => {
        this.plugin.settings.closeDoubleQuote = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian.Setting(containerEl).setName("Guillemet simple ouvrant").addText(
      (text) => text.setValue(this.plugin.settings.openSingleQuote).onChange(async (value) => {
        this.plugin.settings.openSingleQuote = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian.Setting(containerEl).setName("Guillemet simple fermant").addText(
      (text) => text.setValue(this.plugin.settings.closeSingleQuote).onChange(async (value) => {
        this.plugin.settings.closeSingleQuote = value;
        await this.plugin.saveSettings();
      })
    );
    const transformTitle = containerEl.createEl("p", {
      text: "Options"
    });
    transformTitle.style.fontWeight = "bold";
    transformTitle.style.marginTop = "1.5em";
    new import_obsidian.Setting(containerEl).setName("Tirets").setDesc(
      "-- devient tiret demi-cadratin (\u2013), \u2013- devient tiret cadratin (\u2014), \u2014- devient trois tirets (---)"
    ).addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.dashesEnabled).onChange(async (value) => {
        this.plugin.settings.dashesEnabled = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian.Setting(containerEl).setName("Ignorer le tiret demi-cadratin").setDesc(
      "Quand activ\xE9, -- est directement converti en tiret cadratin (\u2014) plut\xF4t qu'en demi-cadratin (\u2013)"
    ).addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.skipEnDash).onChange(async (value) => {
        this.plugin.settings.skipEnDash = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian.Setting(containerEl).setName("Points de suspension").setDesc(
      "Trois points (...) seront convertis en points de suspension (\u2026)"
    ).addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.ellipsisEnabled).onChange(async (value) => {
        this.plugin.settings.ellipsisEnabled = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian.Setting(containerEl).setName("Guillemets").setDesc(
      "Les chevrons << et >> seront convertis en guillemets fran\xE7ais \xAB et \xBB"
    ).addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.guillemetsEnabled).onChange(async (value) => {
        this.plugin.settings.guillemetsEnabled = value;
        await this.plugin.saveSettings();
      })
    );
    const frenchRulesContainer = containerEl.createEl("div");
    frenchRulesContainer.style.marginTop = "3em";
    const frenchRulesSetting = new import_obsidian.Setting(frenchRulesContainer).setName("R\xE8gles typographiques fran\xE7aises").setDesc(
      ""
    ).addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.frenchRulesEnabled).onChange(async (value) => {
        this.plugin.settings.frenchRulesEnabled = value;
        frenchRulesDescContainer.style.display = value ? "block" : "none";
        await this.plugin.saveSettings();
      })
    );
    const nameEl = frenchRulesSetting.nameEl;
    if (nameEl) {
      nameEl.style.fontWeight = "bold";
    }
    const frenchRulesDescContainer = frenchRulesContainer.createEl("div", {
      cls: "french-rules-description"
    });
    frenchRulesDescContainer.style.display = this.plugin.settings.frenchRulesEnabled ? "block" : "none";
    frenchRulesDescContainer.style.paddingLeft = "24px";
    frenchRulesDescContainer.style.marginTop = "8px";
    const frenchRulesDesc = frenchRulesDescContainer.createEl("div", {
      cls: "setting-item-description"
    });
    frenchRulesDesc.createEl("p", {
      text: "Ces r\xE8gles incluent :"
    });
    const rulesList = frenchRulesDesc.createEl("ul");
    rulesList.style.marginLeft = "20px";
    rulesList.style.marginBottom = "15px";
    rulesList.createEl("li", {
      text: 'Conversion de (" ") en guillemets fran\xE7ais (\xAB \xBB)'
    });
    rulesList.createEl("li", {
      text: "Espace fine ins\xE9cable avant les ponctuations doubles (! ? ; \xBB)"
    });
    rulesList.createEl("li", {
      text: "Espace ins\xE9cable avant les deux-points (:)"
    });
    rulesList.createEl("li", {
      text: "Espace ins\xE9cable apr\xE8s les mots d'une lettre (a, y, \xE0...)"
    });
    rulesList.createEl("li", {
      text: "Espace ins\xE9cable dans les noms compos\xE9s (Jean Dupont)"
    });
    rulesList.createEl("li", {
      text: "Espace ins\xE9cable avant les initiales (M. Dupont)"
    });
    rulesList.createEl("li", {
      text: 'Espace ins\xE9cable avant "si\xE8cle" (XXe si\xE8cle)'
    });
    rulesList.createEl("li", {
      text: 'Conversion des ligatures "oe/OE" en "\u0153/\u0152"'
    });
    rulesList.createEl("li", {
      text: "Exposants pour les ordinaux (1er, XIIe)"
    });
    rulesList.createEl("li", {
      text: "Conversion de (...) en points de suspension (\u2026)"
    });
    const noteEl = frenchRulesDescContainer.createEl("div", {
      cls: "setting-item-description"
    });
    noteEl.createEl("p", {
      text: "Sources :"
    });
    const infoList = noteEl.createEl("ul");
    const infoItem = infoList.createEl("li");
    infoItem.createEl("a", {
      href: "https://gitlab.com/JulieBlanc/typesetting-tools/-/blob/master/regex-typo.js?ref_type=heads",
      text: "typesetting-tools (Julie Blanc)"
    });
    const infoItem2 = infoList.createEl("li");
    infoItem2.createEl("a", {
      href: "https://typomanie.fr/tag/micro-typographie/",
      text: "Le Petit manuel de composition typographique. (Muriel Paris)"
    });
  }
  /**
   * Crée les paramètres de mise en évidence
   * @param containerEl Conteneur parent
   */
  createHighlightSettings(containerEl) {
    const desEl = containerEl.createEl("p", {
      text: "Affichage des caract\xE8res invisibles"
    });
    desEl.style.fontWeight = "bold";
    desEl.style.marginTop = "3em";
    new import_obsidian.Setting(containerEl).setName("Activer l'affichage des caract\xE8res invisibles").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.highlightEnabled).onChange(async (value) => {
        this.plugin.settings.highlightEnabled = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian.Setting(containerEl).setName("Bouton dans la barre d'\xE9tat").setDesc(
      "Afficher un bouton d'activation/d\xE9sactivation"
    ).addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.highlightButton).onChange(async (value) => {
        this.plugin.settings.highlightButton = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian.Setting(containerEl).setName("Bouton dans la barre de titre").setDesc(
      "Afficher un bouton d'activation/d\xE9sactivation dans la barre de titre des onglets"
    ).addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.tabTitleBarButton).onChange(async (value) => {
        this.plugin.settings.tabTitleBarButton = value;
        await this.plugin.saveSettings();
      })
    );
  }
};

// src/ui/decorations.ts
var import_view = require("@codemirror/view");
var import_state = require("@codemirror/state");
function createDecorations(settings) {
  const nonBreakingSpaceDecoration = import_view.Decoration.mark({
    class: "nonBreakingSpace"
  });
  const thinSpaceDecoration = import_view.Decoration.mark({
    class: "thinSpace"
  });
  const emDashDecoration = import_view.Decoration.mark({
    class: "em-dash"
  });
  const regularSpaceDecoration = import_view.Decoration.mark({
    class: "regularSpace"
  });
  return import_view.ViewPlugin.fromClass(class {
    constructor(view) {
      this.decorations = this.buildDecorations(view);
    }
    update(update) {
      if (update.docChanged || update.viewportChanged) {
        this.decorations = this.buildDecorations(update.view);
      }
    }
    buildDecorations(view) {
      const builder = new import_state.RangeSetBuilder();
      if (settings.highlightEnabled) {
        for (let { from, to } of view.visibleRanges) {
          let text = view.state.doc.sliceString(from, to);
          let documentText = view.state.doc.toString();
          let startPos = from;
          let inFrontmatter = false;
          let inCodeBlock = false;
          let lineStart = true;
          for (let i = 0; i < text.length; i++) {
            const char = text[i];
            const pos = startPos + i;
            const currentPos = view.state.doc.lineAt(pos);
            const lineNumber = currentPos.number - 1;
            if (lineStart && text.substr(i, 3) === "---") {
              inFrontmatter = !inFrontmatter;
              i += 2;
              lineStart = false;
              continue;
            }
            if (lineStart && text.substr(i, 3) === "```") {
              inCodeBlock = !inCodeBlock;
              i += 2;
              lineStart = false;
              continue;
            }
            if (char === "\n") {
              lineStart = true;
            } else if (lineStart && char !== " " && char !== "	") {
              lineStart = false;
            }
            const isInSpecialBlock2 = inFrontmatter || inCodeBlock;
            if (!isInSpecialBlock2) {
              if (char === "\xA0") {
                builder.add(pos, pos + 1, nonBreakingSpaceDecoration);
              }
              if (char === "\u202F") {
                builder.add(pos, pos + 1, thinSpaceDecoration);
              }
              if (char === "\u2014") {
                builder.add(pos, pos + 1, emDashDecoration);
              }
              if (char === " ") {
                builder.add(pos, pos + 1, regularSpaceDecoration);
              }
            }
          }
        }
      }
      return builder.finish();
    }
  }, {
    decorations: (v) => v.decorations
  });
}

// src/ui/statusBar.ts
var import_obsidian2 = require("obsidian");
function createStatusBarButton(plugin, isEnabled, toggleCallback) {
  const statusBarItemEl = plugin.addStatusBarItem();
  statusBarItemEl.id = "highlight-status-bar-button";
  statusBarItemEl.addClass("mod-clickable");
  (0, import_obsidian2.setIcon)(statusBarItemEl, "pilcrow");
  statusBarItemEl.setAttribute("aria-label", "Afficher/Masquer les caract\xE8res invisibles");
  statusBarItemEl.setAttribute("data-tooltip-position", "top");
  updateStatusBarButton(statusBarItemEl, isEnabled);
  statusBarItemEl.onClickEvent(() => {
    toggleCallback();
  });
  return statusBarItemEl;
}
function createTabTitleBarButton(plugin, isEnabled, toggleCallback) {
  const buttonEl = document.createElement("button");
  buttonEl.id = "highlight-tab-title-button";
  buttonEl.className = "clickable-icon view-action";
  buttonEl.setAttribute("aria-label", "Afficher/Masquer les caract\xE8res invisibles");
  (0, import_obsidian2.setIcon)(buttonEl, "pilcrow");
  updateTabTitleBarButton(buttonEl, isEnabled);
  buttonEl.addEventListener("click", (event) => {
    event.preventDefault();
    toggleCallback();
  });
  const titleBarEl = document.querySelector(".view-header-title-container");
  if (titleBarEl) {
    const actionsEl = titleBarEl.nextElementSibling;
    if (actionsEl && actionsEl.classList.contains("view-actions")) {
      actionsEl.prepend(buttonEl);
    }
  }
  return buttonEl;
}
function updateStatusBarButton(buttonEl, isEnabled) {
  if (!buttonEl)
    return;
  if (isEnabled) {
    buttonEl.addClass("highlight-enabled");
  } else {
    buttonEl.removeClass("highlight-enabled");
  }
}
function updateTabTitleBarButton(buttonEl, isEnabled) {
  if (!buttonEl)
    return;
  if (isEnabled) {
    buttonEl.addClass("is-active");
  } else {
    buttonEl.removeClass("is-active");
  }
}
function removeTabTitleBarButton(buttonEl) {
  if (buttonEl) {
    buttonEl.remove();
  }
}

// src/core/blockAnalyzer.ts
function analyzeDocumentStructure(documentText, startLine, endLine) {
  const lines = documentText.split("\n");
  const lineTypes = new Array(endLine - startLine + 1).fill("normal");
  let inFrontmatter = false;
  let inCodeBlock = false;
  for (let i = 0; i < lines.length; i++) {
    const line = lines[i];
    if (line.trim() === "---") {
      inFrontmatter = !inFrontmatter;
    } else if (line.trim().startsWith("```")) {
      inCodeBlock = !inCodeBlock;
    }
    if (i >= startLine && i <= endLine) {
      const relativeIndex = i - startLine;
      if (line.trim() === "---" || line.trim().startsWith("```")) {
        lineTypes[relativeIndex] = "delimiter";
      } else if (inFrontmatter) {
        lineTypes[relativeIndex] = "frontmatter";
      } else if (inCodeBlock) {
        lineTypes[relativeIndex] = "code";
      }
    }
    if (i > endLine)
      break;
  }
  return { lineTypes };
}
function isLineInSpecialBlock(documentText, lineNumber) {
  const lines = documentText.split("\n");
  let inFrontmatter = false;
  let inCodeBlock = false;
  for (let i = 0; i <= lineNumber; i++) {
    const line = lines[i];
    if (line.trim() === "---") {
      inFrontmatter = !inFrontmatter;
    } else if (line.trim().startsWith("```")) {
      inCodeBlock = !inCodeBlock;
    }
    if (i === lineNumber) {
      return inFrontmatter || inCodeBlock;
    }
  }
  return false;
}

// src/utils/helpers.ts
function isInSpecialBlock(editor) {
  const cursor = editor.getCursor();
  const text = editor.getValue();
  return isLineInSpecialBlock(text, cursor.line);
}
function isInPreservedMarkdown(editor) {
  const cursor = editor.getCursor();
  const line = editor.getLine(cursor.line);
  const codeInlinePattern = /`[^`]*`/g;
  const codeInlineMatches = [...line.matchAll(codeInlinePattern)];
  for (const match of codeInlineMatches) {
    const start = match.index || 0;
    const end = start + match[0].length;
    if (cursor.ch >= start && cursor.ch <= end) {
      return true;
    }
  }
  const obsidianLinkPattern = /\[\[[^\]]*\]\]/g;
  const obsidianLinkMatches = [...line.matchAll(obsidianLinkPattern)];
  for (const match of obsidianLinkMatches) {
    const start = match.index || 0;
    const end = start + match[0].length;
    if (cursor.ch >= start && cursor.ch <= end) {
      return true;
    }
  }
  const mathInlinePattern = /\$[^$]*\$/g;
  const mathInlineMatches = [...line.matchAll(mathInlinePattern)];
  for (const match of mathInlineMatches) {
    const start = match.index || 0;
    const end = start + match[0].length;
    if (cursor.ch >= start && cursor.ch <= end) {
      return true;
    }
  }
  if (line.includes("$$")) {
    const matches = [...line.matchAll(/\$\$/g)];
    for (const match of matches) {
      const start = match.index || 0;
      const end = start + 2;
      if (cursor.ch >= start && cursor.ch <= end) {
        return true;
      }
    }
  }
  const calloutPattern = /^>\s+\[!.*\]/;
  if (calloutPattern.test(line) && cursor.ch <= line.length) {
    return true;
  }
  const urlPattern = /(https?:\/\/|www\.)[^\s]+/g;
  const urlMatches = [...line.matchAll(urlPattern)];
  for (const match of urlMatches) {
    const start = match.index || 0;
    const end = start + match[0].length;
    if (cursor.ch >= start && cursor.ch <= end) {
      return true;
    }
  }
  const imagePattern = /!\[.*?\]\(.*?\)/g;
  const imageMatches = [...line.matchAll(imagePattern)];
  for (const match of imageMatches) {
    const start = match.index || 0;
    const end = start + match[0].length;
    if (cursor.ch >= start && cursor.ch <= end) {
      return true;
    }
  }
  const linkPattern = /\[.*?\]\(.*?\)/g;
  const linkMatches = [...line.matchAll(linkPattern)];
  for (const match of linkMatches) {
    const start = match.index || 0;
    const end = start + match[0].length;
    if (cursor.ch >= start && cursor.ch <= end) {
      return true;
    }
  }
  const htmlTagPattern = /<[^>]*>/g;
  const htmlMatches = [...line.matchAll(htmlTagPattern)];
  for (const match of htmlMatches) {
    const start = match.index || 0;
    const end = start + match[0].length;
    if (cursor.ch >= start && cursor.ch <= end) {
      return true;
    }
  }
  const taskPattern = /^\s*- \[[ x]\]/;
  if (taskPattern.test(line) && cursor.ch <= line.indexOf("]") + 1) {
    return true;
  }
  return false;
}
async function injectCSSFromFile(plugin, fileName) {
  try {
    const pluginDir = plugin.manifest.dir;
    const filePath = `${pluginDir}/${fileName}`;
    const cssContent = await plugin.app.vault.adapter.read(filePath);
    const styleEl = document.createElement("style");
    styleEl.textContent = cssContent;
    document.head.appendChild(styleEl);
  } catch (error) {
    console.error("\xC9chec de chargement du fichier CSS:", error);
  }
}

// src/modules/liveTypography.ts
var LiveTypographyModule = class {
  constructor(settings) {
    this.openQuote = true;
    this.settings = settings;
  }
  /**
   * Initialise le module avec les paramètres actuels
   * @param settings Paramètres mis à jour
   */
  updateSettings(settings) {
    this.settings = settings;
  }
  resetQuoteState() {
    this.openQuote = true;
  }
  /**
   * Gère les événements clavier pour appliquer les règles typographiques en temps réel
   * @param event Événement clavier
   * @param editor Éditeur Obsidian
   * @returns true si l'événement a été géré, false sinon
   */
  handleKeyEvent(event, editor) {
    if (isInSpecialBlock(editor) || isInPreservedMarkdown(editor)) {
      return false;
    }
    const cursor = editor.getCursor();
    let handled = false;
    if (event.key === "'") {
      event.preventDefault();
      const selection = editor.getSelection();
      if (selection.length > 0) {
        editor.replaceSelection(this.settings.openSingleQuote);
      } else {
        editor.replaceRange(this.settings.openSingleQuote, cursor);
        editor.setCursor({ line: cursor.line, ch: cursor.ch + this.settings.openSingleQuote.length });
      }
      handled = true;
    } else if (["!", "?", ";"].includes(event.key) && this.settings.frenchRulesEnabled) {
      event.preventDefault();
      const charBefore = editor.getRange(
        { line: cursor.line, ch: cursor.ch - 1 },
        cursor
      );
      if (charBefore === " ") {
        editor.replaceRange(
          "\u202F" + event.key,
          { line: cursor.line, ch: cursor.ch - 1 },
          cursor
        );
      } else {
        editor.replaceRange(event.key, cursor);
      }
      editor.setCursor({ line: cursor.line, ch: cursor.ch + 1 });
      handled = true;
    } else if (event.key === ":" && this.settings.frenchRulesEnabled) {
      event.preventDefault();
      const charBefore = editor.getRange(
        { line: cursor.line, ch: cursor.ch - 1 },
        cursor
      );
      if (charBefore === " ") {
        editor.replaceRange(
          "\xA0" + event.key,
          { line: cursor.line, ch: cursor.ch - 1 },
          cursor
        );
      } else {
        editor.replaceRange(event.key, cursor);
      }
      editor.setCursor({ line: cursor.line, ch: cursor.ch + 1 });
      handled = true;
    } else if (event.key === '"') {
      event.preventDefault();
      if (this.openQuote) {
        editor.replaceRange(this.settings.openDoubleQuote, cursor);
        editor.setCursor({
          line: cursor.line,
          ch: cursor.ch + this.settings.openDoubleQuote.length
        });
      } else {
        editor.replaceRange(this.settings.closeDoubleQuote, cursor);
        editor.setCursor({
          line: cursor.line,
          ch: cursor.ch + this.settings.closeDoubleQuote.length
        });
      }
      this.openQuote = !this.openQuote;
      handled = true;
    } else if (event.key === "." && this.settings.ellipsisEnabled) {
      const textBefore = editor.getRange(
        { line: cursor.line, ch: cursor.ch - 2 },
        cursor
      );
      if (textBefore === "..") {
        event.preventDefault();
        editor.replaceRange(
          "\u2026",
          { line: cursor.line, ch: cursor.ch - 2 },
          cursor
        );
        editor.setCursor({ line: cursor.line, ch: cursor.ch - 1 });
        handled = true;
      }
    } else if (event.key === "-" && this.settings.dashesEnabled) {
      const textBefore = editor.getRange(
        { line: cursor.line, ch: cursor.ch - 1 },
        cursor
      );
      if (this.settings.skipEnDash) {
        if (textBefore === "-") {
          event.preventDefault();
          editor.replaceRange(
            "\u2014",
            { line: cursor.line, ch: cursor.ch - 1 },
            cursor
          );
          editor.setCursor({ line: cursor.line, ch: cursor.ch });
          handled = true;
        }
      } else {
        if (textBefore === "-") {
          event.preventDefault();
          editor.replaceRange(
            "\u2013",
            { line: cursor.line, ch: cursor.ch - 1 },
            cursor
          );
          editor.setCursor({ line: cursor.line, ch: cursor.ch });
          handled = true;
        } else if (textBefore === "\u2013") {
          event.preventDefault();
          editor.replaceRange(
            "\u2014",
            { line: cursor.line, ch: cursor.ch - 1 },
            cursor
          );
          editor.setCursor({ line: cursor.line, ch: cursor.ch });
          handled = true;
        } else if (textBefore === "\u2014") {
          event.preventDefault();
          editor.replaceRange(
            "---",
            { line: cursor.line, ch: cursor.ch - 1 },
            cursor
          );
          editor.setCursor({ line: cursor.line, ch: cursor.ch + 2 });
          handled = true;
        }
      }
    } else if (event.key === ">" && this.settings.guillemetsEnabled) {
      const textBefore = editor.getRange(
        { line: cursor.line, ch: cursor.ch - 1 },
        cursor
      );
      if (textBefore === ">") {
        event.preventDefault();
        editor.replaceRange(
          "\u202F\xBB",
          { line: cursor.line, ch: cursor.ch - 1 },
          cursor
        );
        editor.setCursor({ line: cursor.line, ch: cursor.ch });
        handled = true;
      }
    } else if (event.key === "<" && this.settings.guillemetsEnabled) {
      const textBefore = editor.getRange(
        { line: cursor.line, ch: cursor.ch - 1 },
        cursor
      );
      if (textBefore === "<") {
        event.preventDefault();
        editor.replaceRange(
          "\xAB\u202F",
          { line: cursor.line, ch: cursor.ch - 1 },
          cursor
        );
        editor.setCursor({ line: cursor.line, ch: cursor.ch });
        handled = true;
      }
    }
    return handled;
  }
};

// src/core/typographyRules.ts
var FRENCH_RULES = [
  // Règles orthographiques
  { reg: /(X|I|V)ème/g, repl: "$1e" },
  { reg: /(X|I|V)eme/g, repl: "$1e" },
  { reg: /(X|I|V)éme/g, repl: "$1e" },
  { reg: /oe/g, repl: "\u0153" },
  { reg: /OE/g, repl: "\u0152" },
  { reg: /Oe/g, repl: "\u0152" },
  { reg: /ae/g, repl: "\xE6" },
  { reg: /AE/g, repl: "\xC6" },
  { reg: /Ae/g, repl: "\xC6" },
  // delete all spaces after «‹“[(
  { reg: /([«‹"\[(])\s+/g, repl: "$1" },
  // real apostrophe
  { reg: /\'/g, repl: "\u2019" },
  // real suspension points
  { reg: /\.{3,}/g, repl: "\u2026" },
  // delete all spaces after «‹“[(
  { reg: /([«‹"\[(])\s+/g, repl: "$1" },
  // delete all spaces before punctuation !?;:»›”)].,
  { reg: /\s+([!?;:»›")\]\.\,])/g, repl: "$1" },
  // add narrow no break space before !?;»›
  { reg: /([!?;»›])/g, repl: "\u202F$1" },
  // add no break space before : (correctly handling existing spaces, but avoiding URLs)
  { reg: /\s+(:)(?!\/\/)/g, repl: "\xA0$1" },
  { reg: /([^\s:\/])(:)(?!\/\/)/g, repl: "$1\xA0$2" },
  // add narrow no break space after «‹
  { reg: /([«‹])/g, repl: "$1\u202F" },
  // no break space after one letter words
  { reg: /\s+([a-zà])\s+/gi, repl: " $1\xA0" },
  // no break space into names
  {
    reg: /([A-ZÀ-ÖØŒ])([A-Za-zÀ-ÖØ-öø-ÿœŒ]+)\s+([A-ZÀ-ÖØŒ])([A-Za-zÀ-ÖØ-öø-ÿœŒ]+)/g,
    repl: "$1$2\xA0$3$4"
  },
  // no break space after abbreviation with period
  {
    reg: /([A-ZÀ-ÖØŒ]\.)\s+([A-ZÀ-ÖØŒ][A-Za-zÀ-ÖØ-öø-ÿœŒ]+)/g,
    repl: "$1\xA0$2"
  },
  // no break space before 'siècles'
  { reg: /(X|I|V)(er|e)\s+siècle/g, repl: "$1$2\xA0si\xE8cle" },
  // add sub
  { reg: /(X|I|V)(er|e)/g, repl: "$1<sup>$2</sup>" },
  // Transformer les guillemets simples à l'intérieur de guillemets doubles en guillemets anglais
  { reg: /(«\u202F[^»]*)'([^’]*)'([^»]*\u202F»)/g, repl: '$1"$2"$3' },
  // ajouter espace après guillemet fermant suivi d'un mot
  { reg: /(»)([A-Za-zÀ-ÖØ-öø-ÿœŒ0-9])/g, repl: "$1 $2" },
  // Transformer les guillemets simples à l'intérieur de guillemets doubles en guillemets anglais
  { reg: /(«\u202F[^»]*)«\u202F([^»]*)\u202F»([^»]*\u202F»)/g, repl: "$1\u201C$2\u201D$3" }
];
var BASE_RULES = [];
function compileRules(settings) {
  let frenchRules = [];
  frenchRules.push(
    {
      reg: new RegExp(`"([A-Za-z\xC0-\xD6\xD8-\xF6\xF8-\xFF\u0153\u0152])`, "g"),
      repl: settings.openDoubleQuote + "$1"
    },
    {
      reg: new RegExp(`([A-Za-z\xC0-\xD6\xD8-\xF6\xF8-\xFF\u0153\u0152][!?;:.,]?)"`, "g"),
      repl: "$1" + settings.closeDoubleQuote
    },
    // Apostrophe typographique personnalisable
    { reg: /\'/g, repl: settings.openSingleQuote }
  );
  if (settings.ellipsisEnabled) {
    frenchRules.push({ reg: /\.{3,}/g, repl: "\u2026" });
  }
  if (settings.guillemetsEnabled) {
    frenchRules.push({ reg: /<</g, repl: "\xAB\u202F" }, { reg: />>/g, repl: "\u202F\xBB" });
  }
  if (settings.frenchRulesEnabled) {
    frenchRules = [...frenchRules, ...FRENCH_RULES];
    frenchRules.push({
      reg: /(«\u202F[^»]*)«\u202F([^»]*)\u202F»([^»]*\u202F»)/g,
      repl: "$1\u201C$2\u201D$3"
    });
  } else {
    frenchRules = [...frenchRules, ...BASE_RULES];
  }
  const dashRules = [];
  if (settings.dashesEnabled) {
    if (settings.skipEnDash) {
      dashRules.push({ reg: /--/g, repl: "\u2014" });
    } else {
      dashRules.push(
        { reg: /--/g, repl: "\u2013" },
        // -- devient –
        { reg: /–-/g, repl: "\u2014" },
        // –- devient —
        { reg: /—-/g, repl: "---" }
        // —- devient ---
      );
    }
  }
  return { frenchRules, dashRules };
}
function applyRules(text, rules) {
  let result = text;
  for (const rule of rules) {
    result = result.replace(rule.reg, rule.repl);
  }
  return result;
}

// src/core/textProcessor.ts
function applyAllRules(text, rules) {
  let result = text;
  const preservedElements = [];
  const patterns = [
    /\[\[.*?\]\]/g,
    // Liens Obsidian [[lien]]
    /\[.*?\]\(.*?\)/g,
    // Liens Markdown [texte](url)
    /!\[.*?\]\(.*?\)/g,
    // Images ![alt](url)
    /`[^`]+`/g,
    // Code inline `code`
    /```[\s\S]*?```/g,
    // Blocs de code
    />\s.*$/gm,
    // Callouts (lignes commençant par "> ")
    /<[^>]*>/g,
    // Balises HTML
    /\$\$[^$]*\$\$/g,
    // Équations mathématiques $$equation$$
    /\$[^$]*\$/g,
    // Équations mathématiques inline $equation$
    /\{[^}]*\}/g,
    // Contenu entre accolades {contenu}
    /https?:\/\/[^\s]+/g,
    // URLs avec http: ou https:
    /[a-z]+:\/\/[^\s]+/g,
    // Autres protocoles (ftp:, file:, etc.)
    /[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+/g
    // Adresses email
  ];
  let tempText = result;
  let elementIndex = 0;
  for (const pattern of patterns) {
    let match;
    let searchText = tempText;
    let replacedText = tempText;
    while ((match = pattern.exec(searchText)) !== null) {
      const placeholder = `__PRESERVED_ELEMENT_${elementIndex}__`;
      preservedElements.push(match[0]);
      replacedText = replacedText.replace(match[0], placeholder);
      elementIndex++;
    }
    tempText = replacedText;
  }
  tempText = applyRules(tempText, rules.frenchRules);
  tempText = applyRules(tempText, rules.dashRules);
  result = tempText;
  for (let i = 0; i < preservedElements.length; i++) {
    const placeholder = `__PRESERVED_ELEMENT_${i}__`;
    result = result.replace(placeholder, preservedElements[i]);
  }
  return result;
}
function processTextWithBlocks(text, blocks, rules) {
  const lines = text.split("\n");
  const processedLines = [];
  let normalTextBuffer = [];
  let lastBlockType = "";
  for (let i = 0; i < lines.length; i++) {
    const currentBlockType = blocks[i];
    const line = lines[i];
    if (currentBlockType === "normal") {
      normalTextBuffer.push(line);
    } else {
      if (normalTextBuffer.length > 0) {
        const processedBuffer = applyAllRules(normalTextBuffer.join("\n"), rules);
        processedLines.push(...processedBuffer.split("\n"));
        normalTextBuffer = [];
      }
      processedLines.push(line);
    }
    lastBlockType = currentBlockType;
  }
  if (normalTextBuffer.length > 0) {
    const processedBuffer = applyAllRules(normalTextBuffer.join("\n"), rules);
    processedLines.push(...processedBuffer.split("\n"));
  }
  return processedLines.join("\n");
}
async function processLargeDocument(text, blocks, rules, callback, batchSize = 500) {
  const lines = text.split("\n");
  const processedLines = [];
  for (let i = 0; i < Math.ceil(lines.length / batchSize); i++) {
    const startIdx = i * batchSize;
    const endIdx = Math.min((i + 1) * batchSize, lines.length);
    const batchLines = lines.slice(startIdx, endIdx);
    const batchBlocks = blocks.slice(startIdx, endIdx);
    const batchText = batchLines.join("\n");
    const processedBatch = processTextWithBlocks(batchText, batchBlocks, rules);
    processedLines.push(...processedBatch.split("\n"));
    if (i < Math.ceil(lines.length / batchSize) - 1) {
      await new Promise((resolve) => setTimeout(resolve, 0));
    }
  }
  callback(processedLines.join("\n"));
}

// src/modules/batchTypography.ts
var BatchTypographyModule = class {
  constructor(settings) {
    this.settings = settings;
  }
  /**
   * Initialise le module avec les paramètres actuels
   * @param settings Paramètres mis à jour
   */
  updateSettings(settings) {
    this.settings = settings;
  }
  /**
   * Applique toutes les règles typographiques sur un texte sélectionné
   * @param editor Éditeur Obsidian
   * @returns true si des modifications ont été appliquées
   */
  applyTypographicRules(editor) {
    const selection = editor.getSelection();
    if (!selection || selection.length === 0) {
      return false;
    }
    const selectionStart = editor.getCursor("from");
    const selectionEnd = editor.getCursor("to");
    const rules = compileRules(this.settings);
    const blocks = analyzeDocumentStructure(
      editor.getValue(),
      selectionStart.line,
      selectionEnd.line
    );
    const processedText = processTextWithBlocks(selection, blocks.lineTypes, rules);
    if (processedText === selection) {
      return false;
    }
    editor.replaceSelection(processedText);
    editor.setSelection(selectionStart, selectionEnd);
    return true;
  }
  /**
   * Traite de grands documents de manière asynchrone
   * @param editor Éditeur Obsidian
   * @param callback Fonction appelée lorsque le traitement est terminé
   */
  async processLargeSelection(editor, callback) {
    const selection = editor.getSelection();
    if (!selection || selection.length === 0) {
      if (callback)
        callback();
      return;
    }
    const selectionStart = editor.getCursor("from");
    const selectionEnd = editor.getCursor("to");
    if (selection.length < 1e4) {
      this.applyTypographicRules(editor);
      if (callback)
        callback();
      return;
    }
    const rules = compileRules(this.settings);
    const blocks = analyzeDocumentStructure(
      editor.getValue(),
      selectionStart.line,
      selectionEnd.line
    );
    await processLargeDocument(
      selection,
      blocks.lineTypes,
      rules,
      (processedText) => {
        editor.replaceSelection(processedText);
        editor.setSelection(selectionStart, selectionEnd);
        if (callback)
          callback();
      }
    );
  }
};

// main.ts
var Microtypographie = class extends import_obsidian3.Plugin {
  constructor() {
    super(...arguments);
    this.statusBarButton = null;
    this.tabTitleBarButton = null;
  }
  async onload() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
    this.liveModule = new LiveTypographyModule(this.settings);
    this.batchModule = new BatchTypographyModule(this.settings);
    this.addSettingTab(new MicrotypographieSettingTab(this.app, this));
    this.registerDomEvent(document, "keydown", this.handleKeyDown.bind(this));
    await injectCSSFromFile(this, "styles/styles.css");
    this.registerEditorExtension(createDecorations(this.settings));
    if (this.settings.highlightButton) {
      this.statusBarButton = createStatusBarButton(
        this,
        this.settings.highlightEnabled,
        this.toggleHighlight.bind(this)
      );
    }
    if (this.settings.tabTitleBarButton) {
      this.tabTitleBarButton = createTabTitleBarButton(
        this,
        this.settings.highlightEnabled,
        this.toggleHighlight.bind(this)
      );
    }
    this.addCommand({
      id: "apply-french-typography",
      name: "Appliquer les r\xE8gles typographiques fran\xE7aises",
      callback: () => {
        const activeView = this.app.workspace.getActiveViewOfType(import_obsidian3.MarkdownView);
        if (activeView) {
          this.batchModule.applyTypographicRules(activeView.editor);
        }
      },
      hotkeys: [{ modifiers: ["Alt"], key: "f" }]
    });
    this.addCommand({
      id: "toggle-highlight",
      name: "Afficher/Masquer les caract\xE8res invisibles",
      callback: () => {
        this.toggleHighlight();
      }
    });
    this.registerEvent(
      this.app.workspace.on("active-leaf-change", () => {
        if (this.settings.tabTitleBarButton) {
          if (this.tabTitleBarButton) {
            this.tabTitleBarButton.remove();
          }
          this.tabTitleBarButton = createTabTitleBarButton(
            this,
            this.settings.highlightEnabled,
            this.toggleHighlight.bind(this)
          );
        }
      })
    );
  }
  // Gérer les événements clavier (délègue au module d'aperçu direct)
  handleKeyDown(event) {
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian3.MarkdownView);
    if (!activeView || activeView.getMode() !== "source") {
      return;
    }
    const leaf = this.app.workspace.getLeaf();
    if (!leaf)
      return;
    const activeState = leaf.getViewState().state;
    if (!activeState)
      return;
    if (activeView && activeView.getMode() === "source" && activeState["source"] === false) {
      this.liveModule.handleKeyEvent(event, activeView.editor);
    }
  }
  async loadSettings() {
    const savedData = await this.loadData();
    this.settings = Object.assign({}, DEFAULT_SETTINGS);
    if (savedData) {
      Object.keys(this.settings).forEach((key) => {
        if (key in savedData) {
          this.settings[key] = savedData[key];
        }
      });
      if ("apostrophe" in savedData || "quotationmarks" in savedData || "emdashes" in savedData) {
        console.log("Migration des param\xE8tres de Microtypographie vers la nouvelle version");
        if (savedData.apostrophe === false) {
          this.settings.openSingleQuote = "'";
          this.settings.closeSingleQuote = "'";
        }
        if (savedData.quotationmarks === false) {
          this.settings.openDoubleQuote = '"';
          this.settings.closeDoubleQuote = '"';
        }
        await this.saveSettings();
      }
    }
  }
  async saveSettings() {
    await this.saveData(this.settings);
    this.liveModule.updateSettings(this.settings);
    this.batchModule.updateSettings(this.settings);
    updateStatusBarButton(this.statusBarButton, this.settings.highlightEnabled);
    updateTabTitleBarButton(this.tabTitleBarButton, this.settings.highlightEnabled);
    this.refreshDecorations();
  }
  // Activer/désactiver la mise en évidence
  toggleHighlight() {
    this.settings.highlightEnabled = !this.settings.highlightEnabled;
    this.saveSettings();
  }
  // Rafraîchir les décorations
  refreshDecorations() {
    this.app.workspace.iterateAllLeaves((leaf) => {
      if (leaf.view instanceof import_obsidian3.MarkdownView && leaf.view.editor) {
        const editorView = leaf.view.editor.cm;
        if (editorView) {
          editorView.dispatch({
            changes: {
              from: 0,
              to: editorView.state.doc.length,
              insert: editorView.state.doc.toString()
            }
          });
        }
      }
    });
  }
  onunload() {
    removeTabTitleBarButton(this.tabTitleBarButton);
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzcmMvc2V0dGluZ3Mvc2V0dGluZ3MudHMiLCAic3JjL3NldHRpbmdzL3NldHRpbmdzVGFiLnRzIiwgInNyYy91aS9kZWNvcmF0aW9ucy50cyIsICJzcmMvdWkvc3RhdHVzQmFyLnRzIiwgInNyYy9jb3JlL2Jsb2NrQW5hbHl6ZXIudHMiLCAic3JjL3V0aWxzL2hlbHBlcnMudHMiLCAic3JjL21vZHVsZXMvbGl2ZVR5cG9ncmFwaHkudHMiLCAic3JjL2NvcmUvdHlwb2dyYXBoeVJ1bGVzLnRzIiwgInNyYy9jb3JlL3RleHRQcm9jZXNzb3IudHMiLCAic3JjL21vZHVsZXMvYmF0Y2hUeXBvZ3JhcGh5LnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBNYXJrZG93blZpZXcsIFBsdWdpbiB9IGZyb20gXCJvYnNpZGlhblwiO1xuLy8gaW1wb3J0IHsgQXBwLCBFZGl0b3IsIE1hcmtkb3duVmlldywgTW9kYWwsIE5vdGljZSwgUGx1Z2luLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgTWljcm90eXBvZ3JhcGhpZVNldHRpbmdzLCBERUZBVUxUX1NFVFRJTkdTIH0gZnJvbSAnLi9zcmMvc2V0dGluZ3Mvc2V0dGluZ3MnO1xuaW1wb3J0IHsgTWljcm90eXBvZ3JhcGhpZVNldHRpbmdUYWIgfSBmcm9tICcuL3NyYy9zZXR0aW5ncy9zZXR0aW5nc1RhYic7XG5pbXBvcnQgeyBjcmVhdGVEZWNvcmF0aW9ucyB9IGZyb20gJy4vc3JjL3VpL2RlY29yYXRpb25zJztcbmltcG9ydCB7IFxuICAgIGNyZWF0ZVN0YXR1c0JhckJ1dHRvbiwgXG4gICAgdXBkYXRlU3RhdHVzQmFyQnV0dG9uLCBcbiAgICBjcmVhdGVUYWJUaXRsZUJhckJ1dHRvbiwgXG4gICAgdXBkYXRlVGFiVGl0bGVCYXJCdXR0b24sIFxuICAgIHJlbW92ZVRhYlRpdGxlQmFyQnV0dG9uIFxufSBmcm9tICcuL3NyYy91aS9zdGF0dXNCYXInO1xuaW1wb3J0IHsgaW5qZWN0Q1NTRnJvbUZpbGUgfSBmcm9tICcuL3NyYy91dGlscy9oZWxwZXJzJztcblxuLy8gSW1wb3J0ZXIgbGVzIG5vdXZlYXV4IG1vZHVsZXNcbmltcG9ydCB7IExpdmVUeXBvZ3JhcGh5TW9kdWxlIH0gZnJvbSAnLi9zcmMvbW9kdWxlcy9saXZlVHlwb2dyYXBoeSc7XG5pbXBvcnQgeyBCYXRjaFR5cG9ncmFwaHlNb2R1bGUgfSBmcm9tICcuL3NyYy9tb2R1bGVzL2JhdGNoVHlwb2dyYXBoeSc7XG5cbmltcG9ydCB7IEVkaXRvclZpZXcgfSBmcm9tIFwiQGNvZGVtaXJyb3Ivdmlld1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNaWNyb3R5cG9ncmFwaGllIGV4dGVuZHMgUGx1Z2luIHtcbiAgICBzZXR0aW5nczogTWljcm90eXBvZ3JhcGhpZVNldHRpbmdzO1xuICAgIHByaXZhdGUgc3RhdHVzQmFyQnV0dG9uOiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsO1xuICAgIHByaXZhdGUgdGFiVGl0bGVCYXJCdXR0b246IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XG4gICAgXG4gICAgLy8gSW5zdGFuY2VzIGRlcyBtb2R1bGVzXG4gICAgcHJpdmF0ZSBsaXZlTW9kdWxlOiBMaXZlVHlwb2dyYXBoeU1vZHVsZTtcbiAgICBwcml2YXRlIGJhdGNoTW9kdWxlOiBCYXRjaFR5cG9ncmFwaHlNb2R1bGU7XG5cbiAgICBhc3luYyBvbmxvYWQoKSB7XG4gICAgICAgIC8vIENoYXJnZXIgbGVzIHBhcmFtXHUwMEU4dHJlc1xuICAgICAgICB0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgYXdhaXQgdGhpcy5sb2FkRGF0YSgpKTtcbiAgICBcbiAgICAgICAgLy8gSW5pdGlhbGlzZXIgbGVzIG1vZHVsZXNcbiAgICAgICAgdGhpcy5saXZlTW9kdWxlID0gbmV3IExpdmVUeXBvZ3JhcGh5TW9kdWxlKHRoaXMuc2V0dGluZ3MpO1xuICAgICAgICB0aGlzLmJhdGNoTW9kdWxlID0gbmV3IEJhdGNoVHlwb2dyYXBoeU1vZHVsZSh0aGlzLnNldHRpbmdzKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEFqb3V0ZXIgbCdvbmdsZXQgZGUgcGFyYW1cdTAwRTh0cmVzXG4gICAgICAgIHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgTWljcm90eXBvZ3JhcGhpZVNldHRpbmdUYWIodGhpcy5hcHAsIHRoaXMpKTtcbiAgICBcbiAgICAgICAgLy8gRW5yZWdpc3RyZXIgbCdcdTAwRTl2XHUwMEU5bmVtZW50IGtleWRvd24gcG91ciBsZSBtb2R1bGUgZCdhcGVyXHUwMEU3dSBkaXJlY3RcbiAgICAgICAgdGhpcy5yZWdpc3RlckRvbUV2ZW50KGRvY3VtZW50LCAna2V5ZG93bicsIHRoaXMuaGFuZGxlS2V5RG93bi5iaW5kKHRoaXMpKTtcbiAgICBcbiAgICAgICAgLy8gSW5qZWN0ZXIgbGUgQ1NTIHBvdXIgbGEgbWlzZSBlbiBcdTAwRTl2aWRlbmNlXG4gICAgICAgIGF3YWl0IGluamVjdENTU0Zyb21GaWxlKHRoaXMsIFwic3R5bGVzL3N0eWxlcy5jc3NcIik7XG5cbiAgICAgICAgLy8gRW5yZWdpc3RyZXIgbCdleHRlbnNpb24gZGUgbCdcdTAwRTlkaXRldXIgcG91ciBsZXMgZFx1MDBFOWNvcmF0aW9uc1xuICAgICAgICB0aGlzLnJlZ2lzdGVyRWRpdG9yRXh0ZW5zaW9uKGNyZWF0ZURlY29yYXRpb25zKHRoaXMuc2V0dGluZ3MpKTtcblxuICAgICAgICAvLyBBam91dGVyIGxlIGJvdXRvbiBkYW5zIGxhIGJhcnJlIGQnXHUwMEU5dGF0IHNpIGwnb3B0aW9uIGVzdCBhY3Rpdlx1MDBFOWVcbiAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuaGlnaGxpZ2h0QnV0dG9uKSB7XG4gICAgICAgICAgICB0aGlzLnN0YXR1c0JhckJ1dHRvbiA9IGNyZWF0ZVN0YXR1c0JhckJ1dHRvbihcbiAgICAgICAgICAgICAgICB0aGlzLCBcbiAgICAgICAgICAgICAgICB0aGlzLnNldHRpbmdzLmhpZ2hsaWdodEVuYWJsZWQsXG4gICAgICAgICAgICAgICAgdGhpcy50b2dnbGVIaWdobGlnaHQuYmluZCh0aGlzKVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgXG4gICAgICAgIC8vIEFqb3V0ZXIgbGUgYm91dG9uIGRhbnMgbGEgYmFycmUgZGUgdGl0cmUgZGVzIG9uZ2xldHMgc2kgbCdvcHRpb24gZXN0IGFjdGl2XHUwMEU5ZVxuICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy50YWJUaXRsZUJhckJ1dHRvbikge1xuICAgICAgICAgICAgdGhpcy50YWJUaXRsZUJhckJ1dHRvbiA9IGNyZWF0ZVRhYlRpdGxlQmFyQnV0dG9uKFxuICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5oaWdobGlnaHRFbmFibGVkLFxuICAgICAgICAgICAgICAgIHRoaXMudG9nZ2xlSGlnaGxpZ2h0LmJpbmQodGhpcylcbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIEFqb3V0ZXIgbGEgY29tbWFuZGUgcG91ciBhcHBsaXF1ZXIgbGVzIHJcdTAwRThnbGVzIHR5cG9ncmFwaGlxdWVzICh2aWEgbGUgbW9kdWxlIGRlIHRyYWl0ZW1lbnQgcGFyIGxvdClcbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIGlkOiAnYXBwbHktZnJlbmNoLXR5cG9ncmFwaHknLFxuICAgICAgICAgICAgbmFtZTogJ0FwcGxpcXVlciBsZXMgclx1MDBFOGdsZXMgdHlwb2dyYXBoaXF1ZXMgZnJhblx1MDBFN2Fpc2VzJyxcbiAgICAgICAgICAgIGNhbGxiYWNrOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgYWN0aXZlVmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XG4gICAgICAgICAgICAgICAgaWYgKGFjdGl2ZVZpZXcpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5iYXRjaE1vZHVsZS5hcHBseVR5cG9ncmFwaGljUnVsZXMoYWN0aXZlVmlldy5lZGl0b3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBob3RrZXlzOiBbeyBtb2RpZmllcnM6IFtcIkFsdFwiXSwga2V5OiBcImZcIiB9XVxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBBam91dGVyIGxhIGNvbW1hbmRlIHBvdXIgYWN0aXZlci9kXHUwMEU5c2FjdGl2ZXIgbGEgbWlzZSBlbiBcdTAwRTl2aWRlbmNlXG4gICAgICAgIHRoaXMuYWRkQ29tbWFuZCh7XG4gICAgICAgICAgICBpZDogJ3RvZ2dsZS1oaWdobGlnaHQnLFxuICAgICAgICAgICAgbmFtZTogJ0FmZmljaGVyL01hc3F1ZXIgbGVzIGNhcmFjdFx1MDBFOHJlcyBpbnZpc2libGVzJyxcbiAgICAgICAgICAgIGNhbGxiYWNrOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy50b2dnbGVIaWdobGlnaHQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICAvLyBFbnJlZ2lzdHJlciB1biBcdTAwRTl2XHUwMEU5bmVtZW50IHBvdXIgbWV0dHJlIFx1MDBFMCBqb3VyIGxlIGJvdXRvbiBkZSBsYSBiYXJyZSBkZSB0aXRyZVxuICAgICAgICAvLyBsb3JzcXVlIGwndXRpbGlzYXRldXIgY2hhbmdlIGQnb25nbGV0IG91IGRlIHZ1ZVxuICAgICAgICB0aGlzLnJlZ2lzdGVyRXZlbnQoXG4gICAgICAgICAgICB0aGlzLmFwcC53b3Jrc3BhY2Uub24oJ2FjdGl2ZS1sZWFmLWNoYW5nZScsICgpID0+IHtcbiAgICAgICAgICAgICAgICAvLyBSZWNyXHUwMEU5ZXIgbGUgYm91dG9uIGRlIGxhIGJhcnJlIGRlIHRpdHJlIHNpIGwnb3B0aW9uIGVzdCBhY3Rpdlx1MDBFOWVcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy50YWJUaXRsZUJhckJ1dHRvbikge1xuICAgICAgICAgICAgICAgICAgICAvLyBTdXBwcmltZXIgbCdhbmNpZW4gYm91dG9uIHMnaWwgZXhpc3RlXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnRhYlRpdGxlQmFyQnV0dG9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRhYlRpdGxlQmFyQnV0dG9uLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBDclx1MDBFOWVyIHVuIG5vdXZlYXUgYm91dG9uXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudGFiVGl0bGVCYXJCdXR0b24gPSBjcmVhdGVUYWJUaXRsZUJhckJ1dHRvbihcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldHRpbmdzLmhpZ2hsaWdodEVuYWJsZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRvZ2dsZUhpZ2hsaWdodC5iaW5kKHRoaXMpXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICAvLyBHXHUwMEU5cmVyIGxlcyBcdTAwRTl2XHUwMEU5bmVtZW50cyBjbGF2aWVyIChkXHUwMEU5bFx1MDBFOGd1ZSBhdSBtb2R1bGUgZCdhcGVyXHUwMEU3dSBkaXJlY3QpXG4gICAgcHJpdmF0ZSBoYW5kbGVLZXlEb3duKGV2ZW50OiBLZXlib2FyZEV2ZW50KSB7XG4gICAgICAgIGNvbnN0IGFjdGl2ZVZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuICAgICAgICBpZiAoIWFjdGl2ZVZpZXcgfHwgYWN0aXZlVmlldy5nZXRNb2RlKCkgIT09ICdzb3VyY2UnKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICBcbiAgICAgICAgY29uc3QgbGVhZiA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWFmKCk7XG4gICAgICAgIGlmICghbGVhZikgcmV0dXJuO1xuICAgIFxuICAgICAgICBjb25zdCBhY3RpdmVTdGF0ZSA9IGxlYWYuZ2V0Vmlld1N0YXRlKCkuc3RhdGU7XG4gICAgICAgIGlmICghYWN0aXZlU3RhdGUpIHJldHVybjtcbiAgICBcbiAgICAgICAgaWYgKGFjdGl2ZVZpZXcgJiYgYWN0aXZlVmlldy5nZXRNb2RlKCkgPT09ICdzb3VyY2UnICYmIGFjdGl2ZVN0YXRlW1wic291cmNlXCJdID09PSBmYWxzZSkge1xuICAgICAgICAgICAgLy8gRFx1MDBFOWxcdTAwRTlndWVyIGxlIHRyYWl0ZW1lbnQgYXUgbW9kdWxlIGQnYXBlclx1MDBFN3UgZGlyZWN0XG4gICAgICAgICAgICB0aGlzLmxpdmVNb2R1bGUuaGFuZGxlS2V5RXZlbnQoZXZlbnQsIGFjdGl2ZVZpZXcuZWRpdG9yKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcbiAgICAgICAgLy8gQ2hhcmdlciBsZXMgZG9ublx1MDBFOWVzIGJydXRlcyBzYXV2ZWdhcmRcdTAwRTllc1xuICAgICAgICBjb25zdCBzYXZlZERhdGEgPSBhd2FpdCB0aGlzLmxvYWREYXRhKCk7XG4gICAgICAgIFxuICAgICAgICAvLyBDclx1MDBFOWVyIHVuIG5vdXZlbCBvYmpldCBkZSBwYXJhbVx1MDBFOHRyZXMgZW4gcGFydGFudCBkZXMgdmFsZXVycyBwYXIgZFx1MDBFOWZhdXRcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MpO1xuICAgICAgICBcbiAgICAgICAgLy8gU2kgZGVzIHBhcmFtXHUwMEU4dHJlcyBvbnQgXHUwMEU5dFx1MDBFOSBzYXV2ZWdhcmRcdTAwRTlzLCBsZXMgY29waWVyIGRhbnMgbGVzIG5vdXZlbGxlcyBwcm9wcmlcdTAwRTl0XHUwMEU5c1xuICAgICAgICBpZiAoc2F2ZWREYXRhKSB7XG4gICAgICAgICAgICAvLyBDb3BpZXIgdW5pcXVlbWVudCBsZXMgcHJvcHJpXHUwMEU5dFx1MDBFOXMgcXVpIGV4aXN0ZW50IGRhbnMgbGEgbm91dmVsbGUgaW50ZXJmYWNlXG4gICAgICAgICAgICBPYmplY3Qua2V5cyh0aGlzLnNldHRpbmdzKS5mb3JFYWNoKGtleSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGtleSBpbiBzYXZlZERhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgKHRoaXMuc2V0dGluZ3MgYXMgYW55KVtrZXldID0gKHNhdmVkRGF0YSBhcyBhbnkpW2tleV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIE1pZ3JhdGlvbiBkZXMgYW5jaWVubmVzIHByb3ByaVx1MDBFOXRcdTAwRTlzIHZlcnMgbGVzIG5vdXZlbGxlc1xuICAgICAgICAgICAgLy8gQ2V0dGUgcGFydGllIGVzdCBleFx1MDBFOWN1dFx1MDBFOWUgc2V1bGVtZW50IHNpIGxlcyBhbmNpZW5uZXMgcHJvcHJpXHUwMEU5dFx1MDBFOXMgZXhpc3RlbnRcbiAgICAgICAgICAgIGlmICgnYXBvc3Ryb3BoZScgaW4gc2F2ZWREYXRhIHx8ICdxdW90YXRpb25tYXJrcycgaW4gc2F2ZWREYXRhIHx8ICdlbWRhc2hlcycgaW4gc2F2ZWREYXRhKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJNaWdyYXRpb24gZGVzIHBhcmFtXHUwMEU4dHJlcyBkZSBNaWNyb3R5cG9ncmFwaGllIHZlcnMgbGEgbm91dmVsbGUgdmVyc2lvblwiKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBTaSBjZXMgYW5jaWVubmVzIG9wdGlvbnMgXHUwMEU5dGFpZW50IGRcdTAwRTlzYWN0aXZcdTAwRTllcywgb24gdmlkZSBsZXMgcGFyYW1cdTAwRTh0cmVzIGNvcnJlc3BvbmRhbnRzXG4gICAgICAgICAgICAgICAgLy8gcG91ciBkXHUwMEU5c2FjdGl2ZXIgbGVzIGZvbmN0aW9ubmFsaXRcdTAwRTlzXG4gICAgICAgICAgICAgICAgaWYgKHNhdmVkRGF0YS5hcG9zdHJvcGhlID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldHRpbmdzLm9wZW5TaW5nbGVRdW90ZSA9IFwiJ1wiOyAgLy8gQXBvc3Ryb3BoZSBzdGFuZGFyZFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldHRpbmdzLmNsb3NlU2luZ2xlUXVvdGUgPSBcIidcIjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYgKHNhdmVkRGF0YS5xdW90YXRpb25tYXJrcyA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5vcGVuRG91YmxlUXVvdGUgPSBcIlxcXCJcIjsgIC8vIEd1aWxsZW1ldCBzdGFuZGFyZFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldHRpbmdzLmNsb3NlRG91YmxlUXVvdGUgPSBcIlxcXCJcIjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gU2F1dmVnYXJkZXIgaW1tXHUwMEU5ZGlhdGVtZW50IGxlcyBwYXJhbVx1MDBFOHRyZXMgbWlnclx1MDBFOXNcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgYXN5bmMgc2F2ZVNldHRpbmdzKCkge1xuICAgICAgICBhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpO1xuICAgICAgICBcbiAgICAgIFxuXG4gICAgICAgIC8vIE1ldHRyZSBcdTAwRTAgam91ciBsZXMgbW9kdWxlcyBhdmVjIGxlcyBub3V2ZWF1eCBwYXJhbVx1MDBFOHRyZXNcbiAgICAgICAgdGhpcy5saXZlTW9kdWxlLnVwZGF0ZVNldHRpbmdzKHRoaXMuc2V0dGluZ3MpO1xuICAgICAgICB0aGlzLmJhdGNoTW9kdWxlLnVwZGF0ZVNldHRpbmdzKHRoaXMuc2V0dGluZ3MpO1xuICAgICAgICBcbiAgICAgICAgLy8gTWV0dHJlIFx1MDBFMCBqb3VyIGwnVUlcbiAgICAgICAgdXBkYXRlU3RhdHVzQmFyQnV0dG9uKHRoaXMuc3RhdHVzQmFyQnV0dG9uLCB0aGlzLnNldHRpbmdzLmhpZ2hsaWdodEVuYWJsZWQpO1xuICAgICAgICB1cGRhdGVUYWJUaXRsZUJhckJ1dHRvbih0aGlzLnRhYlRpdGxlQmFyQnV0dG9uLCB0aGlzLnNldHRpbmdzLmhpZ2hsaWdodEVuYWJsZWQpO1xuICAgICAgICB0aGlzLnJlZnJlc2hEZWNvcmF0aW9ucygpO1xuICAgIH1cblxuICAgIC8vIEFjdGl2ZXIvZFx1MDBFOXNhY3RpdmVyIGxhIG1pc2UgZW4gXHUwMEU5dmlkZW5jZVxuICAgIHRvZ2dsZUhpZ2hsaWdodCgpIHtcbiAgICAgICAgdGhpcy5zZXR0aW5ncy5oaWdobGlnaHRFbmFibGVkID0gIXRoaXMuc2V0dGluZ3MuaGlnaGxpZ2h0RW5hYmxlZDtcbiAgICAgICAgdGhpcy5zYXZlU2V0dGluZ3MoKTtcbiAgICB9XG5cbiAgICAvLyBSYWZyYVx1MDBFRWNoaXIgbGVzIGRcdTAwRTljb3JhdGlvbnNcbiAgICByZWZyZXNoRGVjb3JhdGlvbnMoKSB7XG4gICAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS5pdGVyYXRlQWxsTGVhdmVzKChsZWFmKSA9PiB7XG4gICAgICAgICAgICBpZiAobGVhZi52aWV3IGluc3RhbmNlb2YgTWFya2Rvd25WaWV3ICYmIGxlYWYudmlldy5lZGl0b3IpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBlZGl0b3JWaWV3ID0gKGxlYWYudmlldy5lZGl0b3IgYXMgYW55KS5jbSBhcyBFZGl0b3JWaWV3O1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGlmIChlZGl0b3JWaWV3KSB7XG4gICAgICAgICAgICAgICAgICAgIGVkaXRvclZpZXcuZGlzcGF0Y2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyb206IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG86IGVkaXRvclZpZXcuc3RhdGUuZG9jLmxlbmd0aCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnNlcnQ6IGVkaXRvclZpZXcuc3RhdGUuZG9jLnRvU3RyaW5nKClcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBvbnVubG9hZCgpIHtcbiAgICAgICAgLy8gTmV0dG95ZXIgbGVzIFx1MDBFOWxcdTAwRTltZW50cyBVSVxuICAgICAgICByZW1vdmVUYWJUaXRsZUJhckJ1dHRvbih0aGlzLnRhYlRpdGxlQmFyQnV0dG9uKTtcbiAgICB9XG59IiwgIi8vIEZpY2hpZXIgc2V0dGluZ3MudHMgYXZlYyBsZXMgbm91dmVsbGVzIG9wdGlvbnNcclxuXHJcbi8qKlxyXG4gKiBJbnRlcmZhY2UgcG91ciBsZXMgcGFyYW1cdTAwRTh0cmVzIGR1IHBsdWdpblxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBNaWNyb3R5cG9ncmFwaGllU2V0dGluZ3Mge1xyXG4gICAgb3BlbkRvdWJsZVF1b3RlOiBzdHJpbmc7XHJcbiAgICBjbG9zZURvdWJsZVF1b3RlOiBzdHJpbmc7XHJcbiAgICBvcGVuU2luZ2xlUXVvdGU6IHN0cmluZztcclxuICAgIGNsb3NlU2luZ2xlUXVvdGU6IHN0cmluZztcclxuICAgIGZyZW5jaFJ1bGVzRW5hYmxlZDogYm9vbGVhbjtcclxuICAgIGRhc2hlc0VuYWJsZWQ6IGJvb2xlYW47ICAgICAvLyBDb252ZXJ0aXIgLS0gZW4gXHUyMDEzLCBcdTIwMTMtIGVuIFx1MjAxNCwgXHUyMDE0LSBlbiAtLS1cclxuICAgIHNraXBFbkRhc2g6IGJvb2xlYW47ICAgICAgICAvLyBDb252ZXJ0aXIgZGlyZWN0ZW1lbnQgLS0gZW4gXHUyMDE0IChzYXV0ZXIgbGUgdGlyZXQgZGVtaS1jYWRyYXRpbilcclxuICAgIGVsbGlwc2lzRW5hYmxlZDogYm9vbGVhbjsgICAvLyBDb252ZXJ0aXIgLi4uIGVuIFx1MjAyNlxyXG4gICAgZ3VpbGxlbWV0c0VuYWJsZWQ6IGJvb2xlYW47IC8vIENvbnZlcnRpciA8PCBldCA+PiBlbiBcdTAwQUIgZXQgXHUwMEJCXHJcbiAgICBoaWdobGlnaHRFbmFibGVkOiBib29sZWFuO1xyXG4gICAgaGlnaGxpZ2h0QnV0dG9uOiBib29sZWFuO1xyXG4gICAgdGFiVGl0bGVCYXJCdXR0b246IGJvb2xlYW47IC8vIEJvdXRvbiBkYW5zIGxhIGJhcnJlIGRlIHRpdHJlIGRlcyBvbmdsZXRzXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBQYXJhbVx1MDBFOHRyZXMgcGFyIGRcdTAwRTlmYXV0XHJcbiAqL1xyXG5leHBvcnQgY29uc3QgREVGQVVMVF9TRVRUSU5HUzogTWljcm90eXBvZ3JhcGhpZVNldHRpbmdzID0ge1xyXG4gICAgb3BlbkRvdWJsZVF1b3RlOiBcIlx1MDBBQlxcdTIwMkZcIiwgIC8vIEd1aWxsZW1ldCBmcmFuXHUwMEU3YWlzIG91dnJhbnQgYXZlYyBlc3BhY2UgZmluZSBpbnNcdTAwRTljYWJsZVxyXG4gICAgY2xvc2VEb3VibGVRdW90ZTogXCJcXHUyMDJGXHUwMEJCXCIsIC8vIEd1aWxsZW1ldCBmcmFuXHUwMEU3YWlzIGZlcm1hbnQgYXZlYyBlc3BhY2UgZmluZSBpbnNcdTAwRTljYWJsZVxyXG4gICAgb3BlblNpbmdsZVF1b3RlOiBcIlx1MjAxQ1wiLCAgICAgICAgLy8gQXBvc3Ryb3BoZSB0eXBvZ3JhcGhpcXVlXHJcbiAgICBjbG9zZVNpbmdsZVF1b3RlOiBcIlx1MjAxRFwiLCAgICAgICAvLyBBcG9zdHJvcGhlIHR5cG9ncmFwaGlxdWVcclxuICAgIGZyZW5jaFJ1bGVzRW5hYmxlZDogdHJ1ZSxcclxuICAgIGRhc2hlc0VuYWJsZWQ6IHRydWUsXHJcbiAgICBza2lwRW5EYXNoOiBmYWxzZSxcclxuICAgIGVsbGlwc2lzRW5hYmxlZDogdHJ1ZSxcclxuICAgIGd1aWxsZW1ldHNFbmFibGVkOiBmYWxzZSxcclxuICAgIGhpZ2hsaWdodEVuYWJsZWQ6IGZhbHNlLFxyXG4gICAgaGlnaGxpZ2h0QnV0dG9uOiB0cnVlLFxyXG4gICAgdGFiVGl0bGVCYXJCdXR0b246IHRydWUsICAgICAvLyBBY3Rpdlx1MDBFOSBwYXIgZFx1MDBFOWZhdXRcclxufTtcclxuXHJcblxyXG4vKipcclxuICogVlx1MDBFOXJpZmllIHNpIGxlcyBwYXJhbVx1MDBFOHRyZXMgc29udCB2YWxpZGVzIGV0IGNvbXBsZXRzXHJcbiAqIEBwYXJhbSBzZXR0aW5ncyBQYXJhbVx1MDBFOHRyZXMgXHUwMEUwIHZcdTAwRTlyaWZpZXJcclxuICogQHJldHVybnMgUGFyYW1cdTAwRTh0cmVzIHZhbGlkXHUwMEU5cyBldCBjb21wbFx1MDBFOXRcdTAwRTlzIHNpIG5cdTAwRTljZXNzYWlyZVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlU2V0dGluZ3Moc2V0dGluZ3M6IFBhcnRpYWw8TWljcm90eXBvZ3JhcGhpZVNldHRpbmdzPik6IE1pY3JvdHlwb2dyYXBoaWVTZXR0aW5ncyB7XHJcbiAgICBjb25zdCB2YWxpZGF0ZWRTZXR0aW5ncyA9IHsgLi4uREVGQVVMVF9TRVRUSU5HUyB9O1xyXG4gICAgXHJcbiAgICBpZiAoc2V0dGluZ3MpIHtcclxuICAgICAgICBPYmplY3Qua2V5cyhERUZBVUxUX1NFVFRJTkdTKS5mb3JFYWNoKGtleSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChrZXkgaW4gc2V0dGluZ3MpIHtcclxuICAgICAgICAgICAgICAgICh2YWxpZGF0ZWRTZXR0aW5ncyBhcyBhbnkpW2tleV0gPSAoc2V0dGluZ3MgYXMgYW55KVtrZXldO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJldHVybiB2YWxpZGF0ZWRTZXR0aW5ncztcclxufSIsICJpbXBvcnQgeyBBcHAsIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuLy8gaW1wb3J0IHsgTWljcm90eXBvZ3JhcGhpZVNldHRpbmdzIH0gZnJvbSBcIi4vc2V0dGluZ3NcIjtcclxuaW1wb3J0IHR5cGUgTWljcm90eXBvZ3JhcGhpZSBmcm9tIFwiLi4vLi4vbWFpblwiO1xyXG5cclxuLyoqXHJcbiAqIE9uZ2xldCBkZSBjb25maWd1cmF0aW9uIGR1IHBsdWdpbiBkYW5zIGxlcyBwYXJhbVx1MDBFOHRyZXMgZCdPYnNpZGlhblxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIE1pY3JvdHlwb2dyYXBoaWVTZXR0aW5nVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XHJcbiAgcGx1Z2luOiBNaWNyb3R5cG9ncmFwaGllO1xyXG4gIHByaXZhdGUgd29yZHNJbnB1dENvbnRhaW5lcjogSFRNTEVsZW1lbnQ7IC8vIFBvdXIgc3RvY2tlciBsYSByXHUwMEU5Zlx1MDBFOXJlbmNlIGF1IGNvbnRhaW5lciBkdSBjaGFtcCBkZSB0ZXh0ZVxyXG5cclxuICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBNaWNyb3R5cG9ncmFwaGllKSB7XHJcbiAgICBzdXBlcihhcHAsIHBsdWdpbik7XHJcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcclxuICB9XHJcblxyXG4gIGRpc3BsYXkoKTogdm9pZCB7XHJcbiAgICBjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xyXG5cclxuICAgIGNvbnRhaW5lckVsLmVtcHR5KCk7XHJcblxyXG4gICAgY29udGFpbmVyRWwuY3JlYXRlRWwoXCJoM1wiLCB7IHRleHQ6IFwiTWljcm90eXBvZ3JhcGhpZVwiIH0pO1xyXG5cclxuICAgIC8vIEJsb2MgZCdpbmZvcm1hdGlvblxyXG4gICAgLy8gdGhpcy5jcmVhdGVJbmZvQmxvY2soY29udGFpbmVyRWwpO1xyXG5cclxuICAgIC8vIFBhcmFtXHUwMEU4dHJlcyBkZSBiYXNlXHJcbiAgICB0aGlzLmNyZWF0ZUJhc2ljU2V0dGluZ3MoY29udGFpbmVyRWwpO1xyXG5cclxuICAgIC8vIFBhcmFtXHUwMEU4dHJlcyBkZSBtaXNlIGVuIFx1MDBFOXZpZGVuY2VcclxuICAgIHRoaXMuY3JlYXRlSGlnaGxpZ2h0U2V0dGluZ3MoY29udGFpbmVyRWwpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ3JcdTAwRTllIGxlIGJsb2MgZCdpbmZvcm1hdGlvblxyXG4gICAqIEBwYXJhbSBjb250YWluZXJFbCBDb250ZW5ldXIgcGFyZW50XHJcbiAgICovXHJcbiAgcHJpdmF0ZSBjcmVhdGVJbmZvQmxvY2soY29udGFpbmVyRWw6IEhUTUxFbGVtZW50KTogdm9pZCB7XHJcbiAgICBjb25zdCBpbmZvQ29udGFpbmVyID0gY29udGFpbmVyRWwuY3JlYXRlRWwoXCJkaXZcIiwge1xyXG4gICAgICBjbHM6IFwibWljcm90eXBvZ3JhcGhpZS1pbmZvLWNvbnRhaW5lclwiLFxyXG4gICAgfSk7XHJcblxyXG4gICAgY29uc3QgaW5mb0NvbnRlbnQgPSBpbmZvQ29udGFpbmVyLmNyZWF0ZUVsKFwiZGl2XCIsIHtcclxuICAgICAgY2xzOiBcIm1pY3JvdHlwb2dyYXBoaWUtaW5mby1jb250ZW50XCIsXHJcbiAgICB9KTtcclxuXHJcbiAgICBpbmZvQ29udGVudC5jcmVhdGVFbChcInBcIiwge1xyXG4gICAgICB0ZXh0OiBcIkNlIHBsdWdpbiBhcHBsaXF1ZSBhdXRvbWF0aXF1ZW1lbnQgdW5lIHBhcnRpZSBkZXMgclx1MDBFOGdsZXMgdHlwb2dyYXBoaXF1ZXMgZnJhblx1MDBFN2Fpc2VzIHBlbmRhbnQgbGEgc2Fpc2llLlwiLFxyXG4gICAgfSk7XHJcblxyXG4gICAgY29uc3QgcnVsZXNMaXN0ID0gaW5mb0NvbnRlbnQuY3JlYXRlRWwoXCJ1bFwiKTtcclxuICAgIHJ1bGVzTGlzdC5jcmVhdGVFbChcImxpXCIsIHtcclxuICAgICAgdGV4dDogXCJFc3BhY2VzIGluc1x1MDBFOWNhYmxlcyBhdmFudCBsZXMgcG9uY3R1YXRpb25zIGRvdWJsZXMgKCEgPyA7IFx1MDBCQilcIixcclxuICAgIH0pO1xyXG4gICAgcnVsZXNMaXN0LmNyZWF0ZUVsKFwibGlcIiwgeyB0ZXh0OiBcIkVzcGFjZXMgZmluZXMgaW5zXHUwMEU5Y2FibGVzIGF2YW50ICg6KVwiIH0pO1xyXG4gICAgcnVsZXNMaXN0LmNyZWF0ZUVsKFwibGlcIiwge1xyXG4gICAgICB0ZXh0OiBcIkVzcGFjZXMgZmluZXMgaW5zXHUwMEU5Y2FibGVzIGRhbnMgbGVzIGd1aWxsZW1ldHMgZnJhblx1MDBFN2FpcyAoXHUwMEFCXFx1MjAyRnBocmFzZVxcdTIwMkZcdTAwQkIpXCIsXHJcbiAgICB9KTtcclxuICAgIHJ1bGVzTGlzdC5jcmVhdGVFbChcImxpXCIsIHsgdGV4dDogXCJBcG9zdHJvcGhlIHR5cG9ncmFwaGlxdWUgKFx1MjAxOSlcIiB9KTtcclxuICAgIHJ1bGVzTGlzdC5jcmVhdGVFbChcImxpXCIsIHtcclxuICAgICAgdGV4dDogXCJDb252ZXJzaW9uIGRlICgtLSkgZW4gdGlyZXQgY2FkcmF0aW4gKFx1MjAxNClcIixcclxuICAgIH0pO1xyXG5cclxuICAgIGluZm9Db250ZW50LmNyZWF0ZUVsKFwicFwiLCB7XHJcbiAgICAgIHRleHQ6IFwiVXRpbGlzZXogQWx0K0YgcG91ciBhcHBsaXF1ZXIgdG91dGVzIGxlcyByXHUwMEU4Z2xlcyBzdXIgdW4gdGV4dGUgZXhpc3RhbnQuXCIsXHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zdCB0cmFuc2Zvcm1hdGlvbnNMaXN0ID0gaW5mb0NvbnRlbnQuY3JlYXRlRWwoXCJ1bFwiKTtcclxuICAgIHRyYW5zZm9ybWF0aW9uc0xpc3QuY3JlYXRlRWwoXCJsaVwiLCB7XHJcbiAgICAgIHRleHQ6ICdDb252ZXJzaW9uIGRlIChcIiBcIikgZW4gZ3VpbGxlbWV0cyBmcmFuXHUwMEU3YWlzIChcdTAwQUIgXHUwMEJCKScsXHJcbiAgICB9KTtcclxuICAgIHRyYW5zZm9ybWF0aW9uc0xpc3QuY3JlYXRlRWwoXCJsaVwiLCB7XHJcbiAgICAgIHRleHQ6IFwiQ29udmVyc2lvbiBkZSAnIGVuIGFwb3N0cm9waGUgdHlwb2dyYXBoaXF1ZSAoXHUyMDE5KVwiLFxyXG4gICAgfSk7XHJcbiAgICB0cmFuc2Zvcm1hdGlvbnNMaXN0LmNyZWF0ZUVsKFwibGlcIiwge1xyXG4gICAgICB0ZXh0OiBcIkVzcGFjZSBmaW5lIGluc1x1MDBFOWNhYmxlIGF2YW50IDogKCEgPyA7IFx1MDBCQiBcdTIwM0EpXCIsXHJcbiAgICB9KTtcclxuICAgIHRyYW5zZm9ybWF0aW9uc0xpc3QuY3JlYXRlRWwoXCJsaVwiLCB7XHJcbiAgICAgIHRleHQ6IFwiRXNwYWNlIGluc1x1MDBFOWNhYmxlIGF2YW50IDogKDopXCIsXHJcbiAgICB9KTtcclxuICAgIHRyYW5zZm9ybWF0aW9uc0xpc3QuY3JlYXRlRWwoXCJsaVwiLCB7XHJcbiAgICAgIHRleHQ6IFwiRXNwYWNlIGZpbmUgaW5zXHUwMEU5Y2FibGUgYXByXHUwMEU4cyA6IChcdTAwQUIgXHUyMDM5KVwiLFxyXG4gICAgfSk7XHJcbiAgICB0cmFuc2Zvcm1hdGlvbnNMaXN0LmNyZWF0ZUVsKFwibGlcIiwge1xyXG4gICAgICB0ZXh0OiBcIkVzcGFjZSBpbnNcdTAwRTljYWJsZSBhcHJcdTAwRThzIGxlcyBtb3RzIGQndW5lIGxldHRyZSAoYSwgeSwgXHUwMEUwIFx1MjAyNilcIixcclxuICAgIH0pO1xyXG4gICAgdHJhbnNmb3JtYXRpb25zTGlzdC5jcmVhdGVFbChcImxpXCIsIHtcclxuICAgICAgdGV4dDogXCJFc3BhY2UgaW5zXHUwMEU5Y2FibGUgZGFucyBsZXMgbm9tcyBjb21wb3NcdTAwRTlzIChKZWFuXFx1MDBBMER1cG9udClcIixcclxuICAgIH0pO1xyXG4gICAgdHJhbnNmb3JtYXRpb25zTGlzdC5jcmVhdGVFbChcImxpXCIsIHtcclxuICAgICAgdGV4dDogXCJFc3BhY2UgaW5zXHUwMEU5Y2FibGUgYXZhbnQgbGVzIGluaXRpYWxlcyAoTS5cXHUwMEEwRHVwb250KVwiLFxyXG4gICAgfSk7XHJcbiAgICB0cmFuc2Zvcm1hdGlvbnNMaXN0LmNyZWF0ZUVsKFwibGlcIiwge1xyXG4gICAgICB0ZXh0OiBcIkVzcGFjZSBpbnNcdTAwRTljYWJsZSBhdmFudCAoc2lcdTAwRThjbGUpIChYWGVcXHUwMEEwc2lcdTAwRThjbGUpXCIsXHJcbiAgICB9KTtcclxuICAgIHRyYW5zZm9ybWF0aW9uc0xpc3QuY3JlYXRlRWwoXCJsaVwiLCB7XHJcbiAgICAgIHRleHQ6IFwiQ29udmVyc2lvbiBkZSAob2UvT0UpIGVuIGxpZ2F0dXJlcyAoXHUwMTUzL1x1MDE1MilcIixcclxuICAgIH0pO1xyXG4gICAgdHJhbnNmb3JtYXRpb25zTGlzdC5jcmVhdGVFbChcImxpXCIsIHtcclxuICAgICAgdGV4dDogXCJDb252ZXJzaW9uIGRlICgtLSkgZW4gdGlyZXQgY2FkcmF0aW4gKFx1MjAxNClcIixcclxuICAgIH0pO1xyXG4gICAgdHJhbnNmb3JtYXRpb25zTGlzdC5jcmVhdGVFbChcImxpXCIsIHtcclxuICAgICAgdGV4dDogXCJDb252ZXJzaW9uIGRlICguLi4pIGVuIHBvaW50cyBkZSBzdXNwZW5zaW9uIChcdTIwMjYpXCIsXHJcbiAgICB9KTtcclxuXHJcbiAgICBpbmZvQ29udGVudC5jcmVhdGVFbChcInBcIiwge1xyXG4gICAgICB0ZXh0OiBcIkluZm8gcG91ciBpbnNcdTAwRTlyZXIgdW5lIGVzcGFjZSBpbnNcdTAwRTljYWJsZSBhdmVjIE9ic2lkaWFuIDpcIixcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIENyXHUwMEU5ZXIgdW5lIGxpc3RlIHBvdXIgbGVzIHJhY2NvdXJjaXNcclxuICAgIGNvbnN0IHNob3J0Y3V0c0xpc3QgPSBpbmZvQ29udGVudC5jcmVhdGVFbChcInVsXCIpO1xyXG4gICAgc2hvcnRjdXRzTGlzdC5jcmVhdGVFbChcImxpXCIsIHsgdGV4dDogXCJXaW5kb3dzIDogQWx0KzI1NVwiIH0pO1xyXG4gICAgc2hvcnRjdXRzTGlzdC5jcmVhdGVFbChcImxpXCIsIHsgdGV4dDogXCJtYWNPUyA6IEFsdCtFc3BhY2VcIiB9KTtcclxuXHJcbiAgICAvLyBBam91dGVyIGR1IHN0eWxlIENTUyBlbiBsaWduZSBwb3VyIGxlIGJsb2MgZCdpbmZvcm1hdGlvblxyXG4gICAgdGhpcy5hZGRJbmZvQmxvY2tTdHlsZXMoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEFqb3V0ZSBsZXMgc3R5bGVzIENTUyBwb3VyIGxlIGJsb2MgZCdpbmZvcm1hdGlvblxyXG4gICAqL1xyXG4gIHByaXZhdGUgYWRkSW5mb0Jsb2NrU3R5bGVzKCk6IHZvaWQge1xyXG4gICAgY29uc3Qgc3R5bGVFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInN0eWxlXCIpO1xyXG4gICAgc3R5bGVFbGVtZW50LnRleHRDb250ZW50ID0gYFxyXG4gICAgICAgIC5taWNyb3R5cG9ncmFwaGllLWluZm8tY29udGFpbmVyIHtcclxuICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSh2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQtcmdiKSwgMC4xKTtcclxuICAgICAgICAgICAgYm9yZGVyLWxlZnQ6IDRweCBzb2xpZCB2YXIoLS1pbnRlcmFjdGl2ZS1hY2NlbnQpO1xyXG4gICAgICAgICAgICBtYXJnaW46IDFlbSAwO1xyXG4gICAgICAgICAgICBwYWRkaW5nOiAxZW07XHJcbiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDRweDtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLm1pY3JvdHlwb2dyYXBoaWUtaW5mby1jb250YWluZXIgaDIge1xyXG4gICAgICAgICAgICBtYXJnaW4tdG9wOiAwO1xyXG4gICAgICAgICAgICBmb250LXNpemU6IDEuMmVtO1xyXG4gICAgICAgICAgICBjb2xvcjogdmFyKC0taW50ZXJhY3RpdmUtYWNjZW50KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLm1pY3JvdHlwb2dyYXBoaWUtaW5mby1jb250ZW50IHAge1xyXG4gICAgICAgICAgICBtYXJnaW46IDAuNWVtIDA7XHJcbiAgICAgICAgfVxyXG4gICAgYDtcclxuXHJcbiAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKHN0eWxlRWxlbWVudCk7XHJcbiAgfVxyXG5cclxuLyoqXHJcbiAqIENyXHUwMEU5ZSBsZXMgcGFyYW1cdTAwRTh0cmVzIGRlIGJhc2VcclxuICogQHBhcmFtIGNvbnRhaW5lckVsIENvbnRlbmV1ciBwYXJlbnRcclxuICovXHJcbnByaXZhdGUgY3JlYXRlQmFzaWNTZXR0aW5ncyhjb250YWluZXJFbDogSFRNTEVsZW1lbnQpOiB2b2lkIHtcclxuICAvLyBBam91dGVyIGxlcyBub3V2ZWF1eCBwYXJhbVx1MDBFOHRyZXMgcGVyc29ubmFsaXNhYmxlc1xyXG4gIGNvbnN0IGRlc0VsID0gY29udGFpbmVyRWwuY3JlYXRlRWwoXCJwXCIsIHtcclxuICAgIHRleHQ6IFwiQ2FyYWN0XHUwMEU4cmVzIHR5cG9ncmFwaGlxdWVzIHBlcnNvbm5hbGlzYWJsZXNcIixcclxuICB9KTtcclxuICBkZXNFbC5zdHlsZS5mb250V2VpZ2h0ID0gXCJib2xkXCI7XHJcblxyXG4gIC8vIE9wdGlvbiBwb3VyIGxlIGd1aWxsZW1ldCBkb3VibGUgb3V2cmFudFxyXG4gIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgLnNldE5hbWUoXCJHdWlsbGVtZXQgZG91YmxlIG91dnJhbnRcIilcclxuICAgIC5hZGRUZXh0KCh0ZXh0KSA9PlxyXG4gICAgICB0ZXh0XHJcbiAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLm9wZW5Eb3VibGVRdW90ZSlcclxuICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5vcGVuRG91YmxlUXVvdGUgPSB2YWx1ZTtcclxuICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgIH0pXHJcbiAgICApO1xyXG5cclxuICAvLyBPcHRpb24gcG91ciBsZSBndWlsbGVtZXQgZG91YmxlIGZlcm1hbnRcclxuICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgIC5zZXROYW1lKFwiR3VpbGxlbWV0IGRvdWJsZSBmZXJtYW50XCIpXHJcbiAgICAuYWRkVGV4dCgodGV4dCkgPT5cclxuICAgICAgdGV4dFxyXG4gICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5jbG9zZURvdWJsZVF1b3RlKVxyXG4gICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmNsb3NlRG91YmxlUXVvdGUgPSB2YWx1ZTtcclxuICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgIH0pXHJcbiAgICApO1xyXG5cclxuICAvLyBPcHRpb24gcG91ciBsZSBndWlsbGVtZXQgc2ltcGxlIG91dnJhbnQgKGFwb3N0cm9waGUpXHJcbiAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAuc2V0TmFtZShcIkd1aWxsZW1ldCBzaW1wbGUgb3V2cmFudFwiKVxyXG4gICAgLmFkZFRleHQoKHRleHQpID0+XHJcbiAgICAgIHRleHRcclxuICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Mub3BlblNpbmdsZVF1b3RlKVxyXG4gICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLm9wZW5TaW5nbGVRdW90ZSA9IHZhbHVlO1xyXG4gICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgfSlcclxuICAgICk7XHJcblxyXG4gIC8vIE9wdGlvbiBwb3VyIGxlIGd1aWxsZW1ldCBzaW1wbGUgZmVybWFudCAoYXBvc3Ryb3BoZSlcclxuICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgIC5zZXROYW1lKFwiR3VpbGxlbWV0IHNpbXBsZSBmZXJtYW50XCIpXHJcbiAgICAuYWRkVGV4dCgodGV4dCkgPT5cclxuICAgICAgdGV4dFxyXG4gICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5jbG9zZVNpbmdsZVF1b3RlKVxyXG4gICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmNsb3NlU2luZ2xlUXVvdGUgPSB2YWx1ZTtcclxuICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgIH0pXHJcbiAgICApO1xyXG5cclxuICAvLyBTZWN0aW9uIHBvdXIgbGVzIG5vdXZlbGxlcyBvcHRpb25zXHJcbiAgY29uc3QgdHJhbnNmb3JtVGl0bGUgPSBjb250YWluZXJFbC5jcmVhdGVFbChcInBcIiwge1xyXG4gICAgdGV4dDogXCJPcHRpb25zXCIsXHJcbiAgfSk7XHJcbiAgdHJhbnNmb3JtVGl0bGUuc3R5bGUuZm9udFdlaWdodCA9IFwiYm9sZFwiO1xyXG4gIHRyYW5zZm9ybVRpdGxlLnN0eWxlLm1hcmdpblRvcCA9IFwiMS41ZW1cIjtcclxuXHJcbiAgLy8gT3B0aW9uIHBvdXIgbGVzIHRpcmV0c1xyXG4gIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgLnNldE5hbWUoXCJUaXJldHNcIilcclxuICAgIC5zZXREZXNjKFxyXG4gICAgICBcIi0tIGRldmllbnQgdGlyZXQgZGVtaS1jYWRyYXRpbiAoXHUyMDEzKSwgXHUyMDEzLSBkZXZpZW50IHRpcmV0IGNhZHJhdGluIChcdTIwMTQpLCBcdTIwMTQtIGRldmllbnQgdHJvaXMgdGlyZXRzICgtLS0pXCJcclxuICAgIClcclxuICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cclxuICAgICAgdG9nZ2xlXHJcbiAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmRhc2hlc0VuYWJsZWQpXHJcbiAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZGFzaGVzRW5hYmxlZCA9IHZhbHVlO1xyXG4gICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgfSlcclxuICAgICk7XHJcblxyXG4gIC8vIE9wdGlvbiBwb3VyIHNhdXRlciBsZSB0aXJldCBkZW1pLWNhZHJhdGluXHJcbiAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAuc2V0TmFtZShcIklnbm9yZXIgbGUgdGlyZXQgZGVtaS1jYWRyYXRpblwiKVxyXG4gICAgLnNldERlc2MoXHJcbiAgICAgIFwiUXVhbmQgYWN0aXZcdTAwRTksIC0tIGVzdCBkaXJlY3RlbWVudCBjb252ZXJ0aSBlbiB0aXJldCBjYWRyYXRpbiAoXHUyMDE0KSBwbHV0XHUwMEY0dCBxdSdlbiBkZW1pLWNhZHJhdGluIChcdTIwMTMpXCJcclxuICAgIClcclxuICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cclxuICAgICAgdG9nZ2xlXHJcbiAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnNraXBFbkRhc2gpXHJcbiAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2tpcEVuRGFzaCA9IHZhbHVlO1xyXG4gICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgfSlcclxuICAgICk7XHJcblxyXG4gIC8vIE9wdGlvbiBwb3VyIGxlcyBwb2ludHMgZGUgc3VzcGVuc2lvblxyXG4gIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgLnNldE5hbWUoXCJQb2ludHMgZGUgc3VzcGVuc2lvblwiKVxyXG4gICAgLnNldERlc2MoXHJcbiAgICAgIFwiVHJvaXMgcG9pbnRzICguLi4pIHNlcm9udCBjb252ZXJ0aXMgZW4gcG9pbnRzIGRlIHN1c3BlbnNpb24gKFx1MjAyNilcIlxyXG4gICAgKVxyXG4gICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG4gICAgICB0b2dnbGVcclxuICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZWxsaXBzaXNFbmFibGVkKVxyXG4gICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmVsbGlwc2lzRW5hYmxlZCA9IHZhbHVlO1xyXG4gICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgfSlcclxuICAgICk7XHJcblxyXG4gIC8vIE9wdGlvbiBwb3VyIGxlcyBndWlsbGVtZXRzIGNoZXZyb25zXHJcbiAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAuc2V0TmFtZShcIkd1aWxsZW1ldHNcIilcclxuICAgIC5zZXREZXNjKFxyXG4gICAgICBcIkxlcyBjaGV2cm9ucyA8PCBldCA+PiBzZXJvbnQgY29udmVydGlzIGVuIGd1aWxsZW1ldHMgZnJhblx1MDBFN2FpcyBcdTAwQUIgZXQgXHUwMEJCXCJcclxuICAgIClcclxuICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cclxuICAgICAgdG9nZ2xlXHJcbiAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmd1aWxsZW1ldHNFbmFibGVkKVxyXG4gICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmd1aWxsZW1ldHNFbmFibGVkID0gdmFsdWU7XHJcbiAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICB9KVxyXG4gICAgKTtcclxuXHJcbiAgLy8gY29uc3QgZnJlbmNoUnVsZXNUaXRsZSA9IGNvbnRhaW5lckVsLmNyZWF0ZUVsKFwicFwiLCB7XHJcbiAgLy8gICB0ZXh0OiBcIlJcdTAwRThnbGVzIHR5cG9ncmFwaGlxdWVzIHBhciBsYW5ndWVcIixcclxuICAvLyB9KTtcclxuICAvLyBmcmVuY2hSdWxlc1RpdGxlLnN0eWxlLmZvbnRXZWlnaHQgPSBcImJvbGRcIjtcclxuXHJcbiAgLy8gQ3JcdTAwRTllciB1biBjb250ZW5ldXIgcG91ciBsZXMgclx1MDBFOGdsZXMgZnJhblx1MDBFN2Fpc2VzIGV0IGxldXIgZGVzY3JpcHRpb25cclxuICBjb25zdCBmcmVuY2hSdWxlc0NvbnRhaW5lciA9IGNvbnRhaW5lckVsLmNyZWF0ZUVsKFwiZGl2XCIpO1xyXG4gIGZyZW5jaFJ1bGVzQ29udGFpbmVyLnN0eWxlLm1hcmdpblRvcCA9IFwiM2VtXCI7XHJcblxyXG5cclxuICAvLyBPcHRpb24gcG91ciBsZXMgclx1MDBFOGdsZXMgdHlwb2dyYXBoaXF1ZXMgZnJhblx1MDBFN2Fpc2VzIGF2ZWMgdG9nZ2xlXHJcbiAgY29uc3QgZnJlbmNoUnVsZXNTZXR0aW5nID0gbmV3IFNldHRpbmcoZnJlbmNoUnVsZXNDb250YWluZXIpXHJcbiAgICAuc2V0TmFtZShcIlJcdTAwRThnbGVzIHR5cG9ncmFwaGlxdWVzIGZyYW5cdTAwRTdhaXNlc1wiKVxyXG4gICAgLnNldERlc2MoXHJcbiAgICAgIFwiXCJcclxuICAgIClcclxuICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cclxuICAgICAgdG9nZ2xlXHJcbiAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmZyZW5jaFJ1bGVzRW5hYmxlZClcclxuICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5mcmVuY2hSdWxlc0VuYWJsZWQgPSB2YWx1ZTtcclxuICAgICAgICAgIC8vIEFmZmljaGVyIG91IG1hc3F1ZXIgbGEgZGVzY3JpcHRpb24gZGVzIHJcdTAwRThnbGVzXHJcbiAgICAgICAgICBmcmVuY2hSdWxlc0Rlc2NDb250YWluZXIuc3R5bGUuZGlzcGxheSA9IHZhbHVlID8gXCJibG9ja1wiIDogXCJub25lXCI7XHJcbiAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICB9KVxyXG4gICAgKTtcclxuXHJcbiAgICBjb25zdCBuYW1lRWwgPSBmcmVuY2hSdWxlc1NldHRpbmcubmFtZUVsO1xyXG4gICAgaWYgKG5hbWVFbCkge1xyXG4gICAgICBuYW1lRWwuc3R5bGUuZm9udFdlaWdodCA9IFwiYm9sZFwiO1xyXG4gICAgICAvLyBuYW1lRWwuc3R5bGUubWFyZ2luVG9wID0gXCIzZW1cIjtcclxuICAgIH1cclxuXHJcbiAgLy8gQ29udGVuZXVyIHBvdXIgbGEgZGVzY3JpcHRpb24gZGVzIHJcdTAwRThnbGVzIGZyYW5cdTAwRTdhaXNlc1xyXG4gIGNvbnN0IGZyZW5jaFJ1bGVzRGVzY0NvbnRhaW5lciA9IGZyZW5jaFJ1bGVzQ29udGFpbmVyLmNyZWF0ZUVsKFwiZGl2XCIsIHtcclxuICAgIGNsczogXCJmcmVuY2gtcnVsZXMtZGVzY3JpcHRpb25cIlxyXG4gIH0pO1xyXG4gIFxyXG4gIC8vIERcdTAwRTlmaW5pciBsYSB2aXNpYmlsaXRcdTAwRTkgaW5pdGlhbGVcclxuICBmcmVuY2hSdWxlc0Rlc2NDb250YWluZXIuc3R5bGUuZGlzcGxheSA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmZyZW5jaFJ1bGVzRW5hYmxlZCA/IFwiYmxvY2tcIiA6IFwibm9uZVwiO1xyXG4gIGZyZW5jaFJ1bGVzRGVzY0NvbnRhaW5lci5zdHlsZS5wYWRkaW5nTGVmdCA9IFwiMjRweFwiO1xyXG4gIGZyZW5jaFJ1bGVzRGVzY0NvbnRhaW5lci5zdHlsZS5tYXJnaW5Ub3AgPSBcIjhweFwiO1xyXG5cclxuICAvLyBBam91dGVyIHVuZSBkZXNjcmlwdGlvbiBkZXMgclx1MDBFOGdsZXMgdHlwb2dyYXBoaXF1ZXMgZnJhblx1MDBFN2Fpc2VzXHJcbiAgY29uc3QgZnJlbmNoUnVsZXNEZXNjID0gZnJlbmNoUnVsZXNEZXNjQ29udGFpbmVyLmNyZWF0ZUVsKFwiZGl2XCIsIHtcclxuICAgIGNsczogXCJzZXR0aW5nLWl0ZW0tZGVzY3JpcHRpb25cIixcclxuICB9KTtcclxuXHJcbiAgZnJlbmNoUnVsZXNEZXNjLmNyZWF0ZUVsKFwicFwiLCB7XHJcbiAgICB0ZXh0OiBcIkNlcyByXHUwMEU4Z2xlcyBpbmNsdWVudCA6XCIsXHJcbiAgfSk7XHJcblxyXG4gIGNvbnN0IHJ1bGVzTGlzdCA9IGZyZW5jaFJ1bGVzRGVzYy5jcmVhdGVFbChcInVsXCIpO1xyXG4gIHJ1bGVzTGlzdC5zdHlsZS5tYXJnaW5MZWZ0ID0gXCIyMHB4XCI7XHJcbiAgLy8gcnVsZXNMaXN0LnN0eWxlLm1hcmdpblRvcCA9IFwiNXB4XCI7XHJcbiAgcnVsZXNMaXN0LnN0eWxlLm1hcmdpbkJvdHRvbSA9IFwiMTVweFwiO1xyXG5cclxuICBydWxlc0xpc3QuY3JlYXRlRWwoXCJsaVwiLCB7XHJcbiAgICB0ZXh0OiAnQ29udmVyc2lvbiBkZSAoXCIgXCIpIGVuIGd1aWxsZW1ldHMgZnJhblx1MDBFN2FpcyAoXHUwMEFCIFx1MDBCQiknLFxyXG4gIH0pO1xyXG4gIHJ1bGVzTGlzdC5jcmVhdGVFbChcImxpXCIsIHtcclxuICAgIHRleHQ6IFwiRXNwYWNlIGZpbmUgaW5zXHUwMEU5Y2FibGUgYXZhbnQgbGVzIHBvbmN0dWF0aW9ucyBkb3VibGVzICghID8gOyBcdTAwQkIpXCIsXHJcbiAgfSk7XHJcbiAgcnVsZXNMaXN0LmNyZWF0ZUVsKFwibGlcIiwge1xyXG4gICAgdGV4dDogXCJFc3BhY2UgaW5zXHUwMEU5Y2FibGUgYXZhbnQgbGVzIGRldXgtcG9pbnRzICg6KVwiLFxyXG4gIH0pO1xyXG4gIHJ1bGVzTGlzdC5jcmVhdGVFbChcImxpXCIsIHtcclxuICAgIHRleHQ6IFwiRXNwYWNlIGluc1x1MDBFOWNhYmxlIGFwclx1MDBFOHMgbGVzIG1vdHMgZCd1bmUgbGV0dHJlIChhLCB5LCBcdTAwRTAuLi4pXCIsXHJcbiAgfSk7XHJcbiAgcnVsZXNMaXN0LmNyZWF0ZUVsKFwibGlcIiwge1xyXG4gICAgdGV4dDogXCJFc3BhY2UgaW5zXHUwMEU5Y2FibGUgZGFucyBsZXMgbm9tcyBjb21wb3NcdTAwRTlzIChKZWFuIER1cG9udClcIixcclxuICB9KTtcclxuICBydWxlc0xpc3QuY3JlYXRlRWwoXCJsaVwiLCB7XHJcbiAgICB0ZXh0OiBcIkVzcGFjZSBpbnNcdTAwRTljYWJsZSBhdmFudCBsZXMgaW5pdGlhbGVzIChNLiBEdXBvbnQpXCIsXHJcbiAgfSk7XHJcbiAgcnVsZXNMaXN0LmNyZWF0ZUVsKFwibGlcIiwge1xyXG4gICAgdGV4dDogJ0VzcGFjZSBpbnNcdTAwRTljYWJsZSBhdmFudCBcInNpXHUwMEU4Y2xlXCIgKFhYZSBzaVx1MDBFOGNsZSknLFxyXG4gIH0pO1xyXG4gIHJ1bGVzTGlzdC5jcmVhdGVFbChcImxpXCIsIHtcclxuICAgIHRleHQ6ICdDb252ZXJzaW9uIGRlcyBsaWdhdHVyZXMgXCJvZS9PRVwiIGVuIFwiXHUwMTUzL1x1MDE1MlwiJyxcclxuICB9KTtcclxuICBydWxlc0xpc3QuY3JlYXRlRWwoXCJsaVwiLCB7XHJcbiAgICB0ZXh0OiBcIkV4cG9zYW50cyBwb3VyIGxlcyBvcmRpbmF1eCAoMWVyLCBYSUllKVwiLFxyXG4gIH0pO1xyXG4gIHJ1bGVzTGlzdC5jcmVhdGVFbChcImxpXCIsIHtcclxuICAgIHRleHQ6IFwiQ29udmVyc2lvbiBkZSAoLi4uKSBlbiBwb2ludHMgZGUgc3VzcGVuc2lvbiAoXHUyMDI2KVwiLFxyXG4gIH0pO1xyXG5cclxuICAvLyBBam91dGVyIHVuZSBub3RlIGV4cGxpY2F0aXZlIHN1ciBsZXMgZXNwYWNlcyBmaW5lcyBpbnNcdTAwRTljYWJsZXNcclxuICBjb25zdCBub3RlRWwgPSBmcmVuY2hSdWxlc0Rlc2NDb250YWluZXIuY3JlYXRlRWwoXCJkaXZcIiwge1xyXG4gICAgY2xzOiBcInNldHRpbmctaXRlbS1kZXNjcmlwdGlvblwiLFxyXG4gIH0pO1xyXG5cclxuICBub3RlRWwuY3JlYXRlRWwoXCJwXCIsIHtcclxuICAgIHRleHQ6IFwiU291cmNlcyA6XCIsXHJcbiAgfSk7XHJcblxyXG4gIGNvbnN0IGluZm9MaXN0ID0gbm90ZUVsLmNyZWF0ZUVsKFwidWxcIik7XHJcbiAgY29uc3QgaW5mb0l0ZW0gPSBpbmZvTGlzdC5jcmVhdGVFbChcImxpXCIpO1xyXG4gIGluZm9JdGVtLmNyZWF0ZUVsKFwiYVwiLCB7XHJcbiAgICBocmVmOiBcImh0dHBzOi8vZ2l0bGFiLmNvbS9KdWxpZUJsYW5jL3R5cGVzZXR0aW5nLXRvb2xzLy0vYmxvYi9tYXN0ZXIvcmVnZXgtdHlwby5qcz9yZWZfdHlwZT1oZWFkc1wiLFxyXG4gICAgdGV4dDogXCJ0eXBlc2V0dGluZy10b29scyAoSnVsaWUgQmxhbmMpXCIsXHJcbiAgfSk7XHJcblxyXG4gIGNvbnN0IGluZm9JdGVtMiA9IGluZm9MaXN0LmNyZWF0ZUVsKFwibGlcIik7XHJcbiAgaW5mb0l0ZW0yLmNyZWF0ZUVsKFwiYVwiLCB7XHJcbiAgICBocmVmOiBcImh0dHBzOi8vdHlwb21hbmllLmZyL3RhZy9taWNyby10eXBvZ3JhcGhpZS9cIixcclxuICAgIHRleHQ6IFwiTGUgUGV0aXQgbWFudWVsIGRlIGNvbXBvc2l0aW9uIHR5cG9ncmFwaGlxdWUuIChNdXJpZWwgUGFyaXMpXCIsXHJcbiAgfSk7XHJcbn1cclxuXHJcbiAgLyoqXHJcbiAgICogQ3JcdTAwRTllIGxlcyBwYXJhbVx1MDBFOHRyZXMgZGUgbWlzZSBlbiBcdTAwRTl2aWRlbmNlXHJcbiAgICogQHBhcmFtIGNvbnRhaW5lckVsIENvbnRlbmV1ciBwYXJlbnRcclxuICAgKi9cclxuICBwcml2YXRlIGNyZWF0ZUhpZ2hsaWdodFNldHRpbmdzKGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudCk6IHZvaWQge1xyXG4gICAgY29uc3QgZGVzRWwgPSBjb250YWluZXJFbC5jcmVhdGVFbChcInBcIiwge1xyXG4gICAgICB0ZXh0OiBcIkFmZmljaGFnZSBkZXMgY2FyYWN0XHUwMEU4cmVzIGludmlzaWJsZXNcIixcclxuICAgIH0pO1xyXG4gICAgZGVzRWwuc3R5bGUuZm9udFdlaWdodCA9IFwiYm9sZFwiO1xyXG4gICAgZGVzRWwuc3R5bGUubWFyZ2luVG9wID0gXCIzZW1cIjtcclxuXHJcbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgLnNldE5hbWUoXCJBY3RpdmVyIGwnYWZmaWNoYWdlIGRlcyBjYXJhY3RcdTAwRThyZXMgaW52aXNpYmxlc1wiKVxyXG4gICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XHJcbiAgICAgICAgdG9nZ2xlXHJcbiAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuaGlnaGxpZ2h0RW5hYmxlZClcclxuICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuaGlnaGxpZ2h0RW5hYmxlZCA9IHZhbHVlO1xyXG4gICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgIH0pXHJcbiAgICAgICk7XHJcblxyXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgIC5zZXROYW1lKFwiQm91dG9uIGRhbnMgbGEgYmFycmUgZCdcdTAwRTl0YXRcIilcclxuICAgICAgLnNldERlc2MoXHJcbiAgICAgICAgXCJBZmZpY2hlciB1biBib3V0b24gZCdhY3RpdmF0aW9uL2RcdTAwRTlzYWN0aXZhdGlvblwiXHJcbiAgICAgIClcclxuICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG4gICAgICAgIHRvZ2dsZVxyXG4gICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmhpZ2hsaWdodEJ1dHRvbilcclxuICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuaGlnaGxpZ2h0QnV0dG9uID0gdmFsdWU7XHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgKTtcclxuXHJcbiAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAuc2V0TmFtZShcIkJvdXRvbiBkYW5zIGxhIGJhcnJlIGRlIHRpdHJlXCIpXHJcbiAgICAgIC5zZXREZXNjKFxyXG4gICAgICAgICAgXCJBZmZpY2hlciB1biBib3V0b24gZCdhY3RpdmF0aW9uL2RcdTAwRTlzYWN0aXZhdGlvbiBkYW5zIGxhIGJhcnJlIGRlIHRpdHJlIGRlcyBvbmdsZXRzXCJcclxuICAgICAgKVxyXG4gICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XHJcbiAgICAgICAgICB0b2dnbGVcclxuICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MudGFiVGl0bGVCYXJCdXR0b24pXHJcbiAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy50YWJUaXRsZUJhckJ1dHRvbiA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICB9KVxyXG4gICAgICApO1xyXG5cclxuXHJcbiAgfVxyXG59XHJcbiIsICJpbXBvcnQgeyBFZGl0b3JWaWV3LCBEZWNvcmF0aW9uLCBWaWV3UGx1Z2luLCBWaWV3VXBkYXRlIH0gZnJvbSBcIkBjb2RlbWlycm9yL3ZpZXdcIjtcclxuaW1wb3J0IHsgUmFuZ2VTZXRCdWlsZGVyIH0gZnJvbSBcIkBjb2RlbWlycm9yL3N0YXRlXCI7XHJcbmltcG9ydCB7IE1pY3JvdHlwb2dyYXBoaWVTZXR0aW5ncyB9IGZyb20gJy4uL3NldHRpbmdzL3NldHRpbmdzJztcclxuXHJcblxyXG4vKipcclxuICogQ3JcdTAwRTllIGxlcyBkXHUwMEU5Y29yYXRpb25zIHZpc3VlbGxlcyBwb3VyIGxlcyBjYXJhY3RcdTAwRThyZXMgc3BcdTAwRTljaWF1eFxyXG4gKiBAcGFyYW0gc2V0dGluZ3MgUGFyYW1cdTAwRTh0cmVzIGR1IHBsdWdpblxyXG4gKiBAcmV0dXJucyBFeHRlbnNpb24gcG91ciBsJ1x1MDBFOWRpdGV1ciBDb2RlTWlycm9yXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlRGVjb3JhdGlvbnMoc2V0dGluZ3M6IE1pY3JvdHlwb2dyYXBoaWVTZXR0aW5ncykge1xyXG4gICAgLy8gRFx1MDBFOWNvcmF0aW9uIHBvdXIgbCdlc3BhY2UgaW5zXHUwMEU5Y2FibGUgbm9ybWFsZVxyXG4gICAgY29uc3Qgbm9uQnJlYWtpbmdTcGFjZURlY29yYXRpb24gPSBEZWNvcmF0aW9uLm1hcmsoe1xyXG4gICAgICAgIGNsYXNzOiAnbm9uQnJlYWtpbmdTcGFjZSdcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIERcdTAwRTljb3JhdGlvbiBwb3VyIGwnZXNwYWNlIGZpbmUgaW5zXHUwMEU5Y2FibGVcclxuICAgIGNvbnN0IHRoaW5TcGFjZURlY29yYXRpb24gPSBEZWNvcmF0aW9uLm1hcmsoe1xyXG4gICAgICAgIGNsYXNzOiAndGhpblNwYWNlJ1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gRFx1MDBFOWNvcmF0aW9uIHBvdXIgbGUgdGlyZXQgY2FkcmF0aW5cclxuICAgIGNvbnN0IGVtRGFzaERlY29yYXRpb24gPSBEZWNvcmF0aW9uLm1hcmsoe1xyXG4gICAgICAgIGNsYXNzOiAnZW0tZGFzaCdcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIERcdTAwRTljb3JhdGlvbiBwb3VyIGwnZXNwYWNlIG5vcm1hbGVcclxuICAgIGNvbnN0IHJlZ3VsYXJTcGFjZURlY29yYXRpb24gPSBEZWNvcmF0aW9uLm1hcmsoe1xyXG4gICAgICAgIGNsYXNzOiAncmVndWxhclNwYWNlJ1xyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIFZpZXdQbHVnaW4uZnJvbUNsYXNzKGNsYXNzIHtcclxuICAgICAgICBkZWNvcmF0aW9uczogYW55O1xyXG5cclxuICAgICAgICBjb25zdHJ1Y3Rvcih2aWV3OiBFZGl0b3JWaWV3KSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGVjb3JhdGlvbnMgPSB0aGlzLmJ1aWxkRGVjb3JhdGlvbnModmlldyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB1cGRhdGUodXBkYXRlOiBWaWV3VXBkYXRlKSB7XHJcbiAgICAgICAgICAgIGlmICh1cGRhdGUuZG9jQ2hhbmdlZCB8fCB1cGRhdGUudmlld3BvcnRDaGFuZ2VkKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRlY29yYXRpb25zID0gdGhpcy5idWlsZERlY29yYXRpb25zKHVwZGF0ZS52aWV3KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgYnVpbGREZWNvcmF0aW9ucyh2aWV3OiBFZGl0b3JWaWV3KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGJ1aWxkZXIgPSBuZXcgUmFuZ2VTZXRCdWlsZGVyPERlY29yYXRpb24+KCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBBcHBsaXF1ZXIgbGVzIGRcdTAwRTljb3JhdGlvbnMgdW5pcXVlbWVudCBzaSBsYSBtaXNlIGVuIFx1MDBFOXZpZGVuY2UgZXN0IGFjdGl2XHUwMEU5ZVxyXG4gICAgICAgICAgICBpZiAoc2V0dGluZ3MuaGlnaGxpZ2h0RW5hYmxlZCkge1xyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgeyBmcm9tLCB0byB9IG9mIHZpZXcudmlzaWJsZVJhbmdlcykge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCB0ZXh0ID0gdmlldy5zdGF0ZS5kb2Muc2xpY2VTdHJpbmcoZnJvbSwgdG8pO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBkb2N1bWVudFRleHQgPSB2aWV3LnN0YXRlLmRvYy50b1N0cmluZygpO1xyXG4gICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIFBvc2l0aW9uIGRlIGRcdTAwRTlwYXJ0IHBvdXIgbGUgdHJhaXRlbWVudCBkdSB0ZXh0ZVxyXG4gICAgICAgICAgICAgICAgICAgIGxldCBzdGFydFBvcyA9IGZyb207XHJcbiAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gQW5hbHlzZXIgbGUgdGV4dGUgcG91ciBkXHUwMEU5dGVjdGVyIGxlcyBmcm9udG1hdHRlciBldCBibG9jcyBkZSBjb2RlXHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGluRnJvbnRtYXR0ZXIgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgaW5Db2RlQmxvY2sgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgbGluZVN0YXJ0ID0gdHJ1ZTsgLy8gUG91ciBkXHUwMEU5dGVjdGVyIGxlIGRcdTAwRTlidXQgZCd1bmUgbGlnbmVcclxuICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRleHQubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hhciA9IHRleHRbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHBvcyA9IHN0YXJ0UG9zICsgaTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE9idGVuaXIgbGEgcG9zaXRpb24gZGUgbGlnbmUgYWN0dWVsbGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY3VycmVudFBvcyA9IHZpZXcuc3RhdGUuZG9jLmxpbmVBdChwb3MpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBsaW5lTnVtYmVyID0gY3VycmVudFBvcy5udW1iZXIgLSAxOyAvLyBMZXMgbGlnbmVzIGNvbW1lbmNlbnQgXHUwMEUwIDEgZGFucyBDb2RlTWlycm9yXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBEXHUwMEU5dGVjdGlvbiBkdSBkXHUwMEU5YnV0IGV0IGZpbiBkdSBmcm9udG1hdHRlciAoLS0tKSBcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxpbmVTdGFydCAmJiB0ZXh0LnN1YnN0cihpLCAzKSA9PT0gJy0tLScpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluRnJvbnRtYXR0ZXIgPSAhaW5Gcm9udG1hdHRlcjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgKz0gMjsgLy8gU2F1dGVyIGxlcyAzIHRpcmV0cyAob24gaW5jclx1MDBFOW1lbnRlcmEgZW5jb3JlIGkgZGFucyBsYSBib3VjbGUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5lU3RhcnQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBEXHUwMEU5dGVjdGlvbiBkdSBkXHUwMEU5YnV0IGV0IGZpbiBkZXMgYmxvY3MgZGUgY29kZSAoYGBgKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobGluZVN0YXJ0ICYmIHRleHQuc3Vic3RyKGksIDMpID09PSAnYGBgJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5Db2RlQmxvY2sgPSAhaW5Db2RlQmxvY2s7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpICs9IDI7IC8vIFNhdXRlciBsZXMgMyBiYWNrdGlja3NcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVTdGFydCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIERcdTAwRTl0ZWN0aW9uIGR1IGRcdTAwRTlidXQgZCd1bmUgbm91dmVsbGUgbGlnbmVcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNoYXIgPT09ICdcXG4nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5lU3RhcnQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGxpbmVTdGFydCAmJiBjaGFyICE9PSAnICcgJiYgY2hhciAhPT0gJ1xcdCcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVTdGFydCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBWXHUwMEU5cmlmaWVyIHNpIGxhIGxpZ25lIGFjdHVlbGxlIGVzdCBkYW5zIHVuIGJsb2Mgc3BcdTAwRTljaWFsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzSW5TcGVjaWFsQmxvY2sgPSBpbkZyb250bWF0dGVyIHx8IGluQ29kZUJsb2NrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQXBwbGlxdWVyIGxlcyBkXHUwMEU5Y29yYXRpb25zIHNldWxlbWVudCBzaSBvbiBuJ2VzdCBwYXMgZGFucyB1biBibG9jIHNwXHUwMEU5Y2lhbFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWlzSW5TcGVjaWFsQmxvY2spIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjaGFyID09PSAnXFx1MDBBMCcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBidWlsZGVyLmFkZChwb3MsIHBvcyArIDEsIG5vbkJyZWFraW5nU3BhY2VEZWNvcmF0aW9uKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjaGFyID09PSAnXFx1MjAyRicpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBidWlsZGVyLmFkZChwb3MsIHBvcyArIDEsIHRoaW5TcGFjZURlY29yYXRpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNoYXIgPT09ICdcdTIwMTQnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnVpbGRlci5hZGQocG9zLCBwb3MgKyAxLCBlbURhc2hEZWNvcmF0aW9uKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjaGFyID09PSAnICcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBidWlsZGVyLmFkZChwb3MsIHBvcyArIDEsIHJlZ3VsYXJTcGFjZURlY29yYXRpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gYnVpbGRlci5maW5pc2goKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIFxyXG4gICAgfSwge1xyXG4gICAgICAgIGRlY29yYXRpb25zOiB2ID0+IHYuZGVjb3JhdGlvbnNcclxuICAgIH0pO1xyXG59IiwgImltcG9ydCB7IFBsdWdpbiwgc2V0SWNvbiB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5cclxuXHJcbi8qKlxyXG4gKiBDclx1MDBFOWUgdW4gYm91dG9uIGRhbnMgbGEgYmFycmUgZCdcdTAwRTl0YXRcclxuICogQHBhcmFtIHBsdWdpbiBJbnN0YW5jZSBkdSBwbHVnaW5cclxuICogQHBhcmFtIGlzRW5hYmxlZCBcdTAwQzl0YXQgaW5pdGlhbCAoYWN0aXZcdTAwRTkvZFx1MDBFOXNhY3Rpdlx1MDBFOSlcclxuICogQHBhcmFtIHRvZ2dsZUNhbGxiYWNrIEZvbmN0aW9uIGRlIHJhcHBlbCBwb3VyIGxlIGJhc2N1bGVtZW50XHJcbiAqIEByZXR1cm5zIFx1MDBDOWxcdTAwRTltZW50IEhUTUwgZHUgYm91dG9uXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlU3RhdHVzQmFyQnV0dG9uKFxyXG4gICAgcGx1Z2luOiBQbHVnaW4sXHJcbiAgICBpc0VuYWJsZWQ6IGJvb2xlYW4sXHJcbiAgICB0b2dnbGVDYWxsYmFjazogKCkgPT4gdm9pZFxyXG4pOiBIVE1MRWxlbWVudCB7XHJcbiAgICBjb25zdCBzdGF0dXNCYXJJdGVtRWwgPSBwbHVnaW4uYWRkU3RhdHVzQmFySXRlbSgpO1xyXG4gICAgc3RhdHVzQmFySXRlbUVsLmlkID0gXCJoaWdobGlnaHQtc3RhdHVzLWJhci1idXR0b25cIjtcclxuICAgIFxyXG4gICAgc3RhdHVzQmFySXRlbUVsLmFkZENsYXNzKFwibW9kLWNsaWNrYWJsZVwiKTtcclxuICAgIFxyXG4gICAgLy8gQ3JcdTAwRTllciBsJ2ljXHUwMEY0bmUgZXQgbCdham91dGVyIGF1IGJvdXRvblxyXG4gICAgc2V0SWNvbihzdGF0dXNCYXJJdGVtRWwsIFwicGlsY3Jvd1wiKTtcclxuXHJcbiAgICBzdGF0dXNCYXJJdGVtRWwuc2V0QXR0cmlidXRlKFwiYXJpYS1sYWJlbFwiLCBcIkFmZmljaGVyL01hc3F1ZXIgbGVzIGNhcmFjdFx1MDBFOHJlcyBpbnZpc2libGVzXCIpO1xyXG4gICAgc3RhdHVzQmFySXRlbUVsLnNldEF0dHJpYnV0ZShcImRhdGEtdG9vbHRpcC1wb3NpdGlvblwiLCBcInRvcFwiKTtcclxuXHJcbiAgICAvLyBEXHUwMEU5ZmluaXIgbCdhcHBhcmVuY2UgaW5pdGlhbGVcclxuICAgIHVwZGF0ZVN0YXR1c0JhckJ1dHRvbihzdGF0dXNCYXJJdGVtRWwsIGlzRW5hYmxlZCk7XHJcblxyXG4gICAgLy8gQWpvdXRlciBsJ1x1MDBFOXZcdTAwRTluZW1lbnQgZGUgY2xpY1xyXG4gICAgc3RhdHVzQmFySXRlbUVsLm9uQ2xpY2tFdmVudCgoKSA9PiB7XHJcbiAgICAgICAgdG9nZ2xlQ2FsbGJhY2soKTtcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICByZXR1cm4gc3RhdHVzQmFySXRlbUVsO1xyXG59XHJcblxyXG4vKipcclxuICogQ3JcdTAwRTllIHVuIGJvdXRvbiBkYW5zIGxhIGJhcnJlIGRlIHRpdHJlIGRlcyBvbmdsZXRzXHJcbiAqIEBwYXJhbSBwbHVnaW4gSW5zdGFuY2UgZHUgcGx1Z2luXHJcbiAqIEBwYXJhbSBpc0VuYWJsZWQgXHUwMEM5dGF0IGluaXRpYWwgKGFjdGl2XHUwMEU5L2RcdTAwRTlzYWN0aXZcdTAwRTkpXHJcbiAqIEBwYXJhbSB0b2dnbGVDYWxsYmFjayBGb25jdGlvbiBkZSByYXBwZWwgcG91ciBsZSBiYXNjdWxlbWVudFxyXG4gKiBAcmV0dXJucyBcdTAwQzlsXHUwMEU5bWVudCBIVE1MIGR1IGJvdXRvblxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVRhYlRpdGxlQmFyQnV0dG9uKFxyXG4gICAgcGx1Z2luOiBQbHVnaW4sXHJcbiAgICBpc0VuYWJsZWQ6IGJvb2xlYW4sXHJcbiAgICB0b2dnbGVDYWxsYmFjazogKCkgPT4gdm9pZFxyXG4pOiBIVE1MRWxlbWVudCB7XHJcbiAgICAvLyBDclx1MDBFOWVyIGxlIGJvdXRvblxyXG4gICAgY29uc3QgYnV0dG9uRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcclxuICAgIGJ1dHRvbkVsLmlkID0gXCJoaWdobGlnaHQtdGFiLXRpdGxlLWJ1dHRvblwiO1xyXG4gICAgYnV0dG9uRWwuY2xhc3NOYW1lID0gXCJjbGlja2FibGUtaWNvbiB2aWV3LWFjdGlvblwiO1xyXG4gICAgYnV0dG9uRWwuc2V0QXR0cmlidXRlKFwiYXJpYS1sYWJlbFwiLCBcIkFmZmljaGVyL01hc3F1ZXIgbGVzIGNhcmFjdFx1MDBFOHJlcyBpbnZpc2libGVzXCIpO1xyXG4gICAgXHJcbiAgICAvLyBDclx1MDBFOWVyIGwnaWNcdTAwRjRuZSBldCBsJ2Fqb3V0ZXIgYXUgYm91dG9uXHJcbiAgICBzZXRJY29uKGJ1dHRvbkVsLCBcInBpbGNyb3dcIik7XHJcbiAgICBcclxuICAgIC8vIERcdTAwRTlmaW5pciBsJ2FwcGFyZW5jZSBpbml0aWFsZVxyXG4gICAgdXBkYXRlVGFiVGl0bGVCYXJCdXR0b24oYnV0dG9uRWwsIGlzRW5hYmxlZCk7XHJcbiAgICBcclxuICAgIC8vIEFqb3V0ZXIgbCdcdTAwRTl2XHUwMEU5bmVtZW50IGRlIGNsaWNcclxuICAgIGJ1dHRvbkVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2ZW50KSA9PiB7XHJcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICB0b2dnbGVDYWxsYmFjaygpO1xyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8vIEFqb3V0ZXIgbGUgYm91dG9uIFx1MDBFMCBsYSBiYXJyZSBkZSB0aXRyZVxyXG4gICAgY29uc3QgdGl0bGVCYXJFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy52aWV3LWhlYWRlci10aXRsZS1jb250YWluZXInKTtcclxuICAgIGlmICh0aXRsZUJhckVsKSB7XHJcbiAgICAgICAgY29uc3QgYWN0aW9uc0VsID0gdGl0bGVCYXJFbC5uZXh0RWxlbWVudFNpYmxpbmcgYXMgSFRNTEVsZW1lbnQ7XHJcbiAgICAgICAgaWYgKGFjdGlvbnNFbCAmJiBhY3Rpb25zRWwuY2xhc3NMaXN0LmNvbnRhaW5zKCd2aWV3LWFjdGlvbnMnKSkge1xyXG4gICAgICAgICAgICBhY3Rpb25zRWwucHJlcGVuZChidXR0b25FbCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gYnV0dG9uRWw7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBNZXQgXHUwMEUwIGpvdXIgbCdhcHBhcmVuY2UgZHUgYm91dG9uIGRlIGxhIGJhcnJlIGQnXHUwMEU5dGF0XHJcbiAqIEBwYXJhbSBidXR0b25FbCBcdTAwQzlsXHUwMEU5bWVudCBIVE1MIGR1IGJvdXRvblxyXG4gKiBAcGFyYW0gaXNFbmFibGVkIFx1MDBDOXRhdCAoYWN0aXZcdTAwRTkvZFx1MDBFOXNhY3Rpdlx1MDBFOSlcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVTdGF0dXNCYXJCdXR0b24oYnV0dG9uRWw6IEhUTUxFbGVtZW50IHwgbnVsbCwgaXNFbmFibGVkOiBib29sZWFuKTogdm9pZCB7XHJcbiAgICBpZiAoIWJ1dHRvbkVsKSByZXR1cm47XHJcbiAgICBcclxuICAgIGlmIChpc0VuYWJsZWQpIHtcclxuICAgICAgICBidXR0b25FbC5hZGRDbGFzcygnaGlnaGxpZ2h0LWVuYWJsZWQnKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgYnV0dG9uRWwucmVtb3ZlQ2xhc3MoJ2hpZ2hsaWdodC1lbmFibGVkJyk7XHJcbiAgICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBNZXQgXHUwMEUwIGpvdXIgbCdhcHBhcmVuY2UgZHUgYm91dG9uIGRlIGxhIGJhcnJlIGRlIHRpdHJlXHJcbiAqIEBwYXJhbSBidXR0b25FbCBcdTAwQzlsXHUwMEU5bWVudCBIVE1MIGR1IGJvdXRvblxyXG4gKiBAcGFyYW0gaXNFbmFibGVkIFx1MDBDOXRhdCAoYWN0aXZcdTAwRTkvZFx1MDBFOXNhY3Rpdlx1MDBFOSlcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVUYWJUaXRsZUJhckJ1dHRvbihidXR0b25FbDogSFRNTEVsZW1lbnQgfCBudWxsLCBpc0VuYWJsZWQ6IGJvb2xlYW4pOiB2b2lkIHtcclxuICAgIGlmICghYnV0dG9uRWwpIHJldHVybjtcclxuICAgIFxyXG4gICAgaWYgKGlzRW5hYmxlZCkge1xyXG4gICAgICAgIGJ1dHRvbkVsLmFkZENsYXNzKCdpcy1hY3RpdmUnKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgYnV0dG9uRWwucmVtb3ZlQ2xhc3MoJ2lzLWFjdGl2ZScpO1xyXG4gICAgfVxyXG59XHJcblxyXG4vKipcclxuICogU3VwcHJpbWUgbGUgYm91dG9uIGRlIGxhIGJhcnJlIGQnXHUwMEU5dGF0XHJcbiAqIEBwYXJhbSBidXR0b25FbCBcdTAwQzlsXHUwMEU5bWVudCBIVE1MIGR1IGJvdXRvblxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZVN0YXR1c0JhckJ1dHRvbihidXR0b25FbDogSFRNTEVsZW1lbnQgfCBudWxsKTogdm9pZCB7XHJcbiAgICBpZiAoYnV0dG9uRWwpIHtcclxuICAgICAgICBidXR0b25FbC5yZW1vdmUoKTtcclxuICAgIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFN1cHByaW1lIGxlIGJvdXRvbiBkZSBsYSBiYXJyZSBkZSB0aXRyZVxyXG4gKiBAcGFyYW0gYnV0dG9uRWwgXHUwMEM5bFx1MDBFOW1lbnQgSFRNTCBkdSBib3V0b25cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiByZW1vdmVUYWJUaXRsZUJhckJ1dHRvbihidXR0b25FbDogSFRNTEVsZW1lbnQgfCBudWxsKTogdm9pZCB7XHJcbiAgICBpZiAoYnV0dG9uRWwpIHtcclxuICAgICAgICBidXR0b25FbC5yZW1vdmUoKTtcclxuICAgIH1cclxufSIsICIvKipcclxuICogSW50ZXJmYWNlIHBvdXIgbGVzIHBvc2l0aW9ucyBkYW5zIGwnXHUwMEU5ZGl0ZXVyXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIEVkaXRvclBvc2l0aW9uIHtcclxuICAgIGxpbmU6IG51bWJlcjtcclxuICAgIGNoOiBudW1iZXI7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBJbnRlcmZhY2UgcG91ciBsZSByXHUwMEU5c3VsdGF0IGRlIGwnYW5hbHlzZSBkZXMgYmxvY3NcclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgQmxvY2tBbmFseXNpc1Jlc3VsdCB7XHJcbiAgICBsaW5lVHlwZXM6IHN0cmluZ1tdO1xyXG59XHJcblxyXG4vKipcclxuICogQW5hbHlzZSBsYSBzdHJ1Y3R1cmUgZHUgZG9jdW1lbnQgcG91ciBpZGVudGlmaWVyIGxlcyBibG9jcyBzcFx1MDBFOWNpYXV4XHJcbiAqIEBwYXJhbSBkb2N1bWVudFRleHQgVGV4dGUgY29tcGxldCBkdSBkb2N1bWVudFxyXG4gKiBAcGFyYW0gc3RhcnRMaW5lIExpZ25lIGRlIGRcdTAwRTlidXQgZGUgbGEgc1x1MDBFOWxlY3Rpb25cclxuICogQHBhcmFtIGVuZExpbmUgTGlnbmUgZGUgZmluIGRlIGxhIHNcdTAwRTlsZWN0aW9uXHJcbiAqIEByZXR1cm5zIFJcdTAwRTlzdWx0YXQgZGUgbCdhbmFseXNlIGF2ZWMgdHlwZXMgZGUgbGlnbmVzXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gYW5hbHl6ZURvY3VtZW50U3RydWN0dXJlKGRvY3VtZW50VGV4dDogc3RyaW5nLCBzdGFydExpbmU6IG51bWJlciwgZW5kTGluZTogbnVtYmVyKTogQmxvY2tBbmFseXNpc1Jlc3VsdCB7XHJcbiAgICBjb25zdCBsaW5lcyA9IGRvY3VtZW50VGV4dC5zcGxpdCgnXFxuJyk7XHJcbiAgICBjb25zdCBsaW5lVHlwZXMgPSBuZXcgQXJyYXkoZW5kTGluZSAtIHN0YXJ0TGluZSArIDEpLmZpbGwoJ25vcm1hbCcpO1xyXG4gICAgXHJcbiAgICBsZXQgaW5Gcm9udG1hdHRlciA9IGZhbHNlO1xyXG4gICAgbGV0IGluQ29kZUJsb2NrID0gZmFsc2U7XHJcbiAgICBcclxuICAgIC8vIFVuZSBzZXVsZSBwYXNzZSBwb3VyIGFuYWx5c2VyIHRvdXQgbGUgZG9jdW1lbnRcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGluZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBjb25zdCBsaW5lID0gbGluZXNbaV07XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKGxpbmUudHJpbSgpID09PSAnLS0tJykge1xyXG4gICAgICAgICAgICBpbkZyb250bWF0dGVyID0gIWluRnJvbnRtYXR0ZXI7XHJcbiAgICAgICAgfSBlbHNlIGlmIChsaW5lLnRyaW0oKS5zdGFydHNXaXRoKCdgYGAnKSkge1xyXG4gICAgICAgICAgICBpbkNvZGVCbG9jayA9ICFpbkNvZGVCbG9jaztcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gU2kgbm91cyBzb21tZXMgZGFucyBsJ2ludGVydmFsbGUgZGUgc1x1MDBFOWxlY3Rpb24sIGVucmVnaXN0cmVyIGxlIHR5cGVcclxuICAgICAgICBpZiAoaSA+PSBzdGFydExpbmUgJiYgaSA8PSBlbmRMaW5lKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlbGF0aXZlSW5kZXggPSBpIC0gc3RhcnRMaW5lO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgaWYgKGxpbmUudHJpbSgpID09PSAnLS0tJyB8fCBsaW5lLnRyaW0oKS5zdGFydHNXaXRoKCdgYGAnKSkge1xyXG4gICAgICAgICAgICAgICAgbGluZVR5cGVzW3JlbGF0aXZlSW5kZXhdID0gJ2RlbGltaXRlcic7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaW5Gcm9udG1hdHRlcikge1xyXG4gICAgICAgICAgICAgICAgbGluZVR5cGVzW3JlbGF0aXZlSW5kZXhdID0gJ2Zyb250bWF0dGVyJztcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChpbkNvZGVCbG9jaykge1xyXG4gICAgICAgICAgICAgICAgbGluZVR5cGVzW3JlbGF0aXZlSW5kZXhdID0gJ2NvZGUnO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFNpIG5vdXMgYXZvbnMgZFx1MDBFOXBhc3NcdTAwRTkgbCdpbnRlcnZhbGxlLCBub3VzIHBvdXZvbnMgc29ydGlyXHJcbiAgICAgICAgaWYgKGkgPiBlbmRMaW5lKSBicmVhaztcclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIHsgbGluZVR5cGVzIH07XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBWXHUwMEU5cmlmaWUgc2kgdW5lIGxpZ25lIHNwXHUwMEU5Y2lmaXF1ZSBzZSB0cm91dmUgZGFucyB1biBibG9jIHNwXHUwMEU5Y2lhbFxyXG4gKiBAcGFyYW0gZG9jdW1lbnRUZXh0IFRleHRlIGNvbXBsZXQgZHUgZG9jdW1lbnRcclxuICogQHBhcmFtIGxpbmVOdW1iZXIgTnVtXHUwMEU5cm8gZGUgbGlnbmUgXHUwMEUwIHZcdTAwRTlyaWZpZXJcclxuICogQHJldHVybnMgdHJ1ZSBzaSBsYSBsaWduZSBlc3QgZGFucyB1biBibG9jIHNwXHUwMEU5Y2lhbFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGlzTGluZUluU3BlY2lhbEJsb2NrKGRvY3VtZW50VGV4dDogc3RyaW5nLCBsaW5lTnVtYmVyOiBudW1iZXIpOiBib29sZWFuIHtcclxuICAgIGNvbnN0IGxpbmVzID0gZG9jdW1lbnRUZXh0LnNwbGl0KCdcXG4nKTtcclxuICAgIFxyXG4gICAgbGV0IGluRnJvbnRtYXR0ZXIgPSBmYWxzZTtcclxuICAgIGxldCBpbkNvZGVCbG9jayA9IGZhbHNlO1xyXG4gICAgXHJcbiAgICAvLyBBbmFseXNlciBsZSBkb2N1bWVudCBqdXNxdSdcdTAwRTAgbGEgbGlnbmUgc3BcdTAwRTljaWZpXHUwMEU5ZVxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPD0gbGluZU51bWJlcjsgaSsrKSB7XHJcbiAgICAgICAgY29uc3QgbGluZSA9IGxpbmVzW2ldO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmIChsaW5lLnRyaW0oKSA9PT0gJy0tLScpIHtcclxuICAgICAgICAgICAgaW5Gcm9udG1hdHRlciA9ICFpbkZyb250bWF0dGVyO1xyXG4gICAgICAgIH0gZWxzZSBpZiAobGluZS50cmltKCkuc3RhcnRzV2l0aCgnYGBgJykpIHtcclxuICAgICAgICAgICAgaW5Db2RlQmxvY2sgPSAhaW5Db2RlQmxvY2s7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFNpIG5vdXMgc29tbWVzIFx1MDBFMCBsYSBsaWduZSBjaWJsZSwgcmV0b3VybmVyIGxlIHJcdTAwRTlzdWx0YXRcclxuICAgICAgICBpZiAoaSA9PT0gbGluZU51bWJlcikge1xyXG4gICAgICAgICAgICByZXR1cm4gaW5Gcm9udG1hdHRlciB8fCBpbkNvZGVCbG9jaztcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJldHVybiBmYWxzZTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEFuYWx5c2UgcmFwaWRlIHBvdXIgZFx1MDBFOXRlY3RlciBsZSB0eXBlIGRlIGJsb2MgZCd1bmUgbGlnbmVcclxuICogQHBhcmFtIGRvY3VtZW50VGV4dCBUZXh0ZSBkdSBkb2N1bWVudFxyXG4gKiBAcGFyYW0gbGluZU51bWJlciBOdW1cdTAwRTlybyBkZSBsaWduZVxyXG4gKiBAcmV0dXJucyBUeXBlIGRlIGJsb2M6ICdub3JtYWwnLCAnZnJvbnRtYXR0ZXInLCAnY29kZScsICdkZWxpbWl0ZXInXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0TGluZUJsb2NrVHlwZShkb2N1bWVudFRleHQ6IHN0cmluZywgbGluZU51bWJlcjogbnVtYmVyKTogc3RyaW5nIHtcclxuICAgIGNvbnN0IGxpbmVzID0gZG9jdW1lbnRUZXh0LnNwbGl0KCdcXG4nKTtcclxuICAgIGNvbnN0IGxpbmUgPSBsaW5lc1tsaW5lTnVtYmVyXTtcclxuICAgIFxyXG4gICAgLy8gVlx1MDBFOXJpZmllciBzaSBjJ2VzdCB1biBkXHUwMEU5bGltaXRldXJcclxuICAgIGlmIChsaW5lLnRyaW0oKSA9PT0gJy0tLScgfHwgbGluZS50cmltKCkuc3RhcnRzV2l0aCgnYGBgJykpIHtcclxuICAgICAgICByZXR1cm4gJ2RlbGltaXRlcic7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIFZcdTAwRTlyaWZpZXIgc2kgbGEgbGlnbmUgZXN0IGRhbnMgdW4gYmxvYyBzcFx1MDBFOWNpYWxcclxuICAgIGlmIChpc0xpbmVJblNwZWNpYWxCbG9jayhkb2N1bWVudFRleHQsIGxpbmVOdW1iZXIpKSB7XHJcbiAgICAgICAgLy8gRFx1MDBFOXRlcm1pbmVyIGxlIHR5cGUgZGUgYmxvYyBzcFx1MDBFOWNpYWxcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhbmFseXplRG9jdW1lbnRTdHJ1Y3R1cmUoZG9jdW1lbnRUZXh0LCBsaW5lTnVtYmVyLCBsaW5lTnVtYmVyKTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0LmxpbmVUeXBlc1swXTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuICdub3JtYWwnO1xyXG59IiwgImltcG9ydCB7IFBsdWdpbiwgRWRpdG9yIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbmltcG9ydCB7IGlzTGluZUluU3BlY2lhbEJsb2NrIH0gZnJvbSBcIi4uL2NvcmUvYmxvY2tBbmFseXplclwiO1xyXG5cclxuXHJcbi8qKlxyXG4gKiBWXHUwMEU5cmlmaWUgc2kgbGUgY3Vyc2V1ciBlc3QgZGFucyB1biBibG9jIHNwXHUwMEU5Y2lhbCAoZnJvbnRtYXR0ZXIgb3UgY29kZSlcclxuICogQHBhcmFtIGVkaXRvciBcdTAwQzlkaXRldXIgT2JzaWRpYW5cclxuICogQHJldHVybnMgdHJ1ZSBzaSBsZSBjdXJzZXVyIGVzdCBkYW5zIHVuIGJsb2Mgc3BcdTAwRTljaWFsXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gaXNJblNwZWNpYWxCbG9jayhlZGl0b3I6IEVkaXRvcik6IGJvb2xlYW4ge1xyXG4gICAgY29uc3QgY3Vyc29yID0gZWRpdG9yLmdldEN1cnNvcigpO1xyXG4gICAgY29uc3QgdGV4dCA9IGVkaXRvci5nZXRWYWx1ZSgpO1xyXG4gICAgXHJcbiAgICByZXR1cm4gaXNMaW5lSW5TcGVjaWFsQmxvY2sodGV4dCwgY3Vyc29yLmxpbmUpO1xyXG59XHJcblxyXG5cclxuLyoqXHJcbiAqIFZcdTAwRTlyaWZpZSBzaSBsZSBjdXJzZXVyIGVzdCBkYW5zIHVuIFx1MDBFOWxcdTAwRTltZW50IE1hcmtkb3duIHNwXHUwMEU5Y2lhbCBcdTAwRTAgcHJcdTAwRTlzZXJ2ZXJcclxuICogQHBhcmFtIGVkaXRvciBcdTAwQzlkaXRldXIgT2JzaWRpYW5cclxuICogQHJldHVybnMgdHJ1ZSBzaSBsZSBjdXJzZXVyIGVzdCBkYW5zIHVuIFx1MDBFOWxcdTAwRTltZW50IFx1MDBFMCBwclx1MDBFOXNlcnZlclxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGlzSW5QcmVzZXJ2ZWRNYXJrZG93bihlZGl0b3I6IEVkaXRvcik6IGJvb2xlYW4ge1xyXG4gICAgY29uc3QgY3Vyc29yID0gZWRpdG9yLmdldEN1cnNvcigpO1xyXG4gICAgY29uc3QgbGluZSA9IGVkaXRvci5nZXRMaW5lKGN1cnNvci5saW5lKTtcclxuICAgIFxyXG4gICAgLy8gMS4gVlx1MDBFOXJpZmllciBzaSBvbiBlc3QgZGFucyB1biBjb2RlIGlubGluZSAoZW50cmUgYmFja3RpY2tzKVxyXG4gICAgY29uc3QgY29kZUlubGluZVBhdHRlcm4gPSAvYFteYF0qYC9nO1xyXG4gICAgY29uc3QgY29kZUlubGluZU1hdGNoZXMgPSBbLi4ubGluZS5tYXRjaEFsbChjb2RlSW5saW5lUGF0dGVybildO1xyXG4gICAgZm9yIChjb25zdCBtYXRjaCBvZiBjb2RlSW5saW5lTWF0Y2hlcykge1xyXG4gICAgICAgIGNvbnN0IHN0YXJ0ID0gbWF0Y2guaW5kZXggfHwgMDtcclxuICAgICAgICBjb25zdCBlbmQgPSBzdGFydCArIG1hdGNoWzBdLmxlbmd0aDtcclxuICAgICAgICBpZiAoY3Vyc29yLmNoID49IHN0YXJ0ICYmIGN1cnNvci5jaCA8PSBlbmQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyAyLiBWXHUwMEU5cmlmaWVyIHNpIG9uIGVzdCBkYW5zIHVuIGxpZW4gaW50ZXJuZSBPYnNpZGlhblxyXG4gICAgY29uc3Qgb2JzaWRpYW5MaW5rUGF0dGVybiA9IC9cXFtcXFtbXlxcXV0qXFxdXFxdL2c7XHJcbiAgICBjb25zdCBvYnNpZGlhbkxpbmtNYXRjaGVzID0gWy4uLmxpbmUubWF0Y2hBbGwob2JzaWRpYW5MaW5rUGF0dGVybildO1xyXG4gICAgZm9yIChjb25zdCBtYXRjaCBvZiBvYnNpZGlhbkxpbmtNYXRjaGVzKSB7XHJcbiAgICAgICAgY29uc3Qgc3RhcnQgPSBtYXRjaC5pbmRleCB8fCAwO1xyXG4gICAgICAgIGNvbnN0IGVuZCA9IHN0YXJ0ICsgbWF0Y2hbMF0ubGVuZ3RoO1xyXG4gICAgICAgIGlmIChjdXJzb3IuY2ggPj0gc3RhcnQgJiYgY3Vyc29yLmNoIDw9IGVuZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIDMuIFZcdTAwRTlyaWZpZXIgc2kgb24gZXN0IGRhbnMgdW5lIFx1MDBFOXF1YXRpb24gbWF0aFx1MDBFOW1hdGlxdWUgaW5saW5lXHJcbiAgICBjb25zdCBtYXRoSW5saW5lUGF0dGVybiA9IC9cXCRbXiRdKlxcJC9nO1xyXG4gICAgY29uc3QgbWF0aElubGluZU1hdGNoZXMgPSBbLi4ubGluZS5tYXRjaEFsbChtYXRoSW5saW5lUGF0dGVybildO1xyXG4gICAgZm9yIChjb25zdCBtYXRjaCBvZiBtYXRoSW5saW5lTWF0Y2hlcykge1xyXG4gICAgICAgIGNvbnN0IHN0YXJ0ID0gbWF0Y2guaW5kZXggfHwgMDtcclxuICAgICAgICBjb25zdCBlbmQgPSBzdGFydCArIG1hdGNoWzBdLmxlbmd0aDtcclxuICAgICAgICBpZiAoY3Vyc29yLmNoID49IHN0YXJ0ICYmIGN1cnNvci5jaCA8PSBlbmQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyA0LiBWXHUwMEU5cmlmaWVyIHNpIG9uIGVzdCBkYW5zIHVuZSBcdTAwRTlxdWF0aW9uIG1hdGhcdTAwRTltYXRpcXVlIGJsb2NcclxuICAgIC8vIE9uIG5lIHZcdTAwRTlyaWZpZSBxdWUgbGUgZFx1MDBFOWJ1dCBldCBsYSBmaW4gY2FyIGxlIGJsb2MgcGV1dCBzJ1x1MDBFOXRlbmRyZSBzdXIgcGx1c2lldXJzIGxpZ25lc1xyXG4gICAgaWYgKGxpbmUuaW5jbHVkZXMoXCIkJFwiKSkge1xyXG4gICAgICAgIGNvbnN0IG1hdGNoZXMgPSBbLi4ubGluZS5tYXRjaEFsbCgvXFwkXFwkL2cpXTtcclxuICAgICAgICBmb3IgKGNvbnN0IG1hdGNoIG9mIG1hdGNoZXMpIHtcclxuICAgICAgICAgICAgY29uc3Qgc3RhcnQgPSBtYXRjaC5pbmRleCB8fCAwO1xyXG4gICAgICAgICAgICBjb25zdCBlbmQgPSBzdGFydCArIDI7XHJcbiAgICAgICAgICAgIGlmIChjdXJzb3IuY2ggPj0gc3RhcnQgJiYgY3Vyc29yLmNoIDw9IGVuZCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIDUuIFZcdTAwRTlyaWZpZXIgc2kgb24gZXN0IGRhbnMgdW4gY2FsbG91dFxyXG4gICAgY29uc3QgY2FsbG91dFBhdHRlcm4gPSAvXj5cXHMrXFxbIS4qXFxdLztcclxuICAgIGlmIChjYWxsb3V0UGF0dGVybi50ZXN0KGxpbmUpICYmIGN1cnNvci5jaCA8PSBsaW5lLmxlbmd0aCkge1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyA2LiBWXHUwMEU5cmlmaWVyIHNpIG9uIGVzdCBkYW5zIHVuZSBVUkwgZGlyZWN0ZVxyXG4gICAgY29uc3QgdXJsUGF0dGVybiA9IC8oaHR0cHM/OlxcL1xcL3x3d3dcXC4pW15cXHNdKy9nO1xyXG4gICAgY29uc3QgdXJsTWF0Y2hlcyA9IFsuLi5saW5lLm1hdGNoQWxsKHVybFBhdHRlcm4pXTtcclxuICAgIGZvciAoY29uc3QgbWF0Y2ggb2YgdXJsTWF0Y2hlcykge1xyXG4gICAgICAgIGNvbnN0IHN0YXJ0ID0gbWF0Y2guaW5kZXggfHwgMDtcclxuICAgICAgICBjb25zdCBlbmQgPSBzdGFydCArIG1hdGNoWzBdLmxlbmd0aDtcclxuICAgICAgICBpZiAoY3Vyc29yLmNoID49IHN0YXJ0ICYmIGN1cnNvci5jaCA8PSBlbmQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyA3LiBQb3VyIGxlcyBpbWFnZXMgZXQgbGllbnMsIHZcdTAwRTlyaWZpZXIgc2kgbGUgY3Vyc2V1ciBlc3QgXHUwMEUwIGwnaW50XHUwMEU5cmlldXJcclxuICAgIGNvbnN0IGltYWdlUGF0dGVybiA9IC8hXFxbLio/XFxdXFwoLio/XFwpL2c7XHJcbiAgICBjb25zdCBpbWFnZU1hdGNoZXMgPSBbLi4ubGluZS5tYXRjaEFsbChpbWFnZVBhdHRlcm4pXTtcclxuICAgIGZvciAoY29uc3QgbWF0Y2ggb2YgaW1hZ2VNYXRjaGVzKSB7XHJcbiAgICAgICAgY29uc3Qgc3RhcnQgPSBtYXRjaC5pbmRleCB8fCAwO1xyXG4gICAgICAgIGNvbnN0IGVuZCA9IHN0YXJ0ICsgbWF0Y2hbMF0ubGVuZ3RoO1xyXG4gICAgICAgIGlmIChjdXJzb3IuY2ggPj0gc3RhcnQgJiYgY3Vyc29yLmNoIDw9IGVuZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIDguIFBvdXIgbGVzIGxpZW5zIE1hcmtkb3duXHJcbiAgICBjb25zdCBsaW5rUGF0dGVybiA9IC9cXFsuKj9cXF1cXCguKj9cXCkvZztcclxuICAgIGNvbnN0IGxpbmtNYXRjaGVzID0gWy4uLmxpbmUubWF0Y2hBbGwobGlua1BhdHRlcm4pXTtcclxuICAgIGZvciAoY29uc3QgbWF0Y2ggb2YgbGlua01hdGNoZXMpIHtcclxuICAgICAgICBjb25zdCBzdGFydCA9IG1hdGNoLmluZGV4IHx8IDA7XHJcbiAgICAgICAgY29uc3QgZW5kID0gc3RhcnQgKyBtYXRjaFswXS5sZW5ndGg7XHJcbiAgICAgICAgaWYgKGN1cnNvci5jaCA+PSBzdGFydCAmJiBjdXJzb3IuY2ggPD0gZW5kKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gOS4gUG91ciBsZXMgYmFsaXNlcyBIVE1MXHJcbiAgICBjb25zdCBodG1sVGFnUGF0dGVybiA9IC88W14+XSo+L2c7XHJcbiAgICBjb25zdCBodG1sTWF0Y2hlcyA9IFsuLi5saW5lLm1hdGNoQWxsKGh0bWxUYWdQYXR0ZXJuKV07XHJcbiAgICBmb3IgKGNvbnN0IG1hdGNoIG9mIGh0bWxNYXRjaGVzKSB7XHJcbiAgICAgICAgY29uc3Qgc3RhcnQgPSBtYXRjaC5pbmRleCB8fCAwO1xyXG4gICAgICAgIGNvbnN0IGVuZCA9IHN0YXJ0ICsgbWF0Y2hbMF0ubGVuZ3RoO1xyXG4gICAgICAgIGlmIChjdXJzb3IuY2ggPj0gc3RhcnQgJiYgY3Vyc29yLmNoIDw9IGVuZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIDEwLiBWXHUwMEU5cmlmaWVyIHNpIG9uIGVzdCBkYW5zIHVuIGlkZW50aWZpYW50IGRlIHRcdTAwRTJjaGVcclxuICAgIGNvbnN0IHRhc2tQYXR0ZXJuID0gL15cXHMqLSBcXFtbIHhdXFxdLztcclxuICAgIGlmICh0YXNrUGF0dGVybi50ZXN0KGxpbmUpICYmIGN1cnNvci5jaCA8PSBsaW5lLmluZGV4T2YoXCJdXCIpICsgMSkge1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbn1cclxuXHJcblxyXG4vKipcclxuICogSW5qZWN0ZSB1biBmaWNoaWVyIENTUyBkYW5zIGxlIGRvY3VtZW50XHJcbiAqIEBwYXJhbSBwbHVnaW4gSW5zdGFuY2UgZHUgcGx1Z2luXHJcbiAqIEBwYXJhbSBmaWxlTmFtZSBOb20gZHUgZmljaGllciBDU1MgKHJlbGF0aWYgYXUgclx1MDBFOXBlcnRvaXJlIGR1IHBsdWdpbilcclxuICogQHJldHVybnMgUHJvbWVzc2Ugclx1MDBFOXNvbHVlIHVuZSBmb2lzIGxlIENTUyBpbmplY3RcdTAwRTlcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpbmplY3RDU1NGcm9tRmlsZShwbHVnaW46IFBsdWdpbiwgZmlsZU5hbWU6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBwbHVnaW5EaXIgPSBwbHVnaW4ubWFuaWZlc3QuZGlyO1xyXG4gICAgICAgIGNvbnN0IGZpbGVQYXRoID0gYCR7cGx1Z2luRGlyfS8ke2ZpbGVOYW1lfWA7XHJcblxyXG4gICAgICAgIGNvbnN0IGNzc0NvbnRlbnQgPSBhd2FpdCBwbHVnaW4uYXBwLnZhdWx0LmFkYXB0ZXIucmVhZChmaWxlUGF0aCk7XHJcbiAgICAgICAgY29uc3Qgc3R5bGVFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3N0eWxlJyk7XHJcbiAgICAgICAgc3R5bGVFbC50ZXh0Q29udGVudCA9IGNzc0NvbnRlbnQ7XHJcbiAgICAgICAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChzdHlsZUVsKTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcIlx1MDBDOWNoZWMgZGUgY2hhcmdlbWVudCBkdSBmaWNoaWVyIENTUzpcIiwgZXJyb3IpO1xyXG4gICAgfVxyXG59XHJcblxyXG4vKipcclxuICogVlx1MDBFOXJpZmllIHNpIHVuZSBjaGFcdTAwRUVuZSBkZSBjYXJhY3RcdTAwRThyZXMgZXN0IHZpZGUgb3UgbmUgY29udGllbnQgcXVlIGRlcyBlc3BhY2VzXHJcbiAqIEBwYXJhbSBzdHIgQ2hhXHUwMEVFbmUgXHUwMEUwIHZcdTAwRTlyaWZpZXJcclxuICogQHJldHVybnMgdHJ1ZSBzaSBsYSBjaGFcdTAwRUVuZSBlc3QgdmlkZSBvdSBuZSBjb250aWVudCBxdWUgZGVzIGVzcGFjZXNcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBpc0VtcHR5T3JXaGl0ZXNwYWNlKHN0cjogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gc3RyID09PSBudWxsIHx8IHN0ci50cmltKCkgPT09ICcnO1xyXG59XHJcblxyXG4vKipcclxuICogT2J0aWVudCBsYSBwb3NpdGlvbiBkdSB0ZXh0ZSBkYW5zIHVuIGRvY3VtZW50XHJcbiAqIEBwYXJhbSB0ZXh0IFRleHRlIGNvbXBsZXRcclxuICogQHBhcmFtIHNlYXJjaFRleHQgVGV4dGUgXHUwMEUwIHJlY2hlcmNoZXJcclxuICogQHBhcmFtIHN0YXJ0SW5kZXggSW5kZXggZGUgZFx1MDBFOXBhcnQgcG91ciBsYSByZWNoZXJjaGUgKG9wdGlvbm5lbClcclxuICogQHJldHVybnMgT2JqZXQgYXZlYyBsZXMgcHJvcHJpXHUwMEU5dFx1MDBFOXMgZnJvbUxpbmUsIGZyb21DaCwgdG9MaW5lLCB0b0NoIG91IG51bGwgc2kgbm9uIHRyb3V2XHUwMEU5XHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0VGV4dFBvc2l0aW9uKHRleHQ6IHN0cmluZywgc2VhcmNoVGV4dDogc3RyaW5nLCBzdGFydEluZGV4ID0gMCk6IHtcclxuICAgIGZyb21MaW5lOiBudW1iZXIsIFxyXG4gICAgZnJvbUNoOiBudW1iZXIsIFxyXG4gICAgdG9MaW5lOiBudW1iZXIsIFxyXG4gICAgdG9DaDogbnVtYmVyXHJcbn0gfCBudWxsIHtcclxuICAgIGNvbnN0IGluZGV4ID0gdGV4dC5pbmRleE9mKHNlYXJjaFRleHQsIHN0YXJ0SW5kZXgpO1xyXG4gICAgaWYgKGluZGV4ID09PSAtMSkge1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBjb25zdCB0ZXh0QmVmb3JlID0gdGV4dC5zdWJzdHJpbmcoMCwgaW5kZXgpO1xyXG4gICAgY29uc3QgbGluZXMgPSB0ZXh0QmVmb3JlLnNwbGl0KCdcXG4nKTtcclxuICAgIGNvbnN0IGZyb21MaW5lID0gbGluZXMubGVuZ3RoIC0gMTtcclxuICAgIGNvbnN0IGZyb21DaCA9IGxpbmVzW2Zyb21MaW5lXS5sZW5ndGg7XHJcbiAgICBcclxuICAgIGNvbnN0IHNlYXJjaExpbmVzID0gc2VhcmNoVGV4dC5zcGxpdCgnXFxuJyk7XHJcbiAgICBjb25zdCB0b0xpbmUgPSBmcm9tTGluZSArIHNlYXJjaExpbmVzLmxlbmd0aCAtIDE7XHJcbiAgICBjb25zdCB0b0NoID0gdG9MaW5lID09PSBmcm9tTGluZSA/IFxyXG4gICAgICAgIGZyb21DaCArIHNlYXJjaFRleHQubGVuZ3RoIDogXHJcbiAgICAgICAgc2VhcmNoTGluZXNbc2VhcmNoTGluZXMubGVuZ3RoIC0gMV0ubGVuZ3RoO1xyXG4gICAgXHJcbiAgICByZXR1cm4geyBmcm9tTGluZSwgZnJvbUNoLCB0b0xpbmUsIHRvQ2ggfTtcclxufVxyXG5cclxuLyoqXHJcbiAqIE1lc3VyZSBsZSB0ZW1wcyBkJ2V4XHUwMEU5Y3V0aW9uIGQndW5lIGZvbmN0aW9uXHJcbiAqIEBwYXJhbSBmbiBGb25jdGlvbiBcdTAwRTAgbWVzdXJlclxyXG4gKiBAcGFyYW0gYXJncyBBcmd1bWVudHMgXHUwMEUwIHBhc3NlciBcdTAwRTAgbGEgZm9uY3Rpb25cclxuICogQHJldHVybnMgTGUgclx1MDBFOXN1bHRhdCBkZSBsYSBmb25jdGlvbiBldCBsZSB0ZW1wcyBkJ2V4XHUwMEU5Y3V0aW9uIGVuIG1zXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbWVhc3VyZUV4ZWN1dGlvblRpbWU8VCwgQSBleHRlbmRzIGFueVtdPihcclxuICAgIGZuOiAoLi4uYXJnczogQSkgPT4gUHJvbWlzZTxUPiB8IFQsIFxyXG4gICAgLi4uYXJnczogQVxyXG4pOiBQcm9taXNlPHsgcmVzdWx0OiBULCBleGVjdXRpb25UaW1lOiBudW1iZXIgfT4ge1xyXG4gICAgY29uc3Qgc3RhcnRUaW1lID0gcGVyZm9ybWFuY2Uubm93KCk7XHJcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBmbiguLi5hcmdzKTtcclxuICAgIGNvbnN0IGVuZFRpbWUgPSBwZXJmb3JtYW5jZS5ub3coKTtcclxuICAgIGNvbnN0IGV4ZWN1dGlvblRpbWUgPSBlbmRUaW1lIC0gc3RhcnRUaW1lO1xyXG4gICAgXHJcbiAgICByZXR1cm4geyByZXN1bHQsIGV4ZWN1dGlvblRpbWUgfTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEFmZmljaGUgdW4gbWVzc2FnZSBkZSBwZXJmb3JtYW5jZSBkYW5zIGxhIGNvbnNvbGVcclxuICogQHBhcmFtIG9wZXJhdGlvbiBOb20gZGUgbCdvcFx1MDBFOXJhdGlvblxyXG4gKiBAcGFyYW0gZXhlY3V0aW9uVGltZSBUZW1wcyBkJ2V4XHUwMEU5Y3V0aW9uIGVuIG1zXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gbG9nUGVyZm9ybWFuY2Uob3BlcmF0aW9uOiBzdHJpbmcsIGV4ZWN1dGlvblRpbWU6IG51bWJlcik6IHZvaWQge1xyXG4gICAgY29uc29sZS5sb2coYFBlcmZvcm1hbmNlIC0gJHtvcGVyYXRpb259OiAke2V4ZWN1dGlvblRpbWUudG9GaXhlZCgyKX1tc2ApO1xyXG59XHJcblxyXG4vKipcclxuICogRXhcdTAwRTljdXRlIHVuZSBmb25jdGlvbiBhdmVjIHVuIGRcdTAwRTlsYWkgZCdhdHRlbnRlXHJcbiAqIENldHRlIGZvbmN0aW9uIGVzdCB1dGlsZSBwb3VyIFx1MDBFOXZpdGVyIGRlIGJsb3F1ZXIgbCdpbnRlcmZhY2UgdXRpbGlzYXRldXJcclxuICogQHBhcmFtIGZuIEZvbmN0aW9uIFx1MDBFMCBleFx1MDBFOWN1dGVyXHJcbiAqIEBwYXJhbSBkZWxheSBEXHUwMEU5bGFpIGVuIG1zXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZGVib3VuY2U8RiBleHRlbmRzICguLi5hcmdzOiBhbnlbXSkgPT4gYW55PihmbjogRiwgZGVsYXk6IG51bWJlcik6ICguLi5hcmdzOiBQYXJhbWV0ZXJzPEY+KSA9PiB2b2lkIHtcclxuICAgIGxldCB0aW1lb3V0OiBOb2RlSlMuVGltZW91dDtcclxuICAgIFxyXG4gICAgcmV0dXJuIGZ1bmN0aW9uKC4uLmFyZ3M6IFBhcmFtZXRlcnM8Rj4pIHtcclxuICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dCk7XHJcbiAgICAgICAgdGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4gZm4oLi4uYXJncyksIGRlbGF5KTtcclxuICAgIH07XHJcbn0iLCAiLy8gTW9kdWxlIGQnYXBlclx1MDBFN3UgZGlyZWN0IG1pcyBcdTAwRTAgam91clxyXG5cclxuaW1wb3J0IHsgRWRpdG9yIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbmltcG9ydCB7IE1pY3JvdHlwb2dyYXBoaWVTZXR0aW5ncyB9IGZyb20gJy4uL3NldHRpbmdzL3NldHRpbmdzJztcclxuaW1wb3J0IHsgaXNJblNwZWNpYWxCbG9jaywgaXNJblByZXNlcnZlZE1hcmtkb3duIH0gZnJvbSAnLi4vdXRpbHMvaGVscGVycyc7XHJcblxyXG5leHBvcnQgY2xhc3MgTGl2ZVR5cG9ncmFwaHlNb2R1bGUge1xyXG4gICAgcHJpdmF0ZSBzZXR0aW5nczogTWljcm90eXBvZ3JhcGhpZVNldHRpbmdzO1xyXG4gICAgcHJpdmF0ZSBvcGVuUXVvdGU6IGJvb2xlYW4gPSB0cnVlO1xyXG4gICAgXHJcbiAgICBjb25zdHJ1Y3RvcihzZXR0aW5nczogTWljcm90eXBvZ3JhcGhpZVNldHRpbmdzKSB7XHJcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IHNldHRpbmdzO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogSW5pdGlhbGlzZSBsZSBtb2R1bGUgYXZlYyBsZXMgcGFyYW1cdTAwRTh0cmVzIGFjdHVlbHNcclxuICAgICAqIEBwYXJhbSBzZXR0aW5ncyBQYXJhbVx1MDBFOHRyZXMgbWlzIFx1MDBFMCBqb3VyXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyB1cGRhdGVTZXR0aW5ncyhzZXR0aW5nczogTWljcm90eXBvZ3JhcGhpZVNldHRpbmdzKSB7XHJcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IHNldHRpbmdzO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBwdWJsaWMgcmVzZXRRdW90ZVN0YXRlKCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMub3BlblF1b3RlID0gdHJ1ZTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBHXHUwMEU4cmUgbGVzIFx1MDBFOXZcdTAwRTluZW1lbnRzIGNsYXZpZXIgcG91ciBhcHBsaXF1ZXIgbGVzIHJcdTAwRThnbGVzIHR5cG9ncmFwaGlxdWVzIGVuIHRlbXBzIHJcdTAwRTllbFxyXG4gICAgICogQHBhcmFtIGV2ZW50IFx1MDBDOXZcdTAwRTluZW1lbnQgY2xhdmllclxyXG4gICAgICogQHBhcmFtIGVkaXRvciBcdTAwQzlkaXRldXIgT2JzaWRpYW5cclxuICAgICAqIEByZXR1cm5zIHRydWUgc2kgbCdcdTAwRTl2XHUwMEU5bmVtZW50IGEgXHUwMEU5dFx1MDBFOSBnXHUwMEU5clx1MDBFOSwgZmFsc2Ugc2lub25cclxuICAgICAqL1xyXG4gICAgcHVibGljIGhhbmRsZUtleUV2ZW50KGV2ZW50OiBLZXlib2FyZEV2ZW50LCBlZGl0b3I6IEVkaXRvcik6IGJvb2xlYW4ge1xyXG4gICAgICAgIC8vIFZcdTAwRTlyaWZpZXIgc2kgbGUgY3Vyc2V1ciBlc3QgZGFucyB1biBibG9jIHNwXHUwMEU5Y2lhbCBvdSB1biBcdTAwRTlsXHUwMEU5bWVudCBcdTAwRTAgcHJcdTAwRTlzZXJ2ZXJcclxuICAgICAgICBpZiAoaXNJblNwZWNpYWxCbG9jayhlZGl0b3IpIHx8IGlzSW5QcmVzZXJ2ZWRNYXJrZG93bihlZGl0b3IpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IGN1cnNvciA9IGVkaXRvci5nZXRDdXJzb3IoKTtcclxuICAgICAgICBsZXQgaGFuZGxlZCA9IGZhbHNlO1xyXG5cclxuICAgICAgICAvLyBHXHUwMEU5cmVyIGwnYXBvc3Ryb3BoZSB0eXBvZ3JhcGhpcXVlXHJcbiAgICAgICAgaWYgKGV2ZW50LmtleSA9PT0gXCInXCIpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgY29uc3Qgc2VsZWN0aW9uID0gZWRpdG9yLmdldFNlbGVjdGlvbigpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgaWYgKHNlbGVjdGlvbi5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBlZGl0b3IucmVwbGFjZVNlbGVjdGlvbih0aGlzLnNldHRpbmdzLm9wZW5TaW5nbGVRdW90ZSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKHRoaXMuc2V0dGluZ3Mub3BlblNpbmdsZVF1b3RlLCBjdXJzb3IpO1xyXG4gICAgICAgICAgICAgICAgZWRpdG9yLnNldEN1cnNvcih7IGxpbmU6IGN1cnNvci5saW5lLCBjaDogY3Vyc29yLmNoICsgdGhpcy5zZXR0aW5ncy5vcGVuU2luZ2xlUXVvdGUubGVuZ3RoIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGhhbmRsZWQgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICAvLyBHXHUwMEU5cmVyIGxlcyBlc3BhY2VzIGluc1x1MDBFOWNhYmxlcyBhdmFudCBsYSBwb25jdHVhdGlvbiAoclx1MDBFOGdsZXMgZnJhblx1MDBFN2Fpc2VzKVxyXG4gICAgICAgIGVsc2UgaWYgKFsnIScsICc/JywgJzsnXS5pbmNsdWRlcyhldmVudC5rZXkpICYmIHRoaXMuc2V0dGluZ3MuZnJlbmNoUnVsZXNFbmFibGVkKSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGNoYXJCZWZvcmUgPSBlZGl0b3IuZ2V0UmFuZ2UoXHJcbiAgICAgICAgICAgICAgICB7IGxpbmU6IGN1cnNvci5saW5lLCBjaDogY3Vyc29yLmNoIC0gMSB9LFxyXG4gICAgICAgICAgICAgICAgY3Vyc29yXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBpZiAoY2hhckJlZm9yZSA9PT0gXCIgXCIpIHtcclxuICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UoXCJcXHUyMDJGXCIgKyBldmVudC5rZXksIFxyXG4gICAgICAgICAgICAgICAgICAgIHsgbGluZTogY3Vyc29yLmxpbmUsIGNoOiBjdXJzb3IuY2ggLSAxIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgY3Vyc29yXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZShldmVudC5rZXksIGN1cnNvcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWRpdG9yLnNldEN1cnNvcih7IGxpbmU6IGN1cnNvci5saW5lLCBjaDogY3Vyc29yLmNoICsgMSB9KTtcclxuICAgICAgICAgICAgaGFuZGxlZCA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIEdcdTAwRTlyZXIgbGVzIGVzcGFjZXMgaW5zXHUwMEU5Y2FibGVzIGF2YW50IGxlcyBkZXV4LXBvaW50cyAoclx1MDBFOGdsZXMgZnJhblx1MDBFN2Fpc2VzKVxyXG4gICAgICAgIGVsc2UgaWYgKGV2ZW50LmtleSA9PT0gJzonICYmIHRoaXMuc2V0dGluZ3MuZnJlbmNoUnVsZXNFbmFibGVkKSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGNoYXJCZWZvcmUgPSBlZGl0b3IuZ2V0UmFuZ2UoXHJcbiAgICAgICAgICAgICAgICB7IGxpbmU6IGN1cnNvci5saW5lLCBjaDogY3Vyc29yLmNoIC0gMSB9LFxyXG4gICAgICAgICAgICAgICAgY3Vyc29yXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBpZiAoY2hhckJlZm9yZSA9PT0gXCIgXCIpIHtcclxuICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UoXCJcXHUwMEEwXCIgKyBldmVudC5rZXksIFxyXG4gICAgICAgICAgICAgICAgICAgIHsgbGluZTogY3Vyc29yLmxpbmUsIGNoOiBjdXJzb3IuY2ggLSAxIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgY3Vyc29yXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZShldmVudC5rZXksIGN1cnNvcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWRpdG9yLnNldEN1cnNvcih7IGxpbmU6IGN1cnNvci5saW5lLCBjaDogY3Vyc29yLmNoICsgMSB9KTtcclxuICAgICAgICAgICAgaGFuZGxlZCA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIEdcdTAwRTlyZXIgbGVzIGd1aWxsZW1ldHMgcGVyc29ubmFsaXNhYmxlc1xyXG4gICAgICAgIGVsc2UgaWYgKGV2ZW50LmtleSA9PT0gJ1wiJykge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgaWYgKHRoaXMub3BlblF1b3RlKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBJbnNcdTAwRTlyZXIgbGUgZ3VpbGxlbWV0IG91dnJhbnRcclxuICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UodGhpcy5zZXR0aW5ncy5vcGVuRG91YmxlUXVvdGUsIGN1cnNvcik7XHJcbiAgICAgICAgICAgICAgICBlZGl0b3Iuc2V0Q3Vyc29yKHsgXHJcbiAgICAgICAgICAgICAgICAgICAgbGluZTogY3Vyc29yLmxpbmUsIFxyXG4gICAgICAgICAgICAgICAgICAgIGNoOiBjdXJzb3IuY2ggKyB0aGlzLnNldHRpbmdzLm9wZW5Eb3VibGVRdW90ZS5sZW5ndGggXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIEluc1x1MDBFOXJlciBsZSBndWlsbGVtZXQgZmVybWFudFxyXG4gICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZSh0aGlzLnNldHRpbmdzLmNsb3NlRG91YmxlUXVvdGUsIGN1cnNvcik7XHJcbiAgICAgICAgICAgICAgICBlZGl0b3Iuc2V0Q3Vyc29yKHsgXHJcbiAgICAgICAgICAgICAgICAgICAgbGluZTogY3Vyc29yLmxpbmUsIFxyXG4gICAgICAgICAgICAgICAgICAgIGNoOiBjdXJzb3IuY2ggKyB0aGlzLnNldHRpbmdzLmNsb3NlRG91YmxlUXVvdGUubGVuZ3RoIFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIEFsdGVybmVyIHBvdXIgbGUgcHJvY2hhaW4gZ3VpbGxlbWV0XHJcbiAgICAgICAgICAgIHRoaXMub3BlblF1b3RlID0gIXRoaXMub3BlblF1b3RlO1xyXG4gICAgICAgICAgICBoYW5kbGVkID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gR2VzdGlvbiBwb3VyIGxlcyBwb2ludHMgZGUgc3VzcGVuc2lvblxyXG4gICAgICAgIGVsc2UgaWYgKGV2ZW50LmtleSA9PT0gJy4nICYmIHRoaXMuc2V0dGluZ3MuZWxsaXBzaXNFbmFibGVkKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHRleHRCZWZvcmUgPSBlZGl0b3IuZ2V0UmFuZ2UoXHJcbiAgICAgICAgICAgICAgICB7IGxpbmU6IGN1cnNvci5saW5lLCBjaDogY3Vyc29yLmNoIC0gMiB9LCBcclxuICAgICAgICAgICAgICAgIGN1cnNvclxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgaWYgKHRleHRCZWZvcmUgPT09ICcuLicpIHtcclxuICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKCdcdTIwMjYnLCBcclxuICAgICAgICAgICAgICAgICAgICB7IGxpbmU6IGN1cnNvci5saW5lLCBjaDogY3Vyc29yLmNoIC0gMiB9LCBcclxuICAgICAgICAgICAgICAgICAgICBjdXJzb3JcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICBlZGl0b3Iuc2V0Q3Vyc29yKHsgbGluZTogY3Vyc29yLmxpbmUsIGNoOiBjdXJzb3IuY2ggLSAxIH0pO1xyXG4gICAgICAgICAgICAgICAgaGFuZGxlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gR2VzdGlvbiBwb3VyIGxlcyB0aXJldHNcclxuICAgICAgICBlbHNlIGlmIChldmVudC5rZXkgPT09ICctJyAmJiB0aGlzLnNldHRpbmdzLmRhc2hlc0VuYWJsZWQpIHtcclxuICAgICAgICAgICAgY29uc3QgdGV4dEJlZm9yZSA9IGVkaXRvci5nZXRSYW5nZShcclxuICAgICAgICAgICAgICAgIHsgbGluZTogY3Vyc29yLmxpbmUsIGNoOiBjdXJzb3IuY2ggLSAxIH0sIFxyXG4gICAgICAgICAgICAgICAgY3Vyc29yXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5za2lwRW5EYXNoKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBNb2RlIGRpcmVjdCAtLSB2ZXJzIGVtLWRhc2ggKFx1MjAxNClcclxuICAgICAgICAgICAgICAgIGlmICh0ZXh0QmVmb3JlID09PSAnLScpIHtcclxuICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UoJ1x1MjAxNCcsIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7IGxpbmU6IGN1cnNvci5saW5lLCBjaDogY3Vyc29yLmNoIC0gMSB9LCBcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3Vyc29yXHJcbiAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICBlZGl0b3Iuc2V0Q3Vyc29yKHsgbGluZTogY3Vyc29yLmxpbmUsIGNoOiBjdXJzb3IuY2ggfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyBNb2RlIHByb2dyZXNzaWY6IC0tIHZlcnMgZW4tZGFzaCwgcHVpcyBlbi1kYXNoLSB2ZXJzIGVtLWRhc2gsIHB1aXMgZW0tZGFzaC0gdmVycyAtLS1cclxuICAgICAgICAgICAgICAgIGlmICh0ZXh0QmVmb3JlID09PSAnLScpIHtcclxuICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UoJ1x1MjAxMycsIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7IGxpbmU6IGN1cnNvci5saW5lLCBjaDogY3Vyc29yLmNoIC0gMSB9LCBcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3Vyc29yXHJcbiAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICBlZGl0b3Iuc2V0Q3Vyc29yKHsgbGluZTogY3Vyc29yLmxpbmUsIGNoOiBjdXJzb3IuY2ggfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRleHRCZWZvcmUgPT09ICdcdTIwMTMnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKCdcdTIwMTQnLCBcclxuICAgICAgICAgICAgICAgICAgICAgICAgeyBsaW5lOiBjdXJzb3IubGluZSwgY2g6IGN1cnNvci5jaCAtIDEgfSwgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnNvclxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgZWRpdG9yLnNldEN1cnNvcih7IGxpbmU6IGN1cnNvci5saW5lLCBjaDogY3Vyc29yLmNoIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGhhbmRsZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0ZXh0QmVmb3JlID09PSAnXHUyMDE0Jykge1xyXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZSgnLS0tJywgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHsgbGluZTogY3Vyc29yLmxpbmUsIGNoOiBjdXJzb3IuY2ggLSAxIH0sIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJzb3JcclxuICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgIGVkaXRvci5zZXRDdXJzb3IoeyBsaW5lOiBjdXJzb3IubGluZSwgY2g6IGN1cnNvci5jaCArIDIgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gR2VzdGlvbiBwb3VyIGxlcyBndWlsbGVtZXRzIGZyYW5cdTAwRTdhaXMgdmlhIGNoZXZyb25zXHJcbiAgICAgICAgZWxzZSBpZiAoZXZlbnQua2V5ID09PSAnPicgJiYgdGhpcy5zZXR0aW5ncy5ndWlsbGVtZXRzRW5hYmxlZCkge1xyXG4gICAgICAgICAgICBjb25zdCB0ZXh0QmVmb3JlID0gZWRpdG9yLmdldFJhbmdlKFxyXG4gICAgICAgICAgICAgICAgeyBsaW5lOiBjdXJzb3IubGluZSwgY2g6IGN1cnNvci5jaCAtIDEgfSwgXHJcbiAgICAgICAgICAgICAgICBjdXJzb3JcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGlmICh0ZXh0QmVmb3JlID09PSAnPicpIHtcclxuICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKCdcXHUyMDJGXHUwMEJCJywgXHJcbiAgICAgICAgICAgICAgICAgICAgeyBsaW5lOiBjdXJzb3IubGluZSwgY2g6IGN1cnNvci5jaCAtIDEgfSwgXHJcbiAgICAgICAgICAgICAgICAgICAgY3Vyc29yXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgZWRpdG9yLnNldEN1cnNvcih7IGxpbmU6IGN1cnNvci5saW5lLCBjaDogY3Vyc29yLmNoIH0pO1xyXG4gICAgICAgICAgICAgICAgaGFuZGxlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LmtleSA9PT0gJzwnICYmIHRoaXMuc2V0dGluZ3MuZ3VpbGxlbWV0c0VuYWJsZWQpIHtcclxuICAgICAgICAgICAgY29uc3QgdGV4dEJlZm9yZSA9IGVkaXRvci5nZXRSYW5nZShcclxuICAgICAgICAgICAgICAgIHsgbGluZTogY3Vyc29yLmxpbmUsIGNoOiBjdXJzb3IuY2ggLSAxIH0sIFxyXG4gICAgICAgICAgICAgICAgY3Vyc29yXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBpZiAodGV4dEJlZm9yZSA9PT0gJzwnKSB7XHJcbiAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZSgnXHUwMEFCXFx1MjAyRicsIFxyXG4gICAgICAgICAgICAgICAgICAgIHsgbGluZTogY3Vyc29yLmxpbmUsIGNoOiBjdXJzb3IuY2ggLSAxIH0sIFxyXG4gICAgICAgICAgICAgICAgICAgIGN1cnNvclxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIGVkaXRvci5zZXRDdXJzb3IoeyBsaW5lOiBjdXJzb3IubGluZSwgY2g6IGN1cnNvci5jaCB9KTtcclxuICAgICAgICAgICAgICAgIGhhbmRsZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiBoYW5kbGVkO1xyXG4gICAgfVxyXG59IiwgIi8vIEZpY2hpZXIgdHlwb2dyYXBoeVJ1bGVzLnRzIHNpbXBsaWZpXHUwMEU5XHJcblxyXG5pbXBvcnQgeyBNaWNyb3R5cG9ncmFwaGllU2V0dGluZ3MgfSBmcm9tIFwiLi4vc2V0dGluZ3Mvc2V0dGluZ3NcIjtcclxuXHJcbi8qKlxyXG4gKiBJbnRlcmZhY2UgcG91ciB1bmUgclx1MDBFOGdsZSB0eXBvZ3JhcGhpcXVlXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIFR5cG9ncmFwaGljUnVsZSB7XHJcbiAgcmVnOiBSZWdFeHA7XHJcbiAgcmVwbDogc3RyaW5nO1xyXG59XHJcblxyXG4vKipcclxuICogU3RydWN0dXJlIHBvdXIgbCdlbnNlbWJsZSBkZXMgclx1MDBFOGdsZXMgY29tcGlsXHUwMEU5ZXNcclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgQ29tcGlsZWRSdWxlcyB7XHJcbiAgZnJlbmNoUnVsZXM6IFR5cG9ncmFwaGljUnVsZVtdOyAvLyBSXHUwMEU4Z2xlcyB0eXBvZ3JhcGhpcXVlcyBmcmFuXHUwMEU3YWlzZXNcclxuICBkYXNoUnVsZXM6IFR5cG9ncmFwaGljUnVsZVtdOyAvLyBSXHUwMEU4Z2xlcyBwb3VyIGxlcyB0aXJldHNcclxufVxyXG5cclxuLy8gRFx1MDBFOWZpbmlyIGxlcyByXHUwMEU4Z2xlcyB0eXBvZ3JhcGhpcXVlcyBmcmFuXHUwMEU3YWlzZXNcclxuY29uc3QgRlJFTkNIX1JVTEVTOiBUeXBvZ3JhcGhpY1J1bGVbXSA9IFtcclxuICAvLyBSXHUwMEU4Z2xlcyBvcnRob2dyYXBoaXF1ZXNcclxuICB7IHJlZzogLyhYfEl8VilcdTAwRThtZS9nLCByZXBsOiBcIiQxZVwiIH0sXHJcbiAgeyByZWc6IC8oWHxJfFYpZW1lL2csIHJlcGw6IFwiJDFlXCIgfSxcclxuICB7IHJlZzogLyhYfEl8VilcdTAwRTltZS9nLCByZXBsOiBcIiQxZVwiIH0sXHJcbiAgeyByZWc6IC9vZS9nLCByZXBsOiBcIlx1MDE1M1wiIH0sXHJcbiAgeyByZWc6IC9PRS9nLCByZXBsOiBcIlx1MDE1MlwiIH0sXHJcbiAgeyByZWc6IC9PZS9nLCByZXBsOiBcIlx1MDE1MlwiIH0sXHJcbiAgeyByZWc6IC9hZS9nLCByZXBsOiBcIlx1MDBFNlwiIH0sXHJcbiAgeyByZWc6IC9BRS9nLCByZXBsOiBcIlx1MDBDNlwiIH0sXHJcbiAgeyByZWc6IC9BZS9nLCByZXBsOiBcIlx1MDBDNlwiIH0sXHJcblxyXG4gICAgLy8gZGVsZXRlIGFsbCBzcGFjZXMgYWZ0ZXIgXHUwMEFCXHUyMDM5XHUyMDFDWyhcclxuICB7IHJlZzogLyhbXHUwMEFCXHUyMDM5XCJcXFsoXSlcXHMrL2csIHJlcGw6IFwiJDFcIiB9LFxyXG5cclxuICAvLyByZWFsIGFwb3N0cm9waGVcclxuICB7IHJlZzogL1xcJy9nLCByZXBsOiBcIlx1MjAxOVwiIH0sXHJcbiAgLy8gcmVhbCBzdXNwZW5zaW9uIHBvaW50c1xyXG4gIHsgcmVnOiAvXFwuezMsfS9nLCByZXBsOiBcIlxcdTIwMjZcIiB9LFxyXG4gIC8vIGRlbGV0ZSBhbGwgc3BhY2VzIGFmdGVyIFx1MDBBQlx1MjAzOVx1MjAxQ1soXHJcbiAgeyByZWc6IC8oW1x1MDBBQlx1MjAzOVwiXFxbKF0pXFxzKy9nLCByZXBsOiBcIiQxXCIgfSxcclxuICAvLyBkZWxldGUgYWxsIHNwYWNlcyBiZWZvcmUgcHVuY3R1YXRpb24gIT87Olx1MDBCQlx1MjAzQVx1MjAxRCldLixcclxuICB7IHJlZzogL1xccysoWyE/OzpcdTAwQkJcdTIwM0FcIilcXF1cXC5cXCxdKS9nLCByZXBsOiBcIiQxXCIgfSxcclxuICAvLyBhZGQgbmFycm93IG5vIGJyZWFrIHNwYWNlIGJlZm9yZSAhPztcdTAwQkJcdTIwM0FcclxuICB7IHJlZzogLyhbIT87XHUwMEJCXHUyMDNBXSkvZywgcmVwbDogXCJcXHUyMDJGJDFcIiB9LFxyXG4gIC8vIGFkZCBubyBicmVhayBzcGFjZSBiZWZvcmUgOiAoY29ycmVjdGx5IGhhbmRsaW5nIGV4aXN0aW5nIHNwYWNlcywgYnV0IGF2b2lkaW5nIFVSTHMpXHJcbiAgeyByZWc6IC9cXHMrKDopKD8hXFwvXFwvKS9nLCByZXBsOiBcIlxcdTAwQTAkMVwiIH0sXHJcbiAgeyByZWc6IC8oW15cXHM6XFwvXSkoOikoPyFcXC9cXC8pL2csIHJlcGw6IFwiJDFcXHUwMEEwJDJcIiB9LFxyXG5cclxuICAvLyBhZGQgbmFycm93IG5vIGJyZWFrIHNwYWNlIGFmdGVyIFx1MDBBQlx1MjAzOVxyXG4gIHsgcmVnOiAvKFtcdTAwQUJcdTIwMzldKS9nLCByZXBsOiBcIiQxXFx1MjAyRlwiIH0sXHJcbiAgLy8gbm8gYnJlYWsgc3BhY2UgYWZ0ZXIgb25lIGxldHRlciB3b3Jkc1xyXG4gIHsgcmVnOiAvXFxzKyhbYS16XHUwMEUwXSlcXHMrL2dpLCByZXBsOiBcIiAkMVxcdTAwQTBcIiB9LFxyXG4gIC8vIG5vIGJyZWFrIHNwYWNlIGludG8gbmFtZXNcclxuICB7XHJcbiAgICByZWc6IC8oW0EtWlx1MDBDMC1cdTAwRDZcdTAwRDhcdTAxNTJdKShbQS1aYS16XHUwMEMwLVx1MDBENlx1MDBEOC1cdTAwRjZcdTAwRjgtXHUwMEZGXHUwMTUzXHUwMTUyXSspXFxzKyhbQS1aXHUwMEMwLVx1MDBENlx1MDBEOFx1MDE1Ml0pKFtBLVphLXpcdTAwQzAtXHUwMEQ2XHUwMEQ4LVx1MDBGNlx1MDBGOC1cdTAwRkZcdTAxNTNcdTAxNTJdKykvZyxcclxuICAgIHJlcGw6IFwiJDEkMlxcdTAwQTAkMyQ0XCIsXHJcbiAgfSxcclxuICAvLyBubyBicmVhayBzcGFjZSBhZnRlciBhYmJyZXZpYXRpb24gd2l0aCBwZXJpb2RcclxuICB7XHJcbiAgICByZWc6IC8oW0EtWlx1MDBDMC1cdTAwRDZcdTAwRDhcdTAxNTJdXFwuKVxccysoW0EtWlx1MDBDMC1cdTAwRDZcdTAwRDhcdTAxNTJdW0EtWmEtelx1MDBDMC1cdTAwRDZcdTAwRDgtXHUwMEY2XHUwMEY4LVx1MDBGRlx1MDE1M1x1MDE1Ml0rKS9nLFxyXG4gICAgcmVwbDogXCIkMVxcdTAwQTAkMlwiLFxyXG4gIH0sXHJcbiAgLy8gbm8gYnJlYWsgc3BhY2UgYmVmb3JlICdzaVx1MDBFOGNsZXMnXHJcbiAgeyByZWc6IC8oWHxJfFYpKGVyfGUpXFxzK3NpXHUwMEU4Y2xlL2csIHJlcGw6IFwiJDEkMlxcdTAwQTBzaVx1MDBFOGNsZVwiIH0sXHJcbiAgLy8gYWRkIHN1YlxyXG4gIHsgcmVnOiAvKFh8SXxWKShlcnxlKS9nLCByZXBsOiBcIiQxPHN1cD4kMjwvc3VwPlwiIH0sXHJcbiAgLy8gVHJhbnNmb3JtZXIgbGVzIGd1aWxsZW1ldHMgc2ltcGxlcyBcdTAwRTAgbCdpbnRcdTAwRTlyaWV1ciBkZSBndWlsbGVtZXRzIGRvdWJsZXMgZW4gZ3VpbGxlbWV0cyBhbmdsYWlzXHJcbiAgeyByZWc6IC8oXHUwMEFCXFx1MjAyRlteXHUwMEJCXSopJyhbXlx1MjAxOV0qKScoW15cdTAwQkJdKlxcdTIwMkZcdTAwQkIpL2csIHJlcGw6ICckMVwiJDJcIiQzJyB9LFxyXG4gIC8vIGFqb3V0ZXIgZXNwYWNlIGFwclx1MDBFOHMgZ3VpbGxlbWV0IGZlcm1hbnQgc3VpdmkgZCd1biBtb3RcclxuICB7IHJlZzogLyhcdTAwQkIpKFtBLVphLXpcdTAwQzAtXHUwMEQ2XHUwMEQ4LVx1MDBGNlx1MDBGOC1cdTAwRkZcdTAxNTNcdTAxNTIwLTldKS9nLCByZXBsOiBcIiQxICQyXCIgfSxcclxuICAvLyBUcmFuc2Zvcm1lciBsZXMgZ3VpbGxlbWV0cyBzaW1wbGVzIFx1MDBFMCBsJ2ludFx1MDBFOXJpZXVyIGRlIGd1aWxsZW1ldHMgZG91YmxlcyBlbiBndWlsbGVtZXRzIGFuZ2xhaXNcclxuICB7IHJlZzogLyhcdTAwQUJcXHUyMDJGW15cdTAwQkJdKilcdTAwQUJcXHUyMDJGKFteXHUwMEJCXSopXFx1MjAyRlx1MDBCQihbXlx1MDBCQl0qXFx1MjAyRlx1MDBCQikvZywgcmVwbDogJyQxXFxcdTIwMUMkMlxcXHUyMDFEJDMnICB9LFxyXG5dO1xyXG5cclxuLy8gUlx1MDBFOGdsZXMgZGUgYmFzZSBwb3VyIGxlcyBlc3BhY2VzIChub24gc3BcdTAwRTljaWZpcXVlcyBhdSBmcmFuXHUwMEU3YWlzKVxyXG5jb25zdCBCQVNFX1JVTEVTOiBUeXBvZ3JhcGhpY1J1bGVbXSA9IFtcclxuXHJcbl07XHJcblxyXG4vKipcclxuICogQ29tcGlsZSBsJ2Vuc2VtYmxlIGRlcyByXHUwMEU4Z2xlcyB0eXBvZ3JhcGhpcXVlcyBlbiBmb25jdGlvbiBkZXMgcGFyYW1cdTAwRTh0cmVzXHJcbiAqIEBwYXJhbSBzZXR0aW5ncyBQYXJhbVx1MDBFOHRyZXMgZHUgcGx1Z2luXHJcbiAqIEByZXR1cm5zIEVuc2VtYmxlIGRlcyByXHUwMEU4Z2xlcyBjb21waWxcdTAwRTllc1xyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGNvbXBpbGVSdWxlcyhcclxuICBzZXR0aW5nczogTWljcm90eXBvZ3JhcGhpZVNldHRpbmdzXHJcbik6IENvbXBpbGVkUnVsZXMge1xyXG4gIC8vIEluaXRpYWxpc2VyIGxlIHRhYmxlYXUgZGUgclx1MDBFOGdsZXNcclxuICBsZXQgZnJlbmNoUnVsZXM6IFR5cG9ncmFwaGljUnVsZVtdID0gW107XHJcblxyXG4gIC8vIFJcdTAwRThnbGVzIHBvdXIgbGVzIGd1aWxsZW1ldHMgcGVyc29ubmFsaXNhYmxlcyBldCBhcG9zdHJvcGhlcyAodG91am91cnMgYWN0aXZlcylcclxuICBmcmVuY2hSdWxlcy5wdXNoKFxyXG4gICAge1xyXG4gICAgICByZWc6IG5ldyBSZWdFeHAoYFwiKFtBLVphLXpcdTAwQzAtXHUwMEQ2XHUwMEQ4LVx1MDBGNlx1MDBGOC1cdTAwRkZcdTAxNTNcdTAxNTJdKWAsIFwiZ1wiKSxcclxuICAgICAgcmVwbDogc2V0dGluZ3Mub3BlbkRvdWJsZVF1b3RlICsgXCIkMVwiLFxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgcmVnOiBuZXcgUmVnRXhwKGAoW0EtWmEtelx1MDBDMC1cdTAwRDZcdTAwRDgtXHUwMEY2XHUwMEY4LVx1MDBGRlx1MDE1M1x1MDE1Ml1bIT87Oi4sXT8pXFxcImAsIFwiZ1wiKSxcclxuICAgICAgcmVwbDogXCIkMVwiICsgc2V0dGluZ3MuY2xvc2VEb3VibGVRdW90ZSxcclxuICAgIH0sXHJcbiAgICAvLyBBcG9zdHJvcGhlIHR5cG9ncmFwaGlxdWUgcGVyc29ubmFsaXNhYmxlXHJcbiAgICB7IHJlZzogL1xcJy9nLCByZXBsOiBzZXR0aW5ncy5vcGVuU2luZ2xlUXVvdGUgfVxyXG4gICk7XHJcblxyXG4gIC8vIFRyYWl0ZW1lbnQgZGVzIHBvaW50cyBkZSBzdXNwZW5zaW9uIHNpIGFjdGl2XHUwMEU5XHJcbiAgaWYgKHNldHRpbmdzLmVsbGlwc2lzRW5hYmxlZCkge1xyXG4gICAgZnJlbmNoUnVsZXMucHVzaCh7IHJlZzogL1xcLnszLH0vZywgcmVwbDogXCJcXHUyMDI2XCIgfSk7XHJcbiAgfVxyXG5cclxuICAvLyBSXHUwMEU4Z2xlcyBwb3VyIGxlcyBndWlsbGVtZXRzIHZpYSBjaGV2cm9ucyBzaSBhY3Rpdlx1MDBFOXNcclxuICBpZiAoc2V0dGluZ3MuZ3VpbGxlbWV0c0VuYWJsZWQpIHtcclxuICAgIGZyZW5jaFJ1bGVzLnB1c2goeyByZWc6IC88PC9nLCByZXBsOiBcIlx1MDBBQlxcdTIwMkZcIiB9LCB7IHJlZzogLz4+L2csIHJlcGw6IFwiXFx1MjAyRlx1MDBCQlwiIH0pO1xyXG4gIH1cclxuXHJcbiAgLy8gQWpvdXRlciBsZXMgclx1MDBFOGdsZXMgZnJhblx1MDBFN2Fpc2VzIHNpIGFjdGl2XHUwMEU5ZXNcclxuICBpZiAoc2V0dGluZ3MuZnJlbmNoUnVsZXNFbmFibGVkKSB7XHJcbiAgICBmcmVuY2hSdWxlcyA9IFsuLi5mcmVuY2hSdWxlcywgLi4uRlJFTkNIX1JVTEVTXTtcclxuICAgIFxyXG4gICAgLy8gQWpvdXRlciBsYSByXHUwMEU4Z2xlIHBvdXIgbGVzIGd1aWxsZW1ldHMgYW5nbGFpcyBkYW5zIGxlcyBndWlsbGVtZXRzIGZyYW5cdTAwRTdhaXNcclxuICAgIGZyZW5jaFJ1bGVzLnB1c2goeyBcclxuICAgICAgcmVnOiAvKFx1MDBBQlxcdTIwMkZbXlx1MDBCQl0qKVx1MDBBQlxcdTIwMkYoW15cdTAwQkJdKilcXHUyMDJGXHUwMEJCKFteXHUwMEJCXSpcXHUyMDJGXHUwMEJCKS9nLCBcclxuICAgICAgcmVwbDogJyQxXFxcdTIwMUMkMlxcXHUyMDFEJDMnICBcclxuICAgIH0pO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBmcmVuY2hSdWxlcyA9IFsuLi5mcmVuY2hSdWxlcywgLi4uQkFTRV9SVUxFU107XHJcbiAgfVxyXG5cclxuICAvLyBDclx1MDBFOWVyIGxlcyByXHUwMEU4Z2xlcyBwb3VyIGxlcyB0aXJldHMgZW4gZm9uY3Rpb24gZGVzIHBhcmFtXHUwMEU4dHJlc1xyXG4gIGNvbnN0IGRhc2hSdWxlczogVHlwb2dyYXBoaWNSdWxlW10gPSBbXTtcclxuXHJcbiAgaWYgKHNldHRpbmdzLmRhc2hlc0VuYWJsZWQpIHtcclxuICAgIGlmIChzZXR0aW5ncy5za2lwRW5EYXNoKSB7XHJcbiAgICAgIC8vIE1vZGUgZGlyZWN0OiAtLSBkZXZpZW50IGRpcmVjdGVtZW50IFx1MjAxNFxyXG4gICAgICBkYXNoUnVsZXMucHVzaCh7IHJlZzogLy0tL2csIHJlcGw6IFwiXHUyMDE0XCIgfSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAvLyBNb2RlIHByb2dyZXNzaWZcclxuICAgICAgZGFzaFJ1bGVzLnB1c2goXHJcbiAgICAgICAgeyByZWc6IC8tLS9nLCByZXBsOiBcIlx1MjAxM1wiIH0sIC8vIC0tIGRldmllbnQgXHUyMDEzXHJcbiAgICAgICAgeyByZWc6IC9cdTIwMTMtL2csIHJlcGw6IFwiXHUyMDE0XCIgfSwgLy8gXHUyMDEzLSBkZXZpZW50IFx1MjAxNFxyXG4gICAgICAgIHsgcmVnOiAvXHUyMDE0LS9nLCByZXBsOiBcIi0tLVwiIH0gLy8gXHUyMDE0LSBkZXZpZW50IC0tLVxyXG4gICAgICApO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHsgZnJlbmNoUnVsZXMsIGRhc2hSdWxlcyB9O1xyXG59XHJcblxyXG4vKipcclxuICogQXBwbGlxdWUgdW5lIHNcdTAwRTlyaWUgZGUgclx1MDBFOGdsZXMgdHlwb2dyYXBoaXF1ZXMgXHUwMEUwIHVuIHRleHRlXHJcbiAqIEBwYXJhbSB0ZXh0IFRleHRlIGQnZW50clx1MDBFOWVcclxuICogQHBhcmFtIHJ1bGVzIFJcdTAwRThnbGVzIFx1MDBFMCBhcHBsaXF1ZXJcclxuICogQHJldHVybnMgVGV4dGUgdHJhbnNmb3JtXHUwMEU5XHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gYXBwbHlSdWxlcyh0ZXh0OiBzdHJpbmcsIHJ1bGVzOiBUeXBvZ3JhcGhpY1J1bGVbXSk6IHN0cmluZyB7XHJcbiAgbGV0IHJlc3VsdCA9IHRleHQ7XHJcbiAgZm9yIChjb25zdCBydWxlIG9mIHJ1bGVzKSB7XHJcbiAgICByZXN1bHQgPSByZXN1bHQucmVwbGFjZShydWxlLnJlZywgcnVsZS5yZXBsKTtcclxuICB9XHJcbiAgcmV0dXJuIHJlc3VsdDtcclxufVxyXG4iLCAiLy8gUHJvY2Vzc2V1ciBkZSB0ZXh0ZSBtaXMgXHUwMEUwIGpvdXIgcG91ciBsYSBub3V2ZWxsZSBzdHJ1Y3R1cmVcclxuXHJcbmltcG9ydCB7IENvbXBpbGVkUnVsZXMsIGFwcGx5UnVsZXMgfSBmcm9tICcuL3R5cG9ncmFwaHlSdWxlcyc7XHJcblxyXG4vKipcclxuICogQXBwbGlxdWUgdG91dGVzIGxlcyBjYXRcdTAwRTlnb3JpZXMgZGUgclx1MDBFOGdsZXMgXHUwMEUwIHVuIHRleHRlXHJcbiAqIEBwYXJhbSB0ZXh0IFRleHRlIGQnZW50clx1MDBFOWVcclxuICogQHBhcmFtIHJ1bGVzIEVuc2VtYmxlIGRlcyByXHUwMEU4Z2xlcyBjb21waWxcdTAwRTllc1xyXG4gKiBAcmV0dXJucyBUZXh0ZSB0cmFuc2Zvcm1cdTAwRTlcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBhcHBseUFsbFJ1bGVzKHRleHQ6IHN0cmluZywgcnVsZXM6IENvbXBpbGVkUnVsZXMpOiBzdHJpbmcge1xyXG4gICAgbGV0IHJlc3VsdCA9IHRleHQ7XHJcbiAgICBcclxuICAgIC8vIFRhYmxlYXUgcG91ciBzdG9ja2VyIGxlcyBcdTAwRTlsXHUwMEU5bWVudHMgXHUwMEUwIHByXHUwMEU5c2VydmVyXHJcbiAgICBjb25zdCBwcmVzZXJ2ZWRFbGVtZW50czogc3RyaW5nW10gPSBbXTtcclxuICAgIFxyXG4gICAgLy8gTGlzdGUgZGVzIHBhdHRlcm5zIFx1MDBFMCBwclx1MDBFOXNlcnZlclxyXG4gICAgY29uc3QgcGF0dGVybnMgPSBbXHJcbiAgICAgICAgL1xcW1xcWy4qP1xcXVxcXS9nLCAgICAgICAgICAgLy8gTGllbnMgT2JzaWRpYW4gW1tsaWVuXV1cclxuICAgICAgICAvXFxbLio/XFxdXFwoLio/XFwpL2csICAgICAgICAvLyBMaWVucyBNYXJrZG93biBbdGV4dGVdKHVybClcclxuICAgICAgICAvIVxcWy4qP1xcXVxcKC4qP1xcKS9nLCAgICAgICAvLyBJbWFnZXMgIVthbHRdKHVybClcclxuICAgICAgICAvYFteYF0rYC9nLCAgICAgICAgICAgICAgIC8vIENvZGUgaW5saW5lIGBjb2RlYFxyXG4gICAgICAgIC9gYGBbXFxzXFxTXSo/YGBgL2csICAgICAgICAvLyBCbG9jcyBkZSBjb2RlXHJcbiAgICAgICAgLz5cXHMuKiQvZ20sICAgICAgICAgICAgICAgLy8gQ2FsbG91dHMgKGxpZ25lcyBjb21tZW5cdTAwRTdhbnQgcGFyIFwiPiBcIilcclxuICAgICAgICAvPFtePl0qPi9nLCAgICAgICAgICAgICAgIC8vIEJhbGlzZXMgSFRNTFxyXG4gICAgICAgIC9cXCRcXCRbXiRdKlxcJFxcJC9nLCAgICAgICAgIC8vIFx1MDBDOXF1YXRpb25zIG1hdGhcdTAwRTltYXRpcXVlcyAkJGVxdWF0aW9uJCRcclxuICAgICAgICAvXFwkW14kXSpcXCQvZywgICAgICAgICAgICAgLy8gXHUwMEM5cXVhdGlvbnMgbWF0aFx1MDBFOW1hdGlxdWVzIGlubGluZSAkZXF1YXRpb24kXHJcbiAgICAgICAgL1xce1tefV0qXFx9L2csICAgICAgICAgICAgIC8vIENvbnRlbnUgZW50cmUgYWNjb2xhZGVzIHtjb250ZW51fVxyXG4gICAgICAgIC9odHRwcz86XFwvXFwvW15cXHNdKy9nLCAgICAgLy8gVVJMcyBhdmVjIGh0dHA6IG91IGh0dHBzOlxyXG4gICAgICAgIC9bYS16XSs6XFwvXFwvW15cXHNdKy9nLCAgICAgLy8gQXV0cmVzIHByb3RvY29sZXMgKGZ0cDosIGZpbGU6LCBldGMuKVxyXG4gICAgICAgIC9bYS16QS1aMC05Xy4rLV0rQFthLXpBLVowLTktXStcXC5bYS16QS1aMC05LS5dKy9nLCAvLyBBZHJlc3NlcyBlbWFpbFxyXG4gICAgXTtcclxuICAgIFxyXG4gICAgLy8gRXh0cmFpcmUgZXQgcmVtcGxhY2VyIGxlcyBcdTAwRTlsXHUwMEU5bWVudHMgXHUwMEUwIHByXHUwMEU5c2VydmVyXHJcbiAgICBsZXQgdGVtcFRleHQgPSByZXN1bHQ7XHJcbiAgICBsZXQgZWxlbWVudEluZGV4ID0gMDtcclxuICAgIFxyXG4gICAgLy8gUG91ciBjaGFxdWUgcGF0dGVyblxyXG4gICAgZm9yIChjb25zdCBwYXR0ZXJuIG9mIHBhdHRlcm5zKSB7XHJcbiAgICAgICAgbGV0IG1hdGNoO1xyXG4gICAgICAgIC8vIFV0aWxpc2VyIHVuZSBjaGFcdTAwRUVuZSB0ZW1wb3JhaXJlIHBvdXIgXHUwMEU5dml0ZXIgbGVzIHByb2JsXHUwMEU4bWVzIGRlIHJlbXBsYWNlbWVudFxyXG4gICAgICAgIGxldCBzZWFyY2hUZXh0ID0gdGVtcFRleHQ7XHJcbiAgICAgICAgbGV0IHJlcGxhY2VkVGV4dCA9IHRlbXBUZXh0O1xyXG4gICAgICAgIFxyXG4gICAgICAgIHdoaWxlICgobWF0Y2ggPSBwYXR0ZXJuLmV4ZWMoc2VhcmNoVGV4dCkpICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBsYWNlaG9sZGVyID0gYF9fUFJFU0VSVkVEX0VMRU1FTlRfJHtlbGVtZW50SW5kZXh9X19gO1xyXG4gICAgICAgICAgICBwcmVzZXJ2ZWRFbGVtZW50cy5wdXNoKG1hdGNoWzBdKTtcclxuICAgICAgICAgICAgLy8gUmVtcGxhY2VyIHVuaXF1ZW1lbnQgbGEgcHJlbWlcdTAwRThyZSBvY2N1cnJlbmNlXHJcbiAgICAgICAgICAgIHJlcGxhY2VkVGV4dCA9IHJlcGxhY2VkVGV4dC5yZXBsYWNlKG1hdGNoWzBdLCBwbGFjZWhvbGRlcik7XHJcbiAgICAgICAgICAgIGVsZW1lbnRJbmRleCsrO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICB0ZW1wVGV4dCA9IHJlcGxhY2VkVGV4dDtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gQXBwbGlxdWVyIGxlcyByXHUwMEU4Z2xlcyB0eXBvZ3JhcGhpcXVlcyBmcmFuXHUwMEU3YWlzZXNcclxuICAgIHRlbXBUZXh0ID0gYXBwbHlSdWxlcyh0ZW1wVGV4dCwgcnVsZXMuZnJlbmNoUnVsZXMpO1xyXG4gICAgXHJcbiAgICAvLyBBcHBsaXF1ZXIgbGVzIHJcdTAwRThnbGVzIGRlIHRpcmV0c1xyXG4gICAgdGVtcFRleHQgPSBhcHBseVJ1bGVzKHRlbXBUZXh0LCBydWxlcy5kYXNoUnVsZXMpO1xyXG4gICAgXHJcbiAgICAvLyBSXHUwMEU5aW50XHUwMEU5Z3JlciBsZXMgXHUwMEU5bFx1MDBFOW1lbnRzIHByXHUwMEU5c2Vydlx1MDBFOXNcclxuICAgIHJlc3VsdCA9IHRlbXBUZXh0O1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwcmVzZXJ2ZWRFbGVtZW50cy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGNvbnN0IHBsYWNlaG9sZGVyID0gYF9fUFJFU0VSVkVEX0VMRU1FTlRfJHtpfV9fYDtcclxuICAgICAgICByZXN1bHQgPSByZXN1bHQucmVwbGFjZShwbGFjZWhvbGRlciwgcHJlc2VydmVkRWxlbWVudHNbaV0pO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59XHJcblxyXG4vKipcclxuICogVHJhaXRlIHVuIHRleHRlIGVuIHJlc3BlY3RhbnQgbGVzIGJsb2NzIHNwXHUwMEU5Y2lhdXggKGNvZGUsIGZyb250bWF0dGVyKVxyXG4gKiBAcGFyYW0gdGV4dCBUZXh0ZSBcdTAwRTAgdHJhaXRlclxyXG4gKiBAcGFyYW0gYmxvY2tzIFR5cGVzIGRlIGJsb2NzIHBvdXIgY2hhcXVlIGxpZ25lXHJcbiAqIEBwYXJhbSBydWxlcyBSXHUwMEU4Z2xlcyBjb21waWxcdTAwRTllc1xyXG4gKiBAcmV0dXJucyBUZXh0ZSB0cmFuc2Zvcm1cdTAwRTlcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBwcm9jZXNzVGV4dFdpdGhCbG9ja3ModGV4dDogc3RyaW5nLCBibG9ja3M6IHN0cmluZ1tdLCBydWxlczogQ29tcGlsZWRSdWxlcyk6IHN0cmluZyB7XHJcbiAgICBjb25zdCBsaW5lcyA9IHRleHQuc3BsaXQoJ1xcbicpO1xyXG4gICAgY29uc3QgcHJvY2Vzc2VkTGluZXMgPSBbXTtcclxuICAgIFxyXG4gICAgLy8gUmVncm91cGVyIGxlcyBsaWduZXMgbm9ybWFsZXMgY29uc1x1MDBFOWN1dGl2ZXMgcG91ciB1biB0cmFpdGVtZW50IHBsdXMgZWZmaWNhY2VcclxuICAgIGxldCBub3JtYWxUZXh0QnVmZmVyID0gW107XHJcbiAgICBsZXQgbGFzdEJsb2NrVHlwZSA9ICcnO1xyXG4gICAgXHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxpbmVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgY29uc3QgY3VycmVudEJsb2NrVHlwZSA9IGJsb2Nrc1tpXTtcclxuICAgICAgICBjb25zdCBsaW5lID0gbGluZXNbaV07XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKGN1cnJlbnRCbG9ja1R5cGUgPT09ICdub3JtYWwnKSB7XHJcbiAgICAgICAgICAgIC8vIEFqb3V0ZXIgYXUgYnVmZmVyIHBvdXIgdHJhaXRlbWVudCBncm91cFx1MDBFOVxyXG4gICAgICAgICAgICBub3JtYWxUZXh0QnVmZmVyLnB1c2gobGluZSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gVHJhaXRlciBsZSBidWZmZXIgYWNjdW11bFx1MDBFOSBzaSBuXHUwMEU5Y2Vzc2FpcmVcclxuICAgICAgICAgICAgaWYgKG5vcm1hbFRleHRCdWZmZXIubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcHJvY2Vzc2VkQnVmZmVyID0gYXBwbHlBbGxSdWxlcyhub3JtYWxUZXh0QnVmZmVyLmpvaW4oJ1xcbicpLCBydWxlcyk7XHJcbiAgICAgICAgICAgICAgICBwcm9jZXNzZWRMaW5lcy5wdXNoKC4uLnByb2Nlc3NlZEJ1ZmZlci5zcGxpdCgnXFxuJykpO1xyXG4gICAgICAgICAgICAgICAgbm9ybWFsVGV4dEJ1ZmZlciA9IFtdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBBam91dGVyIGxhIGxpZ25lIHNwXHUwMEU5Y2lhbGUgc2FucyBtb2RpZmljYXRpb25cclxuICAgICAgICAgICAgcHJvY2Vzc2VkTGluZXMucHVzaChsaW5lKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgbGFzdEJsb2NrVHlwZSA9IGN1cnJlbnRCbG9ja1R5cGU7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIFRyYWl0ZXIgdG91dCB0ZXh0ZSBub3JtYWwgcmVzdGFudCBkYW5zIGxlIGJ1ZmZlclxyXG4gICAgaWYgKG5vcm1hbFRleHRCdWZmZXIubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIGNvbnN0IHByb2Nlc3NlZEJ1ZmZlciA9IGFwcGx5QWxsUnVsZXMobm9ybWFsVGV4dEJ1ZmZlci5qb2luKCdcXG4nKSwgcnVsZXMpO1xyXG4gICAgICAgIHByb2Nlc3NlZExpbmVzLnB1c2goLi4ucHJvY2Vzc2VkQnVmZmVyLnNwbGl0KCdcXG4nKSk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJldHVybiBwcm9jZXNzZWRMaW5lcy5qb2luKCdcXG4nKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFZlcnNpb24gb3B0aW1pc1x1MDBFOWUgcG91ciBsZSB0cmFpdGVtZW50IGFzeW5jaHJvbmUgZGUgZ3JhbmRzIGRvY3VtZW50c1xyXG4gKiBAcGFyYW0gdGV4dCBUZXh0ZSBcdTAwRTAgdHJhaXRlclxyXG4gKiBAcGFyYW0gYmxvY2tzIFR5cGVzIGRlIGJsb2NzIHBvdXIgY2hhcXVlIGxpZ25lXHJcbiAqIEBwYXJhbSBydWxlcyBSXHUwMEU4Z2xlcyBjb21waWxcdTAwRTllc1xyXG4gKiBAcGFyYW0gY2FsbGJhY2sgRm9uY3Rpb24gZGUgY2FsbGJhY2sgYXBwZWxcdTAwRTllIGF2ZWMgbGUgclx1MDBFOXN1bHRhdFxyXG4gKiBAcGFyYW0gYmF0Y2hTaXplIFRhaWxsZSBkZXMgbG90cyBkZSBsaWduZXMgXHUwMEUwIHRyYWl0ZXJcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBwcm9jZXNzTGFyZ2VEb2N1bWVudChcclxuICAgIHRleHQ6IHN0cmluZywgXHJcbiAgICBibG9ja3M6IHN0cmluZ1tdLCBcclxuICAgIHJ1bGVzOiBDb21waWxlZFJ1bGVzLFxyXG4gICAgY2FsbGJhY2s6IChyZXN1bHQ6IHN0cmluZykgPT4gdm9pZCxcclxuICAgIGJhdGNoU2l6ZTogbnVtYmVyID0gNTAwXHJcbik6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgY29uc3QgbGluZXMgPSB0ZXh0LnNwbGl0KCdcXG4nKTtcclxuICAgIGNvbnN0IHByb2Nlc3NlZExpbmVzOiBzdHJpbmdbXSA9IFtdO1xyXG4gICAgXHJcbiAgICAvLyBUcmFpdGVyIHBhciBsb3RzIHBvdXIgXHUwMEU5dml0ZXIgZGUgYmxvcXVlciBsJ2ludGVyZmFjZVxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBNYXRoLmNlaWwobGluZXMubGVuZ3RoIC8gYmF0Y2hTaXplKTsgaSsrKSB7XHJcbiAgICAgICAgY29uc3Qgc3RhcnRJZHggPSBpICogYmF0Y2hTaXplO1xyXG4gICAgICAgIGNvbnN0IGVuZElkeCA9IE1hdGgubWluKChpICsgMSkgKiBiYXRjaFNpemUsIGxpbmVzLmxlbmd0aCk7XHJcbiAgICAgICAgY29uc3QgYmF0Y2hMaW5lcyA9IGxpbmVzLnNsaWNlKHN0YXJ0SWR4LCBlbmRJZHgpO1xyXG4gICAgICAgIGNvbnN0IGJhdGNoQmxvY2tzID0gYmxvY2tzLnNsaWNlKHN0YXJ0SWR4LCBlbmRJZHgpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFRyYWl0ZXIgY2UgbG90IGRlIGxpZ25lc1xyXG4gICAgICAgIGNvbnN0IGJhdGNoVGV4dCA9IGJhdGNoTGluZXMuam9pbignXFxuJyk7XHJcbiAgICAgICAgY29uc3QgcHJvY2Vzc2VkQmF0Y2ggPSBwcm9jZXNzVGV4dFdpdGhCbG9ja3MoYmF0Y2hUZXh0LCBiYXRjaEJsb2NrcywgcnVsZXMpO1xyXG4gICAgICAgIHByb2Nlc3NlZExpbmVzLnB1c2goLi4ucHJvY2Vzc2VkQmF0Y2guc3BsaXQoJ1xcbicpKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBMYWlzc2VyIHJlc3BpcmVyIGwnaW50ZXJmYWNlIHV0aWxpc2F0ZXVyXHJcbiAgICAgICAgaWYgKGkgPCBNYXRoLmNlaWwobGluZXMubGVuZ3RoIC8gYmF0Y2hTaXplKSAtIDEpIHtcclxuICAgICAgICAgICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDApKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIEFwcGVsZXIgbGUgY2FsbGJhY2sgYXZlYyBsZSByXHUwMEU5c3VsdGF0XHJcbiAgICBjYWxsYmFjayhwcm9jZXNzZWRMaW5lcy5qb2luKCdcXG4nKSk7XHJcbn0iLCAiLy8gTW9kdWxlIGRlIHRyYWl0ZW1lbnQgcGFyIGxvdCBtaXMgXHUwMEUwIGpvdXJcclxuXHJcbmltcG9ydCB7IEVkaXRvciB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5pbXBvcnQgeyBNaWNyb3R5cG9ncmFwaGllU2V0dGluZ3MgfSBmcm9tICcuLi9zZXR0aW5ncy9zZXR0aW5ncyc7XHJcbmltcG9ydCB7IGNvbXBpbGVSdWxlcyB9IGZyb20gJy4uL2NvcmUvdHlwb2dyYXBoeVJ1bGVzJztcclxuaW1wb3J0IHsgYW5hbHl6ZURvY3VtZW50U3RydWN0dXJlIH0gZnJvbSAnLi4vY29yZS9ibG9ja0FuYWx5emVyJztcclxuaW1wb3J0IHsgcHJvY2Vzc1RleHRXaXRoQmxvY2tzLCBwcm9jZXNzTGFyZ2VEb2N1bWVudCB9IGZyb20gJy4uL2NvcmUvdGV4dFByb2Nlc3Nvcic7XHJcblxyXG5leHBvcnQgY2xhc3MgQmF0Y2hUeXBvZ3JhcGh5TW9kdWxlIHtcclxuICAgIHByaXZhdGUgc2V0dGluZ3M6IE1pY3JvdHlwb2dyYXBoaWVTZXR0aW5ncztcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihzZXR0aW5nczogTWljcm90eXBvZ3JhcGhpZVNldHRpbmdzKSB7XHJcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IHNldHRpbmdzO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogSW5pdGlhbGlzZSBsZSBtb2R1bGUgYXZlYyBsZXMgcGFyYW1cdTAwRTh0cmVzIGFjdHVlbHNcclxuICAgICAqIEBwYXJhbSBzZXR0aW5ncyBQYXJhbVx1MDBFOHRyZXMgbWlzIFx1MDBFMCBqb3VyXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyB1cGRhdGVTZXR0aW5ncyhzZXR0aW5nczogTWljcm90eXBvZ3JhcGhpZVNldHRpbmdzKSB7XHJcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IHNldHRpbmdzO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQXBwbGlxdWUgdG91dGVzIGxlcyByXHUwMEU4Z2xlcyB0eXBvZ3JhcGhpcXVlcyBzdXIgdW4gdGV4dGUgc1x1MDBFOWxlY3Rpb25uXHUwMEU5XHJcbiAgICAgKiBAcGFyYW0gZWRpdG9yIFx1MDBDOWRpdGV1ciBPYnNpZGlhblxyXG4gICAgICogQHJldHVybnMgdHJ1ZSBzaSBkZXMgbW9kaWZpY2F0aW9ucyBvbnQgXHUwMEU5dFx1MDBFOSBhcHBsaXF1XHUwMEU5ZXNcclxuICAgICAqL1xyXG4gICAgcHVibGljIGFwcGx5VHlwb2dyYXBoaWNSdWxlcyhlZGl0b3I6IEVkaXRvcik6IGJvb2xlYW4ge1xyXG4gICAgICAgIC8vIFZcdTAwRTlyaWZpZXIgcydpbCB5IGEgdW5lIHNcdTAwRTlsZWN0aW9uXHJcbiAgICAgICAgY29uc3Qgc2VsZWN0aW9uID0gZWRpdG9yLmdldFNlbGVjdGlvbigpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFNpIGF1Y3VuZSBzXHUwMEU5bGVjdGlvbiwgbmUgcmllbiBmYWlyZVxyXG4gICAgICAgIGlmICghc2VsZWN0aW9uIHx8IHNlbGVjdGlvbi5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICAvLyBDb25zZXJ2ZXIgbGVzIHBvc2l0aW9ucyBkZSBzXHUwMEU5bGVjdGlvblxyXG4gICAgICAgIGNvbnN0IHNlbGVjdGlvblN0YXJ0ID0gZWRpdG9yLmdldEN1cnNvcignZnJvbScpO1xyXG4gICAgICAgIGNvbnN0IHNlbGVjdGlvbkVuZCA9IGVkaXRvci5nZXRDdXJzb3IoJ3RvJyk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gUHJcdTAwRTljb21waWxlciBsZXMgclx1MDBFOGdsZXMgdHlwb2dyYXBoaXF1ZXMgYXZlYyBsZXMgcGFyYW1cdTAwRTh0cmVzIGNvdXJhbnRzXHJcbiAgICAgICAgY29uc3QgcnVsZXMgPSBjb21waWxlUnVsZXModGhpcy5zZXR0aW5ncyk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gQW5hbHlzZXIgbGEgc3RydWN0dXJlIGR1IGRvY3VtZW50IHBvdXIgZFx1MDBFOXRlY3RlciBsZXMgYmxvY3Mgc3BcdTAwRTljaWF1eFxyXG4gICAgICAgIGNvbnN0IGJsb2NrcyA9IGFuYWx5emVEb2N1bWVudFN0cnVjdHVyZShcclxuICAgICAgICAgICAgZWRpdG9yLmdldFZhbHVlKCksXHJcbiAgICAgICAgICAgIHNlbGVjdGlvblN0YXJ0LmxpbmUsXHJcbiAgICAgICAgICAgIHNlbGVjdGlvbkVuZC5saW5lXHJcbiAgICAgICAgKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBUcmFpdGVyIGxlIHRleHRlIGF2ZWMgbGVzIHJcdTAwRThnbGVzIGNvbXBpbFx1MDBFOWVzXHJcbiAgICAgICAgY29uc3QgcHJvY2Vzc2VkVGV4dCA9IHByb2Nlc3NUZXh0V2l0aEJsb2NrcyhzZWxlY3Rpb24sIGJsb2Nrcy5saW5lVHlwZXMsIHJ1bGVzKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBWXHUwMEU5cmlmaWVyIHNpIGxlIHRleHRlIGEgY2hhbmdcdTAwRTlcclxuICAgICAgICBpZiAocHJvY2Vzc2VkVGV4dCA9PT0gc2VsZWN0aW9uKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gUmVtcGxhY2VyIHVuaXF1ZW1lbnQgbGUgdGV4dGUgc1x1MDBFOWxlY3Rpb25uXHUwMEU5XHJcbiAgICAgICAgZWRpdG9yLnJlcGxhY2VTZWxlY3Rpb24ocHJvY2Vzc2VkVGV4dCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gUmVzdGF1cmVyIGxhIHNcdTAwRTlsZWN0aW9uXHJcbiAgICAgICAgZWRpdG9yLnNldFNlbGVjdGlvbihzZWxlY3Rpb25TdGFydCwgc2VsZWN0aW9uRW5kKTtcclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFRyYWl0ZSBkZSBncmFuZHMgZG9jdW1lbnRzIGRlIG1hbmlcdTAwRThyZSBhc3luY2hyb25lXHJcbiAgICAgKiBAcGFyYW0gZWRpdG9yIFx1MDBDOWRpdGV1ciBPYnNpZGlhblxyXG4gICAgICogQHBhcmFtIGNhbGxiYWNrIEZvbmN0aW9uIGFwcGVsXHUwMEU5ZSBsb3JzcXVlIGxlIHRyYWl0ZW1lbnQgZXN0IHRlcm1pblx1MDBFOVxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgYXN5bmMgcHJvY2Vzc0xhcmdlU2VsZWN0aW9uKGVkaXRvcjogRWRpdG9yLCBjYWxsYmFjaz86ICgpID0+IHZvaWQpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgICAgICBjb25zdCBzZWxlY3Rpb24gPSBlZGl0b3IuZ2V0U2VsZWN0aW9uKCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKCFzZWxlY3Rpb24gfHwgc2VsZWN0aW9uLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICBpZiAoY2FsbGJhY2spIGNhbGxiYWNrKCk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgY29uc3Qgc2VsZWN0aW9uU3RhcnQgPSBlZGl0b3IuZ2V0Q3Vyc29yKCdmcm9tJyk7XHJcbiAgICAgICAgY29uc3Qgc2VsZWN0aW9uRW5kID0gZWRpdG9yLmdldEN1cnNvcigndG8nKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBTaSBsYSBzXHUwMEU5bGVjdGlvbiBlc3QgcGV0aXRlLCB1dGlsaXNlciBsYSBtXHUwMEU5dGhvZGUgc3luY2hyb25lXHJcbiAgICAgICAgaWYgKHNlbGVjdGlvbi5sZW5ndGggPCAxMDAwMCkge1xyXG4gICAgICAgICAgICB0aGlzLmFwcGx5VHlwb2dyYXBoaWNSdWxlcyhlZGl0b3IpO1xyXG4gICAgICAgICAgICBpZiAoY2FsbGJhY2spIGNhbGxiYWNrKCk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gUG91ciBsZXMgZ3JhbmRlcyBzXHUwMEU5bGVjdGlvbnMsIHV0aWxpc2VyIGxlIHRyYWl0ZW1lbnQgYXN5bmNocm9uZVxyXG4gICAgICAgIGNvbnN0IHJ1bGVzID0gY29tcGlsZVJ1bGVzKHRoaXMuc2V0dGluZ3MpO1xyXG4gICAgICAgIGNvbnN0IGJsb2NrcyA9IGFuYWx5emVEb2N1bWVudFN0cnVjdHVyZShcclxuICAgICAgICAgICAgZWRpdG9yLmdldFZhbHVlKCksXHJcbiAgICAgICAgICAgIHNlbGVjdGlvblN0YXJ0LmxpbmUsXHJcbiAgICAgICAgICAgIHNlbGVjdGlvbkVuZC5saW5lXHJcbiAgICAgICAgKTtcclxuICAgICAgICBcclxuICAgICAgICBhd2FpdCBwcm9jZXNzTGFyZ2VEb2N1bWVudChcclxuICAgICAgICAgICAgc2VsZWN0aW9uLCBcclxuICAgICAgICAgICAgYmxvY2tzLmxpbmVUeXBlcywgXHJcbiAgICAgICAgICAgIHJ1bGVzLCBcclxuICAgICAgICAgICAgKHByb2Nlc3NlZFRleHQpID0+IHtcclxuICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlU2VsZWN0aW9uKHByb2Nlc3NlZFRleHQpO1xyXG4gICAgICAgICAgICAgICAgZWRpdG9yLnNldFNlbGVjdGlvbihzZWxlY3Rpb25TdGFydCwgc2VsZWN0aW9uRW5kKTtcclxuICAgICAgICAgICAgICAgIGlmIChjYWxsYmFjaykgY2FsbGJhY2soKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcbn0iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsSUFBQUEsbUJBQXFDOzs7QUN1QjlCLElBQU0sbUJBQTZDO0FBQUEsRUFDdEQsaUJBQWlCO0FBQUE7QUFBQSxFQUNqQixrQkFBa0I7QUFBQTtBQUFBLEVBQ2xCLGlCQUFpQjtBQUFBO0FBQUEsRUFDakIsa0JBQWtCO0FBQUE7QUFBQSxFQUNsQixvQkFBb0I7QUFBQSxFQUNwQixlQUFlO0FBQUEsRUFDZixZQUFZO0FBQUEsRUFDWixpQkFBaUI7QUFBQSxFQUNqQixtQkFBbUI7QUFBQSxFQUNuQixrQkFBa0I7QUFBQSxFQUNsQixpQkFBaUI7QUFBQSxFQUNqQixtQkFBbUI7QUFBQTtBQUN2Qjs7O0FDcENBLHNCQUErQztBQU94QyxJQUFNLDZCQUFOLGNBQXlDLGlDQUFpQjtBQUFBO0FBQUEsRUFJL0QsWUFBWSxLQUFVLFFBQTBCO0FBQzlDLFVBQU0sS0FBSyxNQUFNO0FBQ2pCLFNBQUssU0FBUztBQUFBLEVBQ2hCO0FBQUEsRUFFQSxVQUFnQjtBQUNkLFVBQU0sRUFBRSxZQUFZLElBQUk7QUFFeEIsZ0JBQVksTUFBTTtBQUVsQixnQkFBWSxTQUFTLE1BQU0sRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBTXZELFNBQUssb0JBQW9CLFdBQVc7QUFHcEMsU0FBSyx3QkFBd0IsV0FBVztBQUFBLEVBQzFDO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQU1RLGdCQUFnQixhQUFnQztBQUN0RCxVQUFN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
